Function: main

undefined4 main(int param_1,int param_2)

{
  int iVar1;
  undefined4 uVar2;
  int iVar3;
  int iVar4;
  
  iVar3 = 0;
  for (iVar4 = 1; iVar4 < param_1; iVar4 = iVar4 + 1) {
    iVar1 = strcmp(*(char **)(param_2 + iVar4 * 4),"-demo");
    iVar3 = iVar3 + (uint)(iVar1 == 0);
  }
  check_mem();
  bopen(0,0xf000,1);
  signal(0xd,(__sighandler_t)0x1);
  signal(2,sigintHandler);
  signal(0xf,sigintHandler);
  iVar3 = initWebs(iVar3);
  if (iVar3 < 0) {
    uVar2 = 0xffffffff;
  }
  else {
    finished = 0;
    while (finished == 0) {
      iVar3 = socketReady(0xffffffff);
      if ((iVar3 != 0) || (iVar3 = socketSelect(0xffffffff,1000), iVar3 != 0)) {
        socketProcess(0xffffffff);
      }
      websCgiCleanup();
      emfSchedProcess();
    }
    websCloseServer();
    socketClose();
    bclose();
    uVar2 = 0;
  }
  return uVar2;
}
----------------------------------------

Function: DownLoadCRC

void DownLoadCRC(undefined4 param_1)

{
  char *__nptr;
  int iVar1;
  FILE *__stream;
  void *__ptr;
  int iVar2;
  char acStack_88 [100];
  int local_24 [6];
  
  memset(acStack_88,0,100);
  __nptr = (char *)websGetVar(param_1,"CRCfile",&DAT_10023fc4);
  iVar1 = atoi(__nptr);
  sprintf(acStack_88,"%s%s","/mnt/nandflash/CRC/",CRCfile + iVar1 * 100);
  __stream = fopen(acStack_88,"r");
  if (__stream == (FILE *)0x0) {
    websHeader(param_1);
    websError(param_1,0x194,"Cannot download CRC file");
    websFooter(param_1);
  }
  else {
    fclose(__stream);
    websWrite(param_1,"HTTP/1.0 200 OK\n",&DAT_10023fc4);
    websWrite(param_1,"Content-Type: application/octet-stream\n",&DAT_10023fc4);
    websWrite(param_1,"Content-Disposition: attachment; filename=%s\n\n",CRCfile + iVar1 * 100);
    __ptr = (void *)GetFileString(acStack_88,local_24);
    iVar1 = 0;
    if (0 < local_24[0]) {
      for (; local_24[0] != 0; local_24[0] = local_24[0] - iVar2) {
        iVar2 = websWriteDataNonBlock(param_1,(int)__ptr + iVar1);
        iVar1 = iVar1 + iVar2;
      }
      free(__ptr);
    }
    websDone(param_1,200);
  }
  return;
}
----------------------------------------

Function: DownChannelFile

void DownChannelFile(undefined4 param_1)

{
  char *__nptr;
  int iVar1;
  FILE *__stream;
  void *__ptr;
  int iVar2;
  char acStack_88 [100];
  int local_24 [6];
  
  memset(acStack_88,0,100);
  __nptr = (char *)websGetVar(param_1,"16Channelfile",&DAT_10023fc4);
  iVar1 = atoi(__nptr);
  sprintf(acStack_88,"%s%s","/mnt/nandflash/Data/",Channelfile + iVar1 * 100);
  __stream = fopen(acStack_88,"r");
  if (__stream == (FILE *)0x0) {
    websHeader(param_1);
    websError(param_1,0x194,"Cannot download ChannelData file");
    websFooter(param_1);
  }
  else {
    fclose(__stream);
    websWrite(param_1,"HTTP/1.0 200 OK\n",&DAT_10023fc4);
    websWrite(param_1,"Content-Type: application/octet-stream\n",&DAT_10023fc4);
    websWrite(param_1,"Content-Disposition: attachment; filename=%s\n\n",Channelfile + iVar1 * 100);
    __ptr = (void *)GetFileString(acStack_88,local_24);
    iVar1 = 0;
    if (0 < local_24[0]) {
      for (; local_24[0] != 0; local_24[0] = local_24[0] - iVar2) {
        iVar2 = websWriteDataNonBlock(param_1,(int)__ptr + iVar1);
        iVar1 = iVar1 + iVar2;
      }
      free(__ptr);
    }
    websDone(param_1,200);
  }
  return;
}
----------------------------------------

Function: LogDownLoad

void LogDownLoad(undefined4 param_1)

{
  void *__ptr;
  int iVar1;
  int iVar2;
  int local_28 [7];
  
  system("logread > /var/log/log.txt");
  websWrite(param_1,"HTTP/1.0 200 OK\n",&DAT_10023fc4);
  websWrite(param_1,"Content-Type: application/octet-stream\n",&DAT_10023fc4);
  websWrite(param_1,"Content-Disposition: attachment; filename=log.txt\n\n");
  __ptr = (void *)GetFileString("/var/log/log.txt",local_28);
  if (0 < local_28[0]) {
    iVar2 = 0;
    for (; local_28[0] != 0; local_28[0] = local_28[0] - iVar1) {
      iVar1 = websWriteDataNonBlock(param_1,(int)__ptr + iVar2);
      iVar2 = iVar2 + iVar1;
    }
    free(__ptr);
  }
  websDone(param_1,200);
  return;
}
----------------------------------------

Function: initWebs

void initWebs(int param_1)

{
  in_addr_t iVar1;
  char *pcVar2;
  char acStack_198 [128];
  char acStack_118 [256];
  in_addr_t local_18;
  
  socketOpen();
  iVar1 = inet_addr("192.168.0.18");
  getcwd(acStack_118,0x80);
  pcVar2 = strrchr(acStack_118,0x2f);
  if (pcVar2 != (char *)0x0) {
    *pcVar2 = '\0';
  }
  if (param_1 == 0) {
    strcpy(acStack_198,"/usr/local/www");
  }
  else {
    sprintf(acStack_198,"%s/%s",acStack_118,"/mnt/Nand1/wwwdemo");
  }
  websSetDefaultDir(acStack_198);
  local_18 = iVar1;
  pcVar2 = inet_ntoa((in_addr)&local_18);
                    /* WARNING: Subroutine does not return */
  strlen(pcVar2);
}
----------------------------------------

Function: websHomePageHandler

undefined4 websHomePageHandler(undefined4 param_1)

{
  int iVar1;
  char *in_r7;
  
  if ((*in_r7 != '\0') && (iVar1 = strcmp(in_r7,"/"), iVar1 != 0)) {
    return 0;
  }
  websRedirect(param_1,"Main.htm");
  return 1;
}
----------------------------------------

Function: ws_set_cookie

void ws_set_cookie(undefined4 param_1,char *param_2)

{
                    /* WARNING: Subroutine does not return */
  strlen(param_2);
}
----------------------------------------

Function: ws_get_cookie

undefined4 ws_get_cookie(int param_1)

{
  if ((*(char **)(param_1 + 0xd8) != (char *)0x0) && ((*(uint *)(param_1 + 0x100) & 8) != 0)) {
                    /* WARNING: Subroutine does not return */
    strlen(*(char **)(param_1 + 0xd8));
  }
  return 1;
}
----------------------------------------

Function: Rom_show

void Rom_show(int param_1)

{
  undefined8 uVar1;
  
  memset(str_meminformation,0,0x10);
  uVar1 = __extendsfdf2((uint)*(byte *)(param_1 + 0x3c) |
                        (uint)*(byte *)(param_1 + 0x3b) << 8 |
                        (uint)*(byte *)(param_1 + 0x3a) << 0x10 |
                        (uint)*(byte *)(param_1 + 0x39) << 0x18);
  sprintf(str_meminformation,"%3.1f%%",(int)((ulonglong)uVar1 >> 0x20),(int)uVar1);
  return;
}
----------------------------------------

Function: Check_NetConf

void Check_NetConf(void)

{
  int iVar1;
  char acStack_88 [132];
  
  iVar1 = access("/usr/local/webs/network.conf",0);
  if (iVar1 != 0) {
    memset(acStack_88,0,0x80);
    sprintf(acStack_88,"cp %s %s","/etc/config/network","/usr/local/webs/network.conf");
    system(acStack_88);
  }
  return;
}
----------------------------------------

Function: Dram_show

void Dram_show(int param_1)

{
  memset(str_Dram,0,0x10);
  sprintf(str_Dram,"%uKB",
          ((uint)*(byte *)(param_1 + 0x40) |
          (uint)*(byte *)(param_1 + 0x3f) << 8 | (uint)*(byte *)(param_1 + 0x3e) << 0x10) << 10);
  return;
}
----------------------------------------

Function: Flashram_show

void Flashram_show(int param_1)

{
  memset(str_Flashram,0,0x10);
  sprintf(str_Flashram,"%uKB",
          (uint)*(byte *)(param_1 + 0x44) |
          (uint)*(byte *)(param_1 + 0x43) << 8 |
          (uint)*(byte *)(param_1 + 0x42) << 0x10 | (uint)*(byte *)(param_1 + 0x41) << 0x18);
  return;
}
----------------------------------------

Function: Welcome

void Welcome(undefined4 param_1)

{
  byte bVar1;
  byte bVar2;
  byte bVar3;
  byte bVar4;
  int iVar5;
  int iVar6;
  char *pcVar7;
  int iVar8;
  tm *__tp;
  byte in_cr0;
  byte in_cr1;
  byte unaff_cr2;
  byte unaff_cr3;
  byte unaff_cr4;
  byte in_cr5;
  byte in_cr6;
  byte in_cr7;
  undefined8 uVar9;
  char acStack_108 [64];
  char acStack_c8 [64];
  char acStack_88 [64];
  time_t local_48 [5];
  uint local_34;
  
  local_34 = (uint)(in_cr0 & 0xf) << 0x1c | (uint)(in_cr1 & 0xf) << 0x18 |
             (uint)(unaff_cr2 & 0xf) << 0x14 | (uint)(unaff_cr3 & 0xf) << 0x10 |
             (uint)(unaff_cr4 & 0xf) << 0xc | (uint)(in_cr5 & 0xf) << 8 | (uint)(in_cr6 & 0xf) << 4
             | (uint)(in_cr7 & 0xf);
  memset(acStack_88,0,0x40);
  memset(acStack_c8,0,0x40);
  memset(acStack_108,0,0x40);
  Check_NetConf();
  Rom_show(g_pWrData);
  Dram_show(g_pWrData);
  Flashram_show(g_pWrData);
  bVar1 = *(byte *)(g_pWrData + 0x35);
  bVar2 = *(byte *)(g_pWrData + 0x36);
  bVar3 = *(byte *)(g_pWrData + 0x37);
  bVar4 = *(byte *)(g_pWrData + 0x38);
  iVar5 = httpPlatformOpen("/Welcome.htm",0);
  if (-1 < iVar5) {
    iVar6 = InitReadString();
    if (-1 < iVar6) {
      iVar6 = websCompareVar(param_1,&DAT_10020f40,&DAT_10020f44);
      if (iVar6 != 0) {
        pcVar7 = (char *)websGetVar(param_1,"writevalue",&DAT_10023fc4);
        iVar6 = g_pWrData;
        iVar8 = atoi(pcVar7);
        *(char *)(iVar6 + 0x30) = (char)iVar8;
        pcVar7 = (char *)websGetVar(param_1,&DAT_10020f58,&DAT_10023fc4);
        iVar6 = g_pWrData;
        iVar8 = atoi(pcVar7);
        *(char *)(iVar6 + 0x34) = (char)iVar8;
        *(char *)(iVar6 + 0x31) = (char)((uint)iVar8 >> 0x18);
        *(char *)(iVar6 + 0x32) = (char)((uint)iVar8 >> 0x10);
        *(char *)(iVar6 + 0x33) = (char)((uint)iVar8 >> 8);
      }
      local_48[0] = time((time_t *)0x0);
      __tp = localtime(local_48);
      memset(acStack_88,0,0x40);
      sprintf(acStack_88," %04d-%02d-%02d %02d:%02d:%02d",__tp->tm_year + 0x76c,__tp->tm_mon + 1,
              __tp->tm_mday,__tp->tm_hour + 8,__tp->tm_min,__tp->tm_sec);
      pcVar7 = asctime(__tp);
      sprintf(acStack_c8,"%s\n",pcVar7);
      while( true ) {
        iVar6 = ReadString(iVar5,buf,0x1000);
        if (iVar6 < 0) break;
        if (iVar6 == 0) goto LAB_1000319c;
        buf[iVar6] = 0;
        iVar8 = strcmp(buf,"<!--DateTime -->");
        if (iVar8 == 0) {
          iVar6 = ReadString(iVar5,buf,0x1000);
          if (-1 < iVar6) {
            if (iVar6 != 0) {
              websWriteDataNonBlock(param_1,buf,iVar6 + -2);
              websWrite(param_1," value=\"");
                    /* WARNING: Subroutine does not return */
              strlen(acStack_c8);
            }
            goto LAB_1000319c;
          }
          break;
        }
        websWriteDataNonBlock(param_1,buf,iVar6);
        websWrite(param_1,&DAT_10022d7c);
      }
    }
LAB_10003758:
    if (iVar5 != 0) {
      httpPlatformClose(iVar5);
    }
  }
  websError(param_1,0x194,"Cannot open URL:%s","/Welcome.htm");
  return;
LAB_1000319c:
  iVar6 = ReadString(iVar5,buf,0x1000);
  if (iVar6 < 0) goto LAB_10003758;
  if (iVar6 == 0) goto LAB_10003220;
  buf[iVar6] = 0;
  iVar8 = strcmp(buf,"<!--Versions -->");
  if (iVar8 == 0) {
    websWrite(param_1,"%s\n",g_pWrData + 0x45);
    goto LAB_10003220;
  }
  websWriteDataNonBlock(param_1,buf,iVar6);
  websWrite(param_1,&DAT_10022d7c);
  goto LAB_1000319c;
LAB_10003220:
  iVar6 = ReadString(iVar5,buf,0x1000);
  if (iVar6 < 0) goto LAB_10003758;
  if (iVar6 == 0) goto LAB_100032a8;
  buf[iVar6] = 0;
  iVar8 = strcmp(buf,"<!--Meminformation -->");
  if (iVar8 == 0) {
    websWrite(param_1,"%s\n",str_meminformation);
    goto LAB_100032a8;
  }
  websWriteDataNonBlock(param_1,buf,iVar6);
  websWrite(param_1,&DAT_10022d7c);
  goto LAB_10003220;
LAB_100032a8:
  iVar6 = ReadString(iVar5,buf,0x1000);
  if (iVar6 < 0) goto LAB_10003758;
  if (iVar6 == 0) goto LAB_10003330;
  buf[iVar6] = 0;
  iVar8 = strcmp(buf,"<!--Flashram -->");
  if (iVar8 == 0) {
    websWrite(param_1,"%s\n",str_Flashram);
    goto LAB_10003330;
  }
  websWriteDataNonBlock(param_1,buf,iVar6);
  websWrite(param_1,&DAT_10022d7c);
  goto LAB_100032a8;
LAB_10003330:
  iVar6 = ReadString(iVar5,buf,0x1000);
  if (iVar6 < 0) goto LAB_10003758;
  if (iVar6 == 0) goto LAB_100033b4;
  buf[iVar6] = 0;
  iVar8 = strcmp(buf,"<!--Working -->");
  if (iVar8 == 0) {
    websWrite(param_1,"%s\n",&DAT_10020ff4);
    goto LAB_100033b4;
  }
  websWriteDataNonBlock(param_1,buf,iVar6);
  websWrite(param_1,&DAT_10022d7c);
  goto LAB_10003330;
LAB_100033b4:
  iVar6 = ReadString(iVar5,buf,0x1000);
  if (iVar6 < 0) goto LAB_10003758;
  if (iVar6 == 0) goto LAB_1000343c;
  buf[iVar6] = 0;
  iVar8 = strcmp(buf,"<!--Dram -->");
  if (iVar8 == 0) {
    websWrite(param_1,"%s\n",str_Dram);
    goto LAB_1000343c;
  }
  websWriteDataNonBlock(param_1,buf,iVar6);
  websWrite(param_1,&DAT_10022d7c);
  goto LAB_100033b4;
LAB_1000343c:
  iVar6 = ReadString(iVar5,buf,0x1000);
  if (iVar6 < 0) goto LAB_10003758;
  if (iVar6 == 0) {
LAB_10003484:
    uVar9 = __extendsfdf2((uint)bVar4 | (uint)bVar3 << 8 | (uint)bVar2 << 0x10 | (uint)bVar1 << 0x18
                         );
    sprintf(acStack_108,"%3.1f",(int)((ulonglong)uVar9 >> 0x20),(int)uVar9);
    goto LAB_100034c0;
  }
  buf[iVar6] = 0;
  iVar8 = strcmp(buf,"<!--ModelTime -->");
  if (iVar8 == 0) {
    websWrite(param_1,"%s\n",acStack_88);
    goto LAB_10003484;
  }
  websWriteDataNonBlock(param_1,buf,iVar6);
  websWrite(param_1,&DAT_10022d7c);
  goto LAB_1000343c;
LAB_100034c0:
  iVar6 = ReadString(iVar5,buf,0x1000);
  if (iVar6 < 0) goto LAB_10003758;
  if (iVar6 == 0) {
LAB_1000352c:
    if (*(char *)(g_pWrData + 0x30) != '\x01') goto LAB_10003644;
    goto LAB_10003554;
  }
  buf[iVar6] = 0;
  iVar8 = strcmp(buf,"<!--Temp -->");
  if (iVar8 == 0) {
    websWrite(param_1,"%s\n",acStack_108);
    goto LAB_1000352c;
  }
  websWriteDataNonBlock(param_1,buf,iVar6);
  websWrite(param_1,&DAT_10022d7c);
  goto LAB_100034c0;
LAB_10003554:
  iVar6 = ReadString(iVar5,buf,0x1000);
  if (iVar6 < 0) goto LAB_10003758;
  if (iVar6 == 0) goto LAB_10003644;
  buf[iVar6] = 0;
  iVar8 = strcmp(buf,"<!--WRTFILE -->");
  if (iVar8 == 0) {
    iVar6 = ReadString(iVar5,buf,0x1000);
    if (-1 < iVar6) {
      if (iVar6 != 0) {
        websWriteDataNonBlock(param_1,buf,iVar6 + -2);
        websWrite(param_1," checked=\"checked\" />\n");
      }
      goto LAB_10003644;
    }
    goto LAB_10003758;
  }
  websWriteDataNonBlock(param_1,buf,iVar6);
  websWrite(param_1,&DAT_10022d7c);
  goto LAB_10003554;
LAB_10003644:
  iVar6 = ReadString(iVar5,buf,0x1000);
  if (iVar6 < 0) goto LAB_10003758;
  if (iVar6 == 0) goto LAB_1000371c;
  buf[iVar6] = 0;
  iVar8 = strcmp(buf,"<!--Cmp -->");
  if (iVar8 == 0) {
    iVar6 = ReadString(iVar5,buf,0x1000);
    if (-1 < iVar6) {
      if (iVar6 != 0) {
        websWriteDataNonBlock(param_1,buf,iVar6 + -2);
        websWrite(param_1," value=\"%d\"/>\n",
                  (uint)*(byte *)(g_pWrData + 0x34) |
                  (uint)*(byte *)(g_pWrData + 0x33) << 8 |
                  (uint)*(byte *)(g_pWrData + 0x32) << 0x10 |
                  (uint)*(byte *)(g_pWrData + 0x31) << 0x18);
      }
LAB_1000371c:
      while( true ) {
        iVar6 = ReadString(iVar5,buf,0x1000);
        if (iVar6 < 0) break;
        if (iVar6 == 0) {
          if (iVar5 != 0) {
            httpPlatformClose(iVar5);
          }
          websDone(param_1,0xc9);
          return;
        }
        iVar8 = 0;
        do {
          iVar8 = websWriteDataNonBlock(param_1,buf + iVar8,iVar6);
          if (iVar8 < 0) goto LAB_10003758;
          iVar6 = iVar6 - iVar8;
        } while (iVar6 != 0);
        websWrite(param_1,&DAT_10022d7c);
      }
    }
    goto LAB_10003758;
  }
  websWriteDataNonBlock(param_1,buf,iVar6);
  websWrite(param_1,&DAT_10022d7c);
  goto LAB_10003644;
}
----------------------------------------

Function: ModifyPwdHandleSubmit

void ModifyPwdHandleSubmit(undefined4 param_1)

{
  char *pcVar1;
  int iVar2;
  char *__s2;
  
  pcVar1 = (char *)websGetVar(param_1,"Oldpwd",&DAT_10023fc4);
  iVar2 = strcmp(pcVar1,g_SysDev_t + 0x10);
  if (iVar2 == 0) {
    pcVar1 = (char *)websGetVar(param_1,"WebNpwd1",&DAT_10023fc4);
    __s2 = (char *)websGetVar(param_1,"WebNpwd2",&DAT_10023fc4);
    iVar2 = strcmp(pcVar1,__s2);
    if (iVar2 == 0) {
      strcpy(g_SysDev_t + 0x10,pcVar1);
      iVar2 = UpdateRtuRunInfo(g_SysDev_t);
      if (iVar2 == 0) {
        web_flag = 2;
        websSetPassword(pcVar1);
        return;
      }
      web_flag = 1;
    }
  }
  else {
    web_flag = 3;
  }
  return;
}
----------------------------------------

Function: ModifyUserHandleSubmit

void ModifyUserHandleSubmit(undefined4 param_1)

{
  char *pcVar1;
  int iVar2;
  
  GetRtuRunInfo(g_SysDev_t);
  pcVar1 = (char *)websGetVar(param_1,"OldUserName",&DAT_10023fc4);
  iVar2 = strcmp(pcVar1,g_SysDev_t);
  if (iVar2 != 0) {
    web_flag = 4;
    return;
  }
  iVar2 = websCompareVar(param_1,"IfModifyUser",&DAT_10023cd4);
  if (iVar2 != 0) {
    pcVar1 = (char *)websGetVar(param_1,"NewUserName",&DAT_10023fc4);
    if (pcVar1 == (char *)0x0) {
      return;
    }
    strcpy(g_SysDev_t,pcVar1);
    websSetUsername(pcVar1);
  }
  ModifyPwdHandleSubmit(param_1);
  return;
}
----------------------------------------

Function: UserManage

void UserManage(undefined4 param_1)

{
  int iVar1;
  int iVar2;
  int iVar3;
  undefined *puVar4;
  
  iVar1 = websCompareVar(param_1,"ModifyPwd",&DAT_100210dc);
  if (iVar1 != 0) {
    ModifyUserHandleSubmit(param_1);
  }
  iVar1 = httpPlatformOpen("/UserManage.htm",0);
  if (-1 < iVar1) {
    iVar2 = InitReadString();
    if (-1 < iVar2) {
      while( true ) {
        iVar2 = ReadString(iVar1,buf,0x1000);
        if (iVar2 < 0) goto LAB_10003d4c;
        if (iVar2 == 0) goto LAB_10003d00;
        buf[iVar2] = 0;
        iVar3 = strcmp(buf,"<!--TipWebFlag -->");
        if (iVar3 == 0) break;
        websWriteDataNonBlock(param_1,buf,iVar2);
        websWrite(param_1,&DAT_10022d7c);
      }
      if (web_flag == 0) {
        puVar4 = &DAT_10022d7c;
LAB_10003c88:
        websWrite(param_1,puVar4);
      }
      else {
        if (web_flag == 1) {
          puVar4 = &DAT_10021108;
          goto LAB_10003c88;
        }
        if (web_flag == 2) {
          puVar4 = &DAT_1002111c;
          goto LAB_10003c88;
        }
        if (web_flag == 3) {
          puVar4 = &DAT_10021130;
          goto LAB_10003c88;
        }
        if (web_flag == 4) {
          puVar4 = &DAT_10021144;
          goto LAB_10003c88;
        }
      }
      web_flag = 0;
LAB_10003d00:
      while( true ) {
        iVar2 = ReadString(iVar1,buf,0x1000);
        if (iVar2 < 0) break;
        if (iVar2 == 0) {
          if (iVar1 != 0) {
            httpPlatformClose(iVar1);
          }
          websDone(param_1,0xc9);
          return;
        }
        iVar3 = 0;
        do {
          iVar3 = websWriteDataNonBlock(param_1,buf + iVar3,iVar2);
          if (iVar3 < 0) goto LAB_10003d4c;
          iVar2 = iVar2 - iVar3;
        } while (iVar2 != 0);
        websWrite(param_1,&DAT_10022d7c);
      }
    }
LAB_10003d4c:
    if (iVar1 != 0) {
      httpPlatformClose(iVar1);
    }
  }
  websError(param_1,0x194,"Cannot open URL:%s","/UserManage.htm");
  return;
}
----------------------------------------

Function: getfilename

int getfilename(char *param_1,int param_2)

{
  DIR *__dirp;
  int iVar1;
  int iVar2;
  dirent *pdVar3;
  char *pcVar4;
  
  __dirp = opendir(param_1);
  if (__dirp == (DIR *)0x0) {
    perror("opendir error");
    iVar1 = -1;
  }
  else {
    iVar1 = 0;
    if (param_2 == 1) {
      while (pdVar3 = readdir(__dirp), pdVar3 != (dirent *)0x0) {
        pcVar4 = pdVar3->d_name;
        iVar2 = strcmp(pcVar4,".");
        if ((iVar2 != 0) && (iVar2 = strcmp(pcVar4,".."), iVar2 != 0)) {
          iVar2 = iVar1 * 100;
          iVar1 = iVar1 + 1;
          memcpy(CRCfile + iVar2,pcVar4,0x100);
        }
      }
    }
    else {
      while (pdVar3 = readdir(__dirp), pdVar3 != (dirent *)0x0) {
        pcVar4 = pdVar3->d_name;
        iVar2 = strcmp(pcVar4,".");
        if ((iVar2 != 0) && (iVar2 = strcmp(pcVar4,".."), iVar2 != 0)) {
          iVar2 = iVar1 * 100;
          iVar1 = iVar1 + 1;
          memcpy(Channelfile + iVar2,pcVar4,0x100);
        }
      }
    }
  }
  return iVar1;
}
----------------------------------------

Function: UpgradeFirmware

void UpgradeFirmware(undefined4 param_1)

{
  int iVar1;
  int iVar2;
  int iVar3;
  int iVar4;
  int iVar5;
  
  iVar1 = getfilename("/mnt/nandflash/CRC/",1);
  iVar2 = getfilename("/mnt/nandflash/Data/",2);
  iVar3 = httpPlatformOpen("/UpgradeFirmware.htm",0);
  if (-1 < iVar3) {
    iVar4 = InitReadString();
    if (-1 < iVar4) {
      websHeader(param_1);
      if (iVar1 < 0) {
        while( true ) {
          iVar1 = ReadString(iVar3,buf,0x1000);
          if (iVar1 < 0) goto LAB_10004354;
          if (iVar1 == 0) goto LAB_100040f8;
          buf[iVar1] = 0;
          iVar4 = strcmp(buf,"<!--CRCMsg -->");
          if (iVar4 == 0) break;
          websWriteDataNonBlock(param_1,buf,iVar1);
          websWrite(param_1,&DAT_10022d7c);
        }
        websWriteDataNonBlock(param_1,&DAT_10021198,0x55);
        websWrite(param_1,&DAT_10022d7c);
LAB_100040f8:
        if (iVar2 < 0) {
          while( true ) {
            iVar1 = ReadString(iVar3,buf,0x1000);
            if (iVar1 < 0) goto LAB_10004354;
            if (iVar1 == 0) goto LAB_10004304;
            buf[iVar1] = 0;
            iVar2 = strcmp(buf,"<!--16ChannelMsg -->");
            if (iVar2 == 0) break;
            websWriteDataNonBlock(param_1,buf,iVar1);
            websWrite(param_1,&DAT_10022d7c);
          }
          websWriteDataNonBlock(param_1,&DAT_10021238,0x56);
          websWrite(param_1,&DAT_10022d7c);
LAB_10004304:
          while( true ) {
            iVar1 = ReadString(iVar3,buf,0x1000);
            if (iVar1 < 0) break;
            if (iVar1 == 0) {
              if (iVar3 != 0) {
                httpPlatformClose(iVar3);
              }
              websDone(param_1,0xc9);
              return;
            }
            iVar2 = 0;
            do {
              iVar2 = websWriteDataNonBlock(param_1,buf + iVar2,iVar1);
              if (iVar2 < 0) goto LAB_10004354;
              iVar1 = iVar1 - iVar2;
            } while (iVar1 != 0);
            websWrite(param_1,&DAT_10022d7c);
          }
        }
        else {
          while( true ) {
            iVar1 = ReadString(iVar3,_wespagebuf,0x1000);
            if (iVar1 < 0) break;
            if (iVar1 == 0) goto LAB_10004304;
            _wespagebuf[iVar1] = 0;
            iVar4 = strcmp(_wespagebuf,"<!--16Channelfile -->");
            if (iVar4 == 0) {
              iVar1 = ReadString(iVar3,_wespagebuf,0x1000);
              if (-1 < iVar1) {
                if (iVar1 != 0) {
                  websWriteBlock(param_1,_wespagebuf);
                  websWrite(param_1,&DAT_10022d7c);
                  if (iVar2 != 0) {
                    websWrite(param_1,"<option value=\"%d\">",0);
                    /* WARNING: Subroutine does not return */
                    strlen(Channelfile);
                  }
                }
                goto LAB_10004304;
              }
              break;
            }
            websWriteBlock(param_1,_wespagebuf,iVar1);
            websWrite(param_1,&DAT_10022d7c);
          }
        }
      }
      else {
        while( true ) {
          iVar4 = ReadString(iVar3,_wespagebuf,0x1000);
          if (iVar4 < 0) break;
          if (iVar4 == 0) goto LAB_100040f8;
          _wespagebuf[iVar4] = 0;
          iVar5 = strcmp(_wespagebuf,"<!--CRCfile -->");
          if (iVar5 == 0) {
            iVar4 = ReadString(iVar3,_wespagebuf,0x1000);
            if (-1 < iVar4) {
              if (iVar4 != 0) {
                websWriteBlock(param_1,_wespagebuf);
                websWrite(param_1,&DAT_10022d7c);
                if (iVar1 != 0) {
                  websWrite(param_1,"<option value=\"%d\">",0);
                    /* WARNING: Subroutine does not return */
                  strlen(CRCfile);
                }
              }
              goto LAB_100040f8;
            }
            break;
          }
          websWriteBlock(param_1,_wespagebuf,iVar4);
          websWrite(param_1,&DAT_10022d7c);
        }
      }
    }
LAB_10004354:
    if (iVar3 != 0) {
      httpPlatformClose(iVar3);
    }
  }
  websError(param_1,0x194,"Cannot open URL:%s","/UpgradeFirmware.htm");
  return;
}
----------------------------------------

Function: Chang_Mem_Data

undefined4 Chang_Mem_Data(undefined4 param_1,undefined4 param_2)

{
  bool bVar1;
  undefined uVar2;
  undefined uVar3;
  undefined uVar4;
  undefined uVar5;
  int iVar6;
  uint uVar7;
  int iVar8;
  int iVar9;
  int iVar10;
  char acStack_1f8 [204];
  char acStack_12c [128];
  int local_ac;
  char acStack_a8 [64];
  char acStack_68 [16];
  int local_58;
  
  memset(&data,0,0x10);
  GetNetProfileString(param_2,"cmptime",&data);
  puts(&data);
  iVar6 = atoi(&data);
  iVar10 = g_pWrData;
  if (-1 < iVar6) {
    *(char *)(g_pWrData + 0x31) = (char)((uint)iVar6 >> 0x18);
    *(char *)(iVar10 + 0x32) = (char)((uint)iVar6 >> 0x10);
    *(char *)(iVar10 + 0x33) = (char)((uint)iVar6 >> 8);
    *(char *)(iVar10 + 0x34) = (char)iVar6;
  }
  memset(&data,0,0x10);
  GetNetProfileString(param_2,&DAT_100212b0,&data);
  StringSplit_Struct(&local_ac,&data,&DAT_10021168);
  if ((local_ac == 3) &&
     (iVar6 = atoi(acStack_a8), uVar4 = DAT_100b195f, uVar3 = DAT_100b195e, uVar2 = DAT_100b195d,
     iVar10 = g_pWrData, 0 < iVar6)) {
    *(undefined *)(g_pWrData + 0x65) = data;
    *(undefined *)(iVar10 + 0x66) = uVar2;
    uVar5 = DAT_100b1961;
    uVar2 = DAT_100b1960;
    *(undefined *)(iVar10 + 0x67) = uVar3;
    *(undefined *)(iVar10 + 0x68) = uVar4;
    uVar4 = DAT_100b1963;
    uVar3 = DAT_100b1962;
    *(undefined *)(iVar10 + 0x69) = uVar2;
    *(undefined *)(iVar10 + 0x6a) = uVar5;
    uVar5 = DAT_100b1965;
    uVar2 = DAT_100b1964;
    *(undefined *)(iVar10 + 0x6b) = uVar3;
    *(undefined *)(iVar10 + 0x6c) = uVar4;
    uVar4 = DAT_100b1967;
    uVar3 = DAT_100b1966;
    *(undefined *)(iVar10 + 0x6d) = uVar2;
    *(undefined *)(iVar10 + 0x6e) = uVar5;
    *(undefined *)(iVar10 + 0x6f) = uVar3;
    *(undefined *)(iVar10 + 0x70) = uVar4;
    uVar4 = DAT_100b196b;
    uVar3 = DAT_100b196a;
    uVar2 = DAT_100b1969;
    *(undefined *)(iVar10 + 0x71) = DAT_100b1968;
    *(undefined *)(iVar10 + 0x72) = uVar2;
    *(undefined *)(iVar10 + 0x73) = uVar3;
    *(undefined *)(iVar10 + 0x74) = uVar4;
  }
  memset(&data,0,0x10);
  GetNetProfileString(param_2,"MASK1",&data);
  StringSplit_Struct(&local_ac,&data,&DAT_10021168);
  if ((local_ac == 3) &&
     (iVar6 = atoi(acStack_a8), uVar4 = DAT_100b195f, uVar3 = DAT_100b195e, uVar2 = DAT_100b195d,
     iVar10 = g_pWrData, 0 < iVar6)) {
    *(undefined *)(g_pWrData + 0x75) = data;
    *(undefined *)(iVar10 + 0x76) = uVar2;
    uVar5 = DAT_100b1961;
    uVar2 = DAT_100b1960;
    *(undefined *)(iVar10 + 0x77) = uVar3;
    *(undefined *)(iVar10 + 0x78) = uVar4;
    uVar4 = DAT_100b1963;
    uVar3 = DAT_100b1962;
    *(undefined *)(iVar10 + 0x79) = uVar2;
    *(undefined *)(iVar10 + 0x7a) = uVar5;
    uVar5 = DAT_100b1965;
    uVar2 = DAT_100b1964;
    *(undefined *)(iVar10 + 0x7b) = uVar3;
    *(undefined *)(iVar10 + 0x7c) = uVar4;
    uVar4 = DAT_100b1967;
    uVar3 = DAT_100b1966;
    *(undefined *)(iVar10 + 0x7d) = uVar2;
    *(undefined *)(iVar10 + 0x7e) = uVar5;
    *(undefined *)(iVar10 + 0x7f) = uVar3;
    *(undefined *)(iVar10 + 0x80) = uVar4;
    uVar4 = DAT_100b196b;
    uVar3 = DAT_100b196a;
    uVar2 = DAT_100b1969;
    *(undefined *)(iVar10 + 0x81) = DAT_100b1968;
    *(undefined *)(iVar10 + 0x82) = uVar2;
    *(undefined *)(iVar10 + 0x83) = uVar3;
    *(undefined *)(iVar10 + 0x84) = uVar4;
  }
  memset(&data,0,0x10);
  GetNetProfileString(param_2,"GATEWAY1",&data);
  StringSplit_Struct(&local_ac,&data,&DAT_10021168);
  if ((local_ac == 3) &&
     (iVar6 = atoi(acStack_a8), uVar4 = DAT_100b195f, uVar3 = DAT_100b195e, uVar2 = DAT_100b195d,
     iVar10 = g_pWrData, 0 < iVar6)) {
    *(undefined *)(g_pWrData + 0x85) = data;
    *(undefined *)(iVar10 + 0x86) = uVar2;
    uVar5 = DAT_100b1961;
    uVar2 = DAT_100b1960;
    *(undefined *)(iVar10 + 0x87) = uVar3;
    *(undefined *)(iVar10 + 0x88) = uVar4;
    uVar4 = DAT_100b1963;
    uVar3 = DAT_100b1962;
    *(undefined *)(iVar10 + 0x89) = uVar2;
    *(undefined *)(iVar10 + 0x8a) = uVar5;
    uVar5 = DAT_100b1965;
    uVar2 = DAT_100b1964;
    *(undefined *)(iVar10 + 0x8b) = uVar3;
    *(undefined *)(iVar10 + 0x8c) = uVar4;
    uVar4 = DAT_100b1967;
    uVar3 = DAT_100b1966;
    *(undefined *)(iVar10 + 0x8d) = uVar2;
    *(undefined *)(iVar10 + 0x8e) = uVar5;
    *(undefined *)(iVar10 + 0x8f) = uVar3;
    *(undefined *)(iVar10 + 0x90) = uVar4;
    uVar4 = DAT_100b196b;
    uVar3 = DAT_100b196a;
    uVar2 = DAT_100b1969;
    *(undefined *)(iVar10 + 0x91) = DAT_100b1968;
    *(undefined *)(iVar10 + 0x92) = uVar2;
    *(undefined *)(iVar10 + 0x93) = uVar3;
    *(undefined *)(iVar10 + 0x94) = uVar4;
  }
  memset(&data,0,0x10);
  memset(&data,0,0x10);
  GetNetProfileString(param_2,"Control_port.send_port1",&data);
  iVar6 = atoi(&data);
  iVar10 = g_pWrData;
  if (iVar6 == 0) {
    upldFlag = 8;
  }
  else {
    *(char *)(g_pWrData + 0x5d) = (char)((uint)iVar6 >> 0x18);
    *(char *)(iVar10 + 0x5e) = (char)((uint)iVar6 >> 0x10);
    *(char *)(iVar10 + 0x5f) = (char)((uint)iVar6 >> 8);
    *(char *)(iVar10 + 0x60) = (char)iVar6;
  }
  memset(&data,0,0x10);
  GetNetProfileString(param_2,"Control_port.receive_port1",&data);
  iVar6 = atoi(&data);
  iVar10 = g_pWrData;
  if (iVar6 == 0) {
    upldFlag = 8;
  }
  else {
    *(char *)(g_pWrData + 0x61) = (char)((uint)iVar6 >> 0x18);
    *(char *)(iVar10 + 0x62) = (char)((uint)iVar6 >> 0x10);
    *(char *)(iVar10 + 99) = (char)((uint)iVar6 >> 8);
    *(char *)(iVar10 + 100) = (char)iVar6;
  }
  memset(&data,0,0x10);
  GetNetProfileString(param_2,&DAT_100212fc,&data);
  StringSplit_Struct(&local_ac,&data,&DAT_10021168);
  if ((local_ac == 3) &&
     (iVar6 = atoi(acStack_a8), uVar4 = DAT_100b195f, uVar3 = DAT_100b195e, uVar2 = DAT_100b195d,
     iVar10 = g_pWrData, 0 < iVar6)) {
    *(undefined *)(g_pWrData + 0xa1) = data;
    *(undefined *)(iVar10 + 0xa2) = uVar2;
    uVar5 = DAT_100b1961;
    uVar2 = DAT_100b1960;
    *(undefined *)(iVar10 + 0xa3) = uVar3;
    *(undefined *)(iVar10 + 0xa4) = uVar4;
    uVar4 = DAT_100b1963;
    uVar3 = DAT_100b1962;
    *(undefined *)(iVar10 + 0xa5) = uVar2;
    *(undefined *)(iVar10 + 0xa6) = uVar5;
    uVar5 = DAT_100b1965;
    uVar2 = DAT_100b1964;
    *(undefined *)(iVar10 + 0xa7) = uVar3;
    *(undefined *)(iVar10 + 0xa8) = uVar4;
    uVar4 = DAT_100b1967;
    uVar3 = DAT_100b1966;
    *(undefined *)(iVar10 + 0xa9) = uVar2;
    *(undefined *)(iVar10 + 0xaa) = uVar5;
    *(undefined *)(iVar10 + 0xab) = uVar3;
    *(undefined *)(iVar10 + 0xac) = uVar4;
    uVar4 = DAT_100b196b;
    uVar3 = DAT_100b196a;
    uVar2 = DAT_100b1969;
    *(undefined *)(iVar10 + 0xad) = DAT_100b1968;
    *(undefined *)(iVar10 + 0xae) = uVar2;
    *(undefined *)(iVar10 + 0xaf) = uVar3;
    *(undefined *)(iVar10 + 0xb0) = uVar4;
  }
  memset(&data,0,0x10);
  GetNetProfileString(param_2,"MASK2",&data);
  StringSplit_Struct(&local_ac,&data,&DAT_10021168);
  if ((local_ac == 3) &&
     (iVar6 = atoi(acStack_a8), uVar4 = DAT_100b195f, uVar3 = DAT_100b195e, uVar2 = DAT_100b195d,
     iVar10 = g_pWrData, 0 < iVar6)) {
    *(undefined *)(g_pWrData + 0xb1) = data;
    *(undefined *)(iVar10 + 0xb2) = uVar2;
    uVar5 = DAT_100b1961;
    uVar2 = DAT_100b1960;
    *(undefined *)(iVar10 + 0xb3) = uVar3;
    *(undefined *)(iVar10 + 0xb4) = uVar4;
    uVar4 = DAT_100b1963;
    uVar3 = DAT_100b1962;
    *(undefined *)(iVar10 + 0xb5) = uVar2;
    *(undefined *)(iVar10 + 0xb6) = uVar5;
    uVar5 = DAT_100b1965;
    uVar2 = DAT_100b1964;
    *(undefined *)(iVar10 + 0xb7) = uVar3;
    *(undefined *)(iVar10 + 0xb8) = uVar4;
    uVar4 = DAT_100b1967;
    uVar3 = DAT_100b1966;
    *(undefined *)(iVar10 + 0xb9) = uVar2;
    *(undefined *)(iVar10 + 0xba) = uVar5;
    *(undefined *)(iVar10 + 0xbb) = uVar3;
    *(undefined *)(iVar10 + 0xbc) = uVar4;
    uVar4 = DAT_100b196b;
    uVar3 = DAT_100b196a;
    uVar2 = DAT_100b1969;
    *(undefined *)(iVar10 + 0xbd) = DAT_100b1968;
    *(undefined *)(iVar10 + 0xbe) = uVar2;
    *(undefined *)(iVar10 + 0xbf) = uVar3;
    *(undefined *)(iVar10 + 0xc0) = uVar4;
  }
  memset(&data,0,0x10);
  GetNetProfileString(param_2,"GATEWAY2",&data);
  StringSplit_Struct(&local_ac,&data,&DAT_10021168);
  if ((local_ac == 3) &&
     (iVar6 = atoi(acStack_a8), uVar4 = DAT_100b195f, uVar3 = DAT_100b195e, uVar2 = DAT_100b195d,
     iVar10 = g_pWrData, 0 < iVar6)) {
    *(undefined *)(g_pWrData + 0xc1) = data;
    *(undefined *)(iVar10 + 0xc2) = uVar2;
    uVar5 = DAT_100b1961;
    uVar2 = DAT_100b1960;
    *(undefined *)(iVar10 + 0xc3) = uVar3;
    *(undefined *)(iVar10 + 0xc4) = uVar4;
    uVar4 = DAT_100b1963;
    uVar3 = DAT_100b1962;
    *(undefined *)(iVar10 + 0xc5) = uVar2;
    *(undefined *)(iVar10 + 0xc6) = uVar5;
    uVar5 = DAT_100b1965;
    uVar2 = DAT_100b1964;
    *(undefined *)(iVar10 + 199) = uVar3;
    *(undefined *)(iVar10 + 200) = uVar4;
    uVar4 = DAT_100b1967;
    uVar3 = DAT_100b1966;
    *(undefined *)(iVar10 + 0xc9) = uVar2;
    *(undefined *)(iVar10 + 0xca) = uVar5;
    *(undefined *)(iVar10 + 0xcb) = uVar3;
    *(undefined *)(iVar10 + 0xcc) = uVar4;
    uVar4 = DAT_100b196b;
    uVar3 = DAT_100b196a;
    uVar2 = DAT_100b1969;
    *(undefined *)(iVar10 + 0xcd) = DAT_100b1968;
    *(undefined *)(iVar10 + 0xce) = uVar2;
    *(undefined *)(iVar10 + 0xcf) = uVar3;
    *(undefined *)(iVar10 + 0xd0) = uVar4;
  }
  memset(&data,0,0x10);
  GetNetProfileString(param_2,"Control_port.send_port2",&data);
  iVar6 = atoi(&data);
  iVar10 = g_pWrData;
  if (iVar6 == 0) {
    upldFlag = 8;
  }
  else {
    *(char *)(g_pWrData + 0x99) = (char)((uint)iVar6 >> 0x18);
    *(char *)(iVar10 + 0x9a) = (char)((uint)iVar6 >> 0x10);
    *(char *)(iVar10 + 0x9b) = (char)((uint)iVar6 >> 8);
    *(char *)(iVar10 + 0x9c) = (char)iVar6;
  }
  GetNetProfileString(param_2,"Control_port.receive_port2",&data);
  iVar6 = atoi(&data);
  iVar10 = g_pWrData;
  if (iVar6 == 0) {
    upldFlag = 8;
  }
  else {
    *(char *)(g_pWrData + 0x9d) = (char)((uint)iVar6 >> 0x18);
    *(char *)(iVar10 + 0x9e) = (char)((uint)iVar6 >> 0x10);
    *(char *)(iVar10 + 0x9f) = (char)((uint)iVar6 >> 8);
    *(char *)(iVar10 + 0xa0) = (char)iVar6;
  }
  iVar10 = 0;
  do {
    iVar9 = iVar10 * 0x12a;
    sprintf(acStack_68,PTR_s_Port_Name__d__10020a2c,iVar10);
    GetNetProfileString(param_2,acStack_68,acStack_1f8);
    strcpy((char *)(g_pWrData + iVar9 + 0x16f),acStack_1f8);
    memset(&data,0,0x10);
    sprintf(acStack_12c,PTR_s_Data_port__d__castMode_10020a30,iVar10);
    GetNetProfileString(param_2,acStack_12c,&data);
    iVar6 = atoi(&data);
    if (iVar6 - 1U < 3) {
      *(char *)(g_pWrData + iVar9 + 0xd5) = (char)iVar6;
    }
    memset(&data,0,0x10);
    sprintf(acStack_12c,"Data_port[%d].shujuyuan",iVar10);
    GetNetProfileString(param_2,acStack_12c,&data);
    uVar7 = atoi(&data);
    if (uVar7 < 3) {
      iVar6 = g_pWrData + iVar9;
      *(char *)(iVar6 + 0x1f7) = (char)(uVar7 >> 0x18);
      *(char *)(iVar6 + 0x1f8) = (char)(uVar7 >> 0x10);
      *(char *)(iVar6 + 0x1f9) = (char)(uVar7 >> 8);
      *(char *)(iVar6 + 0x1fa) = (char)uVar7;
    }
    memset(&data,0,0x10);
    sprintf(acStack_12c,"Data_port[%d].GroupAddr",iVar10);
    GetNetProfileString(param_2,acStack_12c,&data);
    StringSplit_Struct(&local_ac,&data,&DAT_10021168);
    if (local_ac == 3) {
      iVar6 = atoi(acStack_a8);
      uVar4 = DAT_100b195f;
      uVar3 = DAT_100b195e;
      uVar2 = DAT_100b195d;
      if (iVar6 - 0xe0U < 0x10) {
        iVar6 = g_pWrData + iVar9;
        *(undefined *)(iVar6 + 0x10f) = data;
        *(undefined *)(iVar6 + 0x110) = uVar2;
        uVar5 = DAT_100b1961;
        uVar2 = DAT_100b1960;
        *(undefined *)(iVar6 + 0x111) = uVar3;
        *(undefined *)(iVar6 + 0x112) = uVar4;
        uVar4 = DAT_100b1963;
        uVar3 = DAT_100b1962;
        *(undefined *)(iVar6 + 0x113) = uVar2;
        *(undefined *)(iVar6 + 0x114) = uVar5;
        uVar5 = DAT_100b1965;
        uVar2 = DAT_100b1964;
        *(undefined *)(iVar6 + 0x115) = uVar3;
        *(undefined *)(iVar6 + 0x116) = uVar4;
        uVar4 = DAT_100b1967;
        uVar3 = DAT_100b1966;
        *(undefined *)(iVar6 + 0x117) = uVar2;
        *(undefined *)(iVar6 + 0x118) = uVar5;
        *(undefined *)(iVar6 + 0x119) = uVar3;
        *(undefined *)(iVar6 + 0x11a) = uVar4;
        uVar4 = DAT_100b196b;
        uVar3 = DAT_100b196a;
        uVar2 = DAT_100b1969;
        *(undefined *)(iVar6 + 0x11b) = DAT_100b1968;
        *(undefined *)(iVar6 + 0x11c) = uVar2;
        *(undefined *)(iVar6 + 0x11d) = uVar3;
        *(undefined *)(iVar6 + 0x11e) = uVar4;
      }
    }
    else {
      upldFlag = 8;
    }
    memset(&data,0,0x10);
    sprintf(acStack_12c,"Data_port[%d].addrTo1",iVar10);
    GetNetProfileString(param_2,acStack_12c,&data);
    StringSplit_Struct(&local_ac,&data,&DAT_10021168);
    uVar4 = DAT_100b195f;
    uVar3 = DAT_100b195e;
    uVar2 = DAT_100b195d;
    if (local_ac == 3) {
      iVar6 = g_pWrData + iVar9;
      *(undefined *)(iVar6 + 0x12f) = data;
      *(undefined *)(iVar6 + 0x130) = uVar2;
      uVar5 = DAT_100b1961;
      uVar2 = DAT_100b1960;
      *(undefined *)(iVar6 + 0x131) = uVar3;
      *(undefined *)(iVar6 + 0x132) = uVar4;
      uVar4 = DAT_100b1963;
      uVar3 = DAT_100b1962;
      *(undefined *)(iVar6 + 0x133) = uVar2;
      *(undefined *)(iVar6 + 0x134) = uVar5;
      uVar5 = DAT_100b1965;
      uVar2 = DAT_100b1964;
      *(undefined *)(iVar6 + 0x135) = uVar3;
      *(undefined *)(iVar6 + 0x136) = uVar4;
      uVar4 = DAT_100b1967;
      uVar3 = DAT_100b1966;
      *(undefined *)(iVar6 + 0x137) = uVar2;
      *(undefined *)(iVar6 + 0x138) = uVar5;
      *(undefined *)(iVar6 + 0x139) = uVar3;
      *(undefined *)(iVar6 + 0x13a) = uVar4;
      uVar4 = DAT_100b196b;
      uVar3 = DAT_100b196a;
      uVar2 = DAT_100b1969;
      *(undefined *)(iVar6 + 0x13b) = DAT_100b1968;
      *(undefined *)(iVar6 + 0x13c) = uVar2;
      *(undefined *)(iVar6 + 0x13d) = uVar3;
      *(undefined *)(iVar6 + 0x13e) = uVar4;
    }
    else {
      upldFlag = 8;
    }
    memset(&data,0,0x10);
    sprintf(acStack_12c,"Data_port[%d].send_port_broad",iVar10);
    GetNetProfileString(param_2,acStack_12c,&data);
    iVar6 = atoi(&data);
    if (iVar6 == 0) {
      upldFlag = 8;
    }
    else {
      iVar8 = g_pWrData + iVar9;
      *(char *)(iVar8 + 0xdf) = (char)((uint)iVar6 >> 0x18);
      *(char *)(iVar8 + 0xe0) = (char)((uint)iVar6 >> 0x10);
      *(char *)(iVar8 + 0xe1) = (char)((uint)iVar6 >> 8);
      *(char *)(iVar8 + 0xe2) = (char)iVar6;
    }
    memset(&data,0,0x10);
    sprintf(acStack_12c,"Data_port[%d].receive_port_broad",iVar10);
    GetNetProfileString(param_2,acStack_12c,&data);
    iVar6 = atoi(&data);
    if (iVar6 == 0) {
      upldFlag = 8;
    }
    else {
      iVar8 = g_pWrData + iVar9;
      *(char *)(iVar8 + 0xe7) = (char)((uint)iVar6 >> 0x18);
      *(char *)(iVar8 + 0xe8) = (char)((uint)iVar6 >> 0x10);
      *(char *)(iVar8 + 0xe9) = (char)((uint)iVar6 >> 8);
      *(char *)(iVar8 + 0xea) = (char)iVar6;
    }
    memset(&data,0,0x10);
    sprintf(acStack_12c,"Data_port[%d].send_port_group",iVar10);
    GetNetProfileString(param_2,acStack_12c,&data);
    iVar6 = atoi(&data);
    if (iVar6 == 0) {
      upldFlag = 8;
    }
    else {
      iVar8 = g_pWrData + iVar9;
      *(char *)(iVar8 + 0xef) = (char)((uint)iVar6 >> 0x18);
      *(char *)(iVar8 + 0xf0) = (char)((uint)iVar6 >> 0x10);
      *(char *)(iVar8 + 0xf1) = (char)((uint)iVar6 >> 8);
      *(char *)(iVar8 + 0xf2) = (char)iVar6;
    }
    memset(&data,0,0x10);
    sprintf(acStack_12c,"Data_port[%d].receive_port_group",iVar10);
    GetNetProfileString(param_2,acStack_12c,&data);
    iVar6 = atoi(&data);
    if (iVar6 == 0) {
      upldFlag = 8;
    }
    else {
      iVar8 = g_pWrData + iVar9;
      *(char *)(iVar8 + 0xf7) = (char)((uint)iVar6 >> 0x18);
      *(char *)(iVar8 + 0xf8) = (char)((uint)iVar6 >> 0x10);
      *(char *)(iVar8 + 0xf9) = (char)((uint)iVar6 >> 8);
      *(char *)(iVar8 + 0xfa) = (char)iVar6;
    }
    memset(&data,0,0x10);
    sprintf(acStack_12c,"Data_port[%d].send_port_danbo",iVar10);
    GetNetProfileString(param_2,acStack_12c,&data);
    iVar6 = atoi(&data);
    if (iVar6 == 0) {
      upldFlag = 8;
    }
    else {
      iVar8 = g_pWrData + iVar9;
      *(char *)(iVar8 + 0xff) = (char)((uint)iVar6 >> 0x18);
      *(char *)(iVar8 + 0x100) = (char)((uint)iVar6 >> 0x10);
      *(char *)(iVar8 + 0x101) = (char)((uint)iVar6 >> 8);
      *(char *)(iVar8 + 0x102) = (char)iVar6;
    }
    memset(&data,0,0x10);
    sprintf(acStack_12c,"Data_port[%d].receive_port_danbo",iVar10);
    GetNetProfileString(param_2,acStack_12c,&data);
    iVar6 = atoi(&data);
    if (iVar6 == 0) {
      upldFlag = 8;
    }
    else {
      iVar8 = g_pWrData + iVar9;
      *(char *)(iVar8 + 0x107) = (char)((uint)iVar6 >> 0x18);
      *(char *)(iVar8 + 0x108) = (char)((uint)iVar6 >> 0x10);
      *(char *)(iVar8 + 0x109) = (char)((uint)iVar6 >> 8);
      *(char *)(iVar8 + 0x10a) = (char)iVar6;
    }
    memset(&data,0,0x10);
    sprintf(acStack_12c,"Data_port[%d].GroupAddr1",iVar10);
    GetNetProfileString(param_2,acStack_12c,&data);
    StringSplit_Struct(&local_ac,&data,&DAT_10021168);
    if (local_ac == 3) {
      iVar6 = atoi(acStack_a8);
      uVar4 = DAT_100b195f;
      uVar3 = DAT_100b195e;
      uVar2 = DAT_100b195d;
      if (iVar6 - 0xe0U < 0x10) {
        iVar6 = g_pWrData + iVar9;
        *(undefined *)(iVar6 + 0x11f) = data;
        *(undefined *)(iVar6 + 0x120) = uVar2;
        uVar5 = DAT_100b1961;
        uVar2 = DAT_100b1960;
        *(undefined *)(iVar6 + 0x121) = uVar3;
        *(undefined *)(iVar6 + 0x122) = uVar4;
        uVar4 = DAT_100b1963;
        uVar3 = DAT_100b1962;
        *(undefined *)(iVar6 + 0x123) = uVar2;
        *(undefined *)(iVar6 + 0x124) = uVar5;
        uVar5 = DAT_100b1965;
        uVar2 = DAT_100b1964;
        *(undefined *)(iVar6 + 0x125) = uVar3;
        *(undefined *)(iVar6 + 0x126) = uVar4;
        uVar4 = DAT_100b1967;
        uVar3 = DAT_100b1966;
        *(undefined *)(iVar6 + 0x127) = uVar2;
        *(undefined *)(iVar6 + 0x128) = uVar5;
        *(undefined *)(iVar6 + 0x129) = uVar3;
        *(undefined *)(iVar6 + 0x12a) = uVar4;
        uVar4 = DAT_100b196b;
        uVar3 = DAT_100b196a;
        uVar2 = DAT_100b1969;
        *(undefined *)(iVar6 + 299) = DAT_100b1968;
        *(undefined *)(iVar6 + 300) = uVar2;
        *(undefined *)(iVar6 + 0x12d) = uVar3;
        *(undefined *)(iVar6 + 0x12e) = uVar4;
      }
    }
    else {
      upldFlag = 8;
    }
    memset(&data,0,0x10);
    sprintf(acStack_12c,"Data_port[%d].addrTo2",iVar10);
    GetNetProfileString(param_2,acStack_12c,&data);
    StringSplit_Struct(&local_ac,&data,&DAT_10021168);
    uVar4 = DAT_100b195f;
    uVar3 = DAT_100b195e;
    uVar2 = DAT_100b195d;
    if (local_ac == 3) {
      iVar6 = g_pWrData + iVar9;
      *(undefined *)(iVar6 + 0x13f) = data;
      *(undefined *)(iVar6 + 0x140) = uVar2;
      uVar5 = DAT_100b1961;
      uVar2 = DAT_100b1960;
      *(undefined *)(iVar6 + 0x141) = uVar3;
      *(undefined *)(iVar6 + 0x142) = uVar4;
      uVar4 = DAT_100b1963;
      uVar3 = DAT_100b1962;
      *(undefined *)(iVar6 + 0x143) = uVar2;
      *(undefined *)(iVar6 + 0x144) = uVar5;
      uVar5 = DAT_100b1965;
      uVar2 = DAT_100b1964;
      *(undefined *)(iVar6 + 0x145) = uVar3;
      *(undefined *)(iVar6 + 0x146) = uVar4;
      uVar4 = DAT_100b1967;
      uVar3 = DAT_100b1966;
      *(undefined *)(iVar6 + 0x147) = uVar2;
      *(undefined *)(iVar6 + 0x148) = uVar5;
      *(undefined *)(iVar6 + 0x149) = uVar3;
      *(undefined *)(iVar6 + 0x14a) = uVar4;
      uVar4 = DAT_100b196b;
      uVar3 = DAT_100b196a;
      uVar2 = DAT_100b1969;
      *(undefined *)(iVar6 + 0x14b) = DAT_100b1968;
      *(undefined *)(iVar6 + 0x14c) = uVar2;
      *(undefined *)(iVar6 + 0x14d) = uVar3;
      *(undefined *)(iVar6 + 0x14e) = uVar4;
    }
    else {
      upldFlag = 8;
    }
    sprintf(acStack_12c,"Data_port[%d].send_port_broad1",iVar10);
    GetNetProfileString(param_2,acStack_12c,&data);
    iVar8 = atoi(&data);
    iVar6 = g_pWrData;
    if (iVar8 == 0) {
      upldFlag = 8;
    }
    iVar8 = atoi(&data);
    iVar6 = iVar6 + iVar9;
    *(char *)(iVar6 + 0xe3) = (char)((uint)iVar8 >> 0x18);
    *(char *)(iVar6 + 0xe4) = (char)((uint)iVar8 >> 0x10);
    *(char *)(iVar6 + 0xe6) = (char)iVar8;
    *(char *)(iVar6 + 0xe5) = (char)((uint)iVar8 >> 8);
    sprintf(acStack_12c,"Data_port[%d].receive_port_broad1",iVar10);
    GetNetProfileString(param_2,acStack_12c,&data);
    iVar8 = atoi(&data);
    iVar6 = g_pWrData;
    if (iVar8 == 0) {
      upldFlag = 8;
    }
    iVar8 = atoi(&data);
    iVar6 = iVar6 + iVar9;
    *(char *)(iVar6 + 0xeb) = (char)((uint)iVar8 >> 0x18);
    *(char *)(iVar6 + 0xec) = (char)((uint)iVar8 >> 0x10);
    *(char *)(iVar6 + 0xee) = (char)iVar8;
    *(char *)(iVar6 + 0xed) = (char)((uint)iVar8 >> 8);
    sprintf(acStack_12c,"Data_port[%d].send_port_group1",iVar10);
    GetNetProfileString(param_2,acStack_12c,&data);
    iVar8 = atoi(&data);
    iVar6 = g_pWrData;
    if (iVar8 == 0) {
      upldFlag = 8;
    }
    iVar8 = atoi(&data);
    iVar6 = iVar6 + iVar9;
    *(char *)(iVar6 + 0xf3) = (char)((uint)iVar8 >> 0x18);
    *(char *)(iVar6 + 0xf4) = (char)((uint)iVar8 >> 0x10);
    *(char *)(iVar6 + 0xf6) = (char)iVar8;
    *(char *)(iVar6 + 0xf5) = (char)((uint)iVar8 >> 8);
    sprintf(acStack_12c,"Data_port[%d].receive_port_group1",iVar10);
    GetNetProfileString(param_2,acStack_12c,&data);
    iVar8 = atoi(&data);
    iVar6 = g_pWrData;
    if (iVar8 == 0) {
      upldFlag = 8;
    }
    iVar8 = atoi(&data);
    iVar6 = iVar6 + iVar9;
    *(char *)(iVar6 + 0xfb) = (char)((uint)iVar8 >> 0x18);
    *(char *)(iVar6 + 0xfc) = (char)((uint)iVar8 >> 0x10);
    *(char *)(iVar6 + 0xfe) = (char)iVar8;
    *(char *)(iVar6 + 0xfd) = (char)((uint)iVar8 >> 8);
    sprintf(acStack_12c,"Data_port[%d].send_port_danbo1",iVar10);
    GetNetProfileString(param_2,acStack_12c,&data);
    iVar8 = atoi(&data);
    iVar6 = g_pWrData;
    if (iVar8 == 0) {
      upldFlag = 8;
    }
    iVar8 = atoi(&data);
    iVar6 = iVar6 + iVar9;
    *(char *)(iVar6 + 0x103) = (char)((uint)iVar8 >> 0x18);
    *(char *)(iVar6 + 0x104) = (char)((uint)iVar8 >> 0x10);
    *(char *)(iVar6 + 0x106) = (char)iVar8;
    *(char *)(iVar6 + 0x105) = (char)((uint)iVar8 >> 8);
    sprintf(acStack_12c,"Data_port[%d].receive_port_danbo1",iVar10);
    GetNetProfileString(param_2,acStack_12c,&data);
    iVar8 = atoi(&data);
    iVar6 = g_pWrData;
    if (iVar8 == 0) {
      upldFlag = 8;
    }
    iVar8 = atoi(&data);
    iVar6 = iVar6 + iVar9;
    *(char *)(iVar6 + 0x10b) = (char)((uint)iVar8 >> 0x18);
    *(char *)(iVar6 + 0x10c) = (char)((uint)iVar8 >> 0x10);
    *(char *)(iVar6 + 0x10e) = (char)iVar8;
    *(char *)(iVar6 + 0x10d) = (char)((uint)iVar8 >> 8);
    sprintf(acStack_12c,"Data_port[%d].TongBu",iVar10);
    GetNetProfileString(param_2,acStack_12c,&data);
    iVar6 = atoi(&data);
    if (iVar6 == 0) {
      upldFlag = 8;
    }
    local_58 = g_pWrData;
    iVar6 = atoi(&data);
    *(char *)(local_58 + iVar9 + 0xd6) = (char)iVar6;
    sprintf(acStack_12c,"Data_port[%d].XieYi",iVar10);
    GetNetProfileString(param_2,acStack_12c,&data);
    iVar6 = atoi(&data);
    if (iVar6 == 0) {
      upldFlag = 8;
    }
    local_58 = g_pWrData;
    iVar6 = atoi(&data);
    *(char *)(local_58 + iVar9 + 0xd7) = (char)iVar6;
    sprintf(acStack_12c,"Data_port[%d].SuLv",iVar10);
    GetNetProfileString(param_2,acStack_12c,&data);
    iVar6 = atoi(&data);
    if (iVar6 == 0) {
      upldFlag = 8;
    }
    local_58 = g_pWrData;
    iVar6 = atoi(&data);
    iVar8 = local_58 + iVar9;
    *(char *)(iVar8 + 0xd8) = (char)((uint)iVar6 >> 0x18);
    *(char *)(iVar8 + 0xd9) = (char)((uint)iVar6 >> 0x10);
    *(char *)(iVar8 + 0xdb) = (char)iVar6;
    *(char *)(iVar8 + 0xda) = (char)((uint)iVar6 >> 8);
    sprintf(acStack_12c,"Data_port[%d].ShuJuWei",iVar10);
    GetNetProfileString(param_2,acStack_12c,&data);
    iVar6 = atoi(&data);
    if (iVar6 == 0) {
      upldFlag = 8;
    }
    local_58 = g_pWrData;
    iVar6 = atoi(&data);
    *(char *)(local_58 + iVar9 + 0xdc) = (char)iVar6;
    sprintf(acStack_12c,"Data_port[%d].TingZhiWei",iVar10);
    GetNetProfileString(param_2,acStack_12c,&data);
    iVar6 = atoi(&data);
    if (iVar6 == 0) {
      upldFlag = 8;
    }
    local_58 = g_pWrData;
    iVar6 = atoi(&data);
    *(char *)(local_58 + iVar9 + 0xdd) = (char)iVar6;
    sprintf(acStack_12c,"Data_port[%d].JiaoYanWei",iVar10);
    GetNetProfileString(param_2,acStack_12c,&data);
    iVar6 = atoi(&data);
    if (iVar6 == 0) {
      upldFlag = 8;
    }
    local_58 = g_pWrData;
    iVar6 = atoi(&data);
    *(char *)(local_58 + iVar9 + 0xde) = (char)iVar6;
    sprintf(acStack_12c,"Data_port[%d].Clk_Choice",iVar10);
    GetNetProfileString(param_2,acStack_12c,&data);
    iVar6 = atoi(&data);
    if (iVar6 == 0) {
      upldFlag = 8;
    }
    local_58 = g_pWrData;
    iVar6 = atoi(&data);
    bVar1 = iVar10 != 0xf;
    iVar10 = iVar10 + 1;
    *(char *)(local_58 + iVar9 + 0xd4) = (char)iVar6;
  } while (bVar1);
  return 0;
}
----------------------------------------

Function: upldForm

/* WARNING: Control flow encountered bad instruction data */

void upldForm(int param_1)

{
  char *pcVar1;
  char *pcVar2;
  char *__s;
  int iVar3;
  FILE *__stream;
  size_t sVar4;
  int iVar5;
  undefined *puVar6;
  int iVar7;
  size_t __n;
  byte in_cr0;
  byte in_cr1;
  byte unaff_cr2;
  byte unaff_cr3;
  byte unaff_cr4;
  byte in_cr5;
  byte in_cr6;
  byte in_cr7;
  char acStack_4b8 [1024];
  char acStack_b8 [136];
  uint local_30;
  
  local_30 = (uint)(in_cr0 & 0xf) << 0x1c | (uint)(in_cr1 & 0xf) << 0x18 |
             (uint)(unaff_cr2 & 0xf) << 0x14 | (uint)(unaff_cr3 & 0xf) << 0x10 |
             (uint)(unaff_cr4 & 0xf) << 0xc | (uint)(in_cr5 & 0xf) << 8 | (uint)(in_cr6 & 0xf) << 4
             | (uint)(in_cr7 & 0xf);
  upldFlag = 0;
  pcVar1 = (char *)websGetVar(param_1,"filename",&DAT_10023fc4);
  if ((pcVar1 == (char *)0x0) || (*pcVar1 == '\0')) {
    __s = (char *)0x0;
    upldFlag = 6;
    iVar7 = upldFlag;
  }
  else {
    pcVar2 = strrchr(pcVar1,0x2f);
    __s = pcVar2 + 1;
    if (pcVar2 == (char *)0x0) {
      strrchr(pcVar1,0x5c);
                    /* WARNING: Bad instruction - Truncating control flow here */
      halt_baddata();
    }
    sprintf(acStack_4b8,"/usr/local/webs/%s",__s);
    pcVar1 = strchr(__s,0x2e);
    iVar3 = strcmp(pcVar1 + 1,"txt");
    iVar7 = 7;
    if (iVar3 == 0) {
      __stream = fopen(acStack_4b8,"w+b");
      iVar7 = 1;
      if (__stream != (FILE *)0x0) {
        iVar7 = 0;
        for (__n = *(size_t *)(param_1 + 0x110); 0 < (int)__n; __n = __n - sVar4) {
          sVar4 = fwrite((void *)(*(int *)(param_1 + 0xec) + iVar7),1,__n,__stream);
          if ((int)sVar4 < (int)__n) goto LAB_100061c4;
          iVar7 = iVar7 + sVar4;
        }
        if (__n == 0) {
          iVar3 = fclose(__stream);
          iVar7 = 3;
          if (iVar3 == 0) {
            iVar7 = 4;
          }
        }
        else {
LAB_100061c4:
          iVar7 = 5;
        }
      }
    }
  }
  upldFlag = iVar7;
  iVar7 = httpPlatformOpen("/UpgradeFirmware.htm",0);
  if (-1 < iVar7) {
    iVar3 = InitReadString();
    if (-1 < iVar3) {
      if (upldFlag == 4) {
        Chang_Mem_Data(param_1,acStack_4b8);
        BtnFlag = 0;
        if (upldFlag == 8) {
          sprintf(acStack_b8,"rm %s",acStack_4b8);
          system(acStack_b8);
        }
        else {
          LOAD_Data(0);
          LOAD_Data(1);
        }
      }
      while( true ) {
        iVar3 = ReadString(iVar7,buf,0x1000);
        if (iVar3 < 0) goto LAB_10006444;
        if (iVar3 == 0) goto LAB_10006404;
        buf[iVar3] = 0;
        iVar5 = strcmp(buf,"<!--ImportMsg -->");
        if (iVar5 == 0) break;
        websWriteDataNonBlock(param_1,buf,iVar3);
        websWrite(param_1,&DAT_10022d7c);
      }
      if (upldFlag == 1) {
        puVar6 = &DAT_10022d7c;
      }
      else {
        if (upldFlag == 2) {
          puVar6 = &DAT_10021660;
LAB_100062f8:
          websWrite(param_1,puVar6,__s);
          goto LAB_10006404;
        }
        if (upldFlag == 3) {
          puVar6 = &DAT_10021674;
          goto LAB_100062f8;
        }
        if (upldFlag == 4) {
          puVar6 = &DAT_10021688;
          goto LAB_100062f8;
        }
        if (upldFlag == 5) {
          puVar6 = &DAT_100216a8;
          goto LAB_100062f8;
        }
        if (upldFlag == 6) {
          puVar6 = &DAT_100216bc;
        }
        else {
          if (upldFlag == 7) {
            puVar6 = &DAT_100216d4;
            goto LAB_1000636c;
          }
          if (upldFlag != 8) goto LAB_10006404;
          puVar6 = &DAT_100216e4;
        }
      }
LAB_1000636c:
      websWrite(param_1,puVar6);
LAB_10006404:
      while( true ) {
        iVar3 = ReadString(iVar7,buf,0x1000);
        if (iVar3 < 0) break;
        if (iVar3 == 0) {
          if (iVar7 != 0) {
            httpPlatformClose(iVar7);
          }
          websFooter(param_1);
          websDone(param_1,200);
          return;
        }
        iVar5 = 0;
        do {
          iVar5 = websWriteDataNonBlock(param_1,buf + iVar5,iVar3);
          if (iVar5 < 0) goto LAB_10006444;
          iVar3 = iVar3 - iVar5;
        } while (iVar3 != 0);
        websWrite(param_1,&DAT_10022d7c);
      }
    }
LAB_10006444:
    if (iVar7 != 0) {
      httpPlatformClose(iVar7);
    }
  }
  websError(param_1,0x194,"Cannot open URL:%s","/UpgradeFirmware.htm");
  return;
}
----------------------------------------

Function: Restore_Data

void Restore_Data(void)

{
  system("rm /usr/local/webs -rf");
  system("rm /mnt/nandflash/CRC -rf");
  system("rm /mnt/nandflash/Data -rf");
  system("rm /mnt/nandflash/log.txt -rf");
  system("rm /mnt/nandflash/tempture -rf");
  return;
}
----------------------------------------

Function: restore_NetSave

void restore_NetSave(void)

{
  char acStack_88 [132];
  
  memset(acStack_88,0,0x80);
  sprintf(acStack_88,"uci set network.lan0.ipaddr=%s","192.168.0.249");
  system(acStack_88);
  memset(acStack_88,0,0x80);
  sprintf(acStack_88,"uci set network.lan0.netmask=%s","255.255.255.0");
  system(acStack_88);
  memset(acStack_88,0,0x80);
  sprintf(acStack_88,"uci set network.lan0.gateway=%s","192.168.0.1");
  system(acStack_88);
  memset(acStack_88,0,0x80);
  sprintf(acStack_88,"uci set network.lan1.ipaddr=%s","192.168.1.249");
  system(acStack_88);
  memset(acStack_88,0,0x80);
  sprintf(acStack_88,"uci set network.lan1.netmask=%s","255.255.255.0");
  system(acStack_88);
  memset(acStack_88,0,0x80);
  sprintf(acStack_88,"uci set network.lan1.gateway=%s","192.168.1.1");
  system(acStack_88);
  system("uci commit network");
  return;
}
----------------------------------------

Function: IsUpdateFireWare

void IsUpdateFireWare(void)

{
  int iVar1;
  char acStack_108 [128];
  char acStack_88 [128];
  
  iVar1 = access("/usr/local/PowerApp",0);
  if (iVar1 == 0) {
    iVar1 = detect_process("PowerApp");
    if (iVar1 != 0) {
      memset(acStack_108,0,0x80);
      sprintf(acStack_108,"/usr/bin/killall %s","PowerApp");
      system(acStack_108);
    }
    memset(acStack_88,0,0x80);
    sprintf(acStack_88,"/bin/mv %s %s","/usr/local/PowerApp","/usr/local/test/PowerApp");
    system(acStack_88);
  }
  return;
}
----------------------------------------

Function: S_Chang_Bg_color

void S_Chang_Bg_color(int param_1,undefined4 param_2,undefined4 param_3)

{
  int iVar1;
  int iVar2;
  
  switch(param_3) {
  case 0:
    while( true ) {
      iVar1 = ReadString(param_1,buf,0x1000);
      nCount = iVar1;
      if (iVar1 < 0) break;
      if (iVar1 == 0) {
        return;
      }
      buf[iVar1] = 0;
      iVar2 = strcmp(buf,"<!--Set1 -->");
      if (iVar2 == 0) goto LAB_10007a14;
      websWriteDataNonBlock(param_2,buf,iVar1);
      websWrite(param_2,&DAT_10022d7c);
    }
    break;
  case 1:
    while( true ) {
      iVar1 = ReadString(param_1,buf,0x1000);
      nCount = iVar1;
      if (iVar1 < 0) break;
      if (iVar1 == 0) {
        return;
      }
      buf[iVar1] = 0;
      iVar2 = strcmp(buf,"<!--Set2 -->");
      if (iVar2 == 0) goto LAB_10007a14;
      websWriteDataNonBlock(param_2,buf,iVar1);
      websWrite(param_2,&DAT_10022d7c);
    }
    break;
  case 2:
    while( true ) {
      iVar1 = ReadString(param_1,buf,0x1000);
      nCount = iVar1;
      if (iVar1 < 0) break;
      if (iVar1 == 0) {
        return;
      }
      buf[iVar1] = 0;
      iVar2 = strcmp(buf,"<!--Set3 -->");
      if (iVar2 == 0) goto LAB_10007a14;
      websWriteDataNonBlock(param_2,buf,iVar1);
      websWrite(param_2,&DAT_10022d7c);
    }
    break;
  case 3:
    while( true ) {
      iVar1 = ReadString(param_1,buf,0x1000);
      nCount = iVar1;
      if (iVar1 < 0) break;
      if (iVar1 == 0) {
        return;
      }
      buf[iVar1] = 0;
      iVar2 = strcmp(buf,"<!--Set4 -->");
      if (iVar2 == 0) goto LAB_10007a14;
      websWriteDataNonBlock(param_2,buf,iVar1);
      websWrite(param_2,&DAT_10022d7c);
    }
    break;
  case 4:
    while( true ) {
      iVar1 = ReadString(param_1,buf,0x1000);
      nCount = iVar1;
      if (iVar1 < 0) break;
      if (iVar1 == 0) {
        return;
      }
      buf[iVar1] = 0;
      iVar2 = strcmp(buf,"<!--Set5 -->");
      if (iVar2 == 0) goto LAB_10007a14;
      websWriteDataNonBlock(param_2,buf,iVar1);
      websWrite(param_2,&DAT_10022d7c);
    }
    break;
  case 5:
    while( true ) {
      iVar1 = ReadString(param_1,buf,0x1000);
      nCount = iVar1;
      if (iVar1 < 0) break;
      if (iVar1 == 0) {
        return;
      }
      buf[iVar1] = 0;
      iVar2 = strcmp(buf,"<!--Set6 -->");
      if (iVar2 == 0) goto LAB_10007a14;
      websWriteDataNonBlock(param_2,buf,iVar1);
      websWrite(param_2,&DAT_10022d7c);
    }
    break;
  case 6:
    while( true ) {
      iVar1 = ReadString(param_1,buf,0x1000);
      nCount = iVar1;
      if (iVar1 < 0) break;
      if (iVar1 == 0) {
        return;
      }
      buf[iVar1] = 0;
      iVar2 = strcmp(buf,"<!--Set7 -->");
      if (iVar2 == 0) goto LAB_10007a14;
      websWriteDataNonBlock(param_2,buf,iVar1);
      websWrite(param_2,&DAT_10022d7c);
    }
    break;
  case 7:
    while( true ) {
      iVar1 = ReadString(param_1,buf,0x1000);
      nCount = iVar1;
      if (iVar1 < 0) break;
      if (iVar1 == 0) {
        return;
      }
      buf[iVar1] = 0;
      iVar2 = strcmp(buf,"<!--Set8 -->");
      if (iVar2 == 0) goto LAB_10007a14;
      websWriteDataNonBlock(param_2,buf,iVar1);
      websWrite(param_2,&DAT_10022d7c);
    }
    break;
  case 8:
    while( true ) {
      iVar1 = ReadString(param_1,buf,0x1000);
      nCount = iVar1;
      if (iVar1 < 0) break;
      if (iVar1 == 0) {
        return;
      }
      buf[iVar1] = 0;
      iVar2 = strcmp(buf,"<!--Set9 -->");
      if (iVar2 == 0) goto LAB_10007a14;
      websWriteDataNonBlock(param_2,buf,iVar1);
      websWrite(param_2,&DAT_10022d7c);
    }
    break;
  case 9:
    while( true ) {
      iVar1 = ReadString(param_1,buf,0x1000);
      nCount = iVar1;
      if (iVar1 < 0) break;
      if (iVar1 == 0) {
        return;
      }
      buf[iVar1] = 0;
      iVar2 = strcmp(buf,"<!--Set10 -->");
      if (iVar2 == 0) goto LAB_10007a14;
      websWriteDataNonBlock(param_2,buf,iVar1);
      websWrite(param_2,&DAT_10022d7c);
    }
    break;
  case 10:
    while( true ) {
      iVar1 = ReadString(param_1,buf,0x1000);
      nCount = iVar1;
      if (iVar1 < 0) break;
      if (iVar1 == 0) {
        return;
      }
      buf[iVar1] = 0;
      iVar2 = strcmp(buf,"<!--Set11 -->");
      if (iVar2 == 0) goto LAB_10007a14;
      websWriteDataNonBlock(param_2,buf,iVar1);
      websWrite(param_2,&DAT_10022d7c);
    }
    break;
  case 0xb:
    while( true ) {
      iVar1 = ReadString(param_1,buf,0x1000);
      nCount = iVar1;
      if (iVar1 < 0) break;
      if (iVar1 == 0) {
        return;
      }
      buf[iVar1] = 0;
      iVar2 = strcmp(buf,"<!--Set12 -->");
      if (iVar2 == 0) goto LAB_10007a14;
      websWriteDataNonBlock(param_2,buf,iVar1);
      websWrite(param_2,&DAT_10022d7c);
    }
    break;
  case 0xc:
    while( true ) {
      iVar1 = ReadString(param_1,buf,0x1000);
      nCount = iVar1;
      if (iVar1 < 0) break;
      if (iVar1 == 0) {
        return;
      }
      buf[iVar1] = 0;
      iVar2 = strcmp(buf,"<!--Set13 -->");
      if (iVar2 == 0) goto LAB_10007a14;
      websWriteDataNonBlock(param_2,buf,iVar1);
      websWrite(param_2,&DAT_10022d7c);
    }
    break;
  case 0xd:
    while( true ) {
      iVar1 = ReadString(param_1,buf,0x1000);
      nCount = iVar1;
      if (iVar1 < 0) break;
      if (iVar1 == 0) {
        return;
      }
      buf[iVar1] = 0;
      iVar2 = strcmp(buf,"<!--Set14 -->");
      if (iVar2 == 0) goto LAB_10007a14;
      websWriteDataNonBlock(param_2,buf,iVar1);
      websWrite(param_2,&DAT_10022d7c);
    }
    break;
  case 0xe:
    while( true ) {
      iVar1 = ReadString(param_1,buf,0x1000);
      nCount = iVar1;
      if (iVar1 < 0) break;
      if (iVar1 == 0) {
        return;
      }
      buf[iVar1] = 0;
      iVar2 = strcmp(buf,"<!--Set15 -->");
      if (iVar2 == 0) goto LAB_10007a14;
      websWriteDataNonBlock(param_2,buf,iVar1);
      websWrite(param_2,&DAT_10022d7c);
    }
    break;
  case 0xf:
    while( true ) {
      iVar1 = ReadString(param_1,buf,0x1000);
      nCount = iVar1;
      if (iVar1 < 0) break;
      if (iVar1 == 0) {
        return;
      }
      buf[iVar1] = 0;
      iVar2 = strcmp(buf,"<!--Set16 -->");
      if (iVar2 == 0) goto LAB_10007a14;
      websWriteDataNonBlock(param_2,buf,iVar1);
      websWrite(param_2,&DAT_10022d7c);
    }
    break;
  case 0x10:
    while( true ) {
      iVar1 = ReadString(param_1,buf,0x1000);
      nCount = iVar1;
      if (iVar1 < 0) break;
      if (iVar1 == 0) {
        return;
      }
      buf[iVar1] = 0;
      iVar2 = strcmp(buf,"<!--Interface0 -->");
      if (iVar2 == 0) goto LAB_10007a14;
      websWriteDataNonBlock(param_2,buf,iVar1);
      websWrite(param_2,&DAT_10022d7c);
    }
    break;
  case 0x11:
    while( true ) {
      iVar1 = ReadString(param_1,buf,0x1000);
      nCount = iVar1;
      if (iVar1 < 0) break;
      if (iVar1 == 0) {
        return;
      }
      buf[iVar1] = 0;
      iVar2 = strcmp(buf,"<!--Interface1 -->");
      if (iVar2 == 0) goto LAB_10007a14;
      websWriteDataNonBlock(param_2,buf,iVar1);
      websWrite(param_2,&DAT_10022d7c);
    }
    break;
  default:
    return;
  }
LAB_10007248:
  if (0 < param_1) {
    httpPlatformClose(param_1);
  }
  websError(param_2,0x194,"Cannot open URL:%s","/Port_State8s.htm");
  return;
LAB_10007a14:
  nCount = ReadString(param_1,buf,0x1000);
  if (-1 < nCount) {
    if (nCount != 0) {
      websWriteDataNonBlock(param_2,buf,nCount + -3);
      websWrite(param_2,"background-color:");
      websWriteDataNonBlock(param_2,"#00FFFF",7);
      websWrite(param_2,&DAT_10020f9c);
      return;
    }
    return;
  }
  goto LAB_10007248;
}
----------------------------------------

Function: Chang_Bg_color

void Chang_Bg_color(undefined4 param_1,undefined4 param_2)

{
  int iVar1;
  int iVar2;
  
  switch(param_2) {
  case 0:
    while( true ) {
      iVar1 = ReadString(fd,buf,0x1000);
      nCount = iVar1;
      if (iVar1 < 0) break;
      if (iVar1 == 0) {
        return;
      }
      buf[iVar1] = 0;
      iVar2 = strcmp(buf,"<!--Set1 -->");
      if (iVar2 == 0) goto LAB_100099b4;
      websWriteDataNonBlock(param_1,buf,iVar1);
      websWrite(param_1,&DAT_10022d7c);
    }
    break;
  case 1:
    while( true ) {
      iVar1 = ReadString(fd,buf,0x1000);
      nCount = iVar1;
      if (iVar1 < 0) break;
      if (iVar1 == 0) {
        return;
      }
      buf[iVar1] = 0;
      iVar2 = strcmp(buf,"<!--Set2 -->");
      if (iVar2 == 0) goto LAB_100099b4;
      websWriteDataNonBlock(param_1,buf,iVar1);
      websWrite(param_1,&DAT_10022d7c);
    }
    break;
  case 2:
    while( true ) {
      iVar1 = ReadString(fd,buf,0x1000);
      nCount = iVar1;
      if (iVar1 < 0) break;
      if (iVar1 == 0) {
        return;
      }
      buf[iVar1] = 0;
      iVar2 = strcmp(buf,"<!--Set3 -->");
      if (iVar2 == 0) goto LAB_100099b4;
      websWriteDataNonBlock(param_1,buf,iVar1);
      websWrite(param_1,&DAT_10022d7c);
    }
    break;
  case 3:
    while( true ) {
      iVar1 = ReadString(fd,buf,0x1000);
      nCount = iVar1;
      if (iVar1 < 0) break;
      if (iVar1 == 0) {
        return;
      }
      buf[iVar1] = 0;
      iVar2 = strcmp(buf,"<!--Set4 -->");
      if (iVar2 == 0) goto LAB_100099b4;
      websWriteDataNonBlock(param_1,buf,iVar1);
      websWrite(param_1,&DAT_10022d7c);
    }
    break;
  case 4:
    while( true ) {
      iVar1 = ReadString(fd,buf,0x1000);
      nCount = iVar1;
      if (iVar1 < 0) break;
      if (iVar1 == 0) {
        return;
      }
      buf[iVar1] = 0;
      iVar2 = strcmp(buf,"<!--Set5 -->");
      if (iVar2 == 0) goto LAB_100099b4;
      websWriteDataNonBlock(param_1,buf,iVar1);
      websWrite(param_1,&DAT_10022d7c);
    }
    break;
  case 5:
    while( true ) {
      iVar1 = ReadString(fd,buf,0x1000);
      nCount = iVar1;
      if (iVar1 < 0) break;
      if (iVar1 == 0) {
        return;
      }
      buf[iVar1] = 0;
      iVar2 = strcmp(buf,"<!--Set6 -->");
      if (iVar2 == 0) goto LAB_100099b4;
      websWriteDataNonBlock(param_1,buf,iVar1);
      websWrite(param_1,&DAT_10022d7c);
    }
    break;
  case 6:
    while( true ) {
      iVar1 = ReadString(fd,buf,0x1000);
      nCount = iVar1;
      if (iVar1 < 0) break;
      if (iVar1 == 0) {
        return;
      }
      buf[iVar1] = 0;
      iVar2 = strcmp(buf,"<!--Set7 -->");
      if (iVar2 == 0) goto LAB_100099b4;
      websWriteDataNonBlock(param_1,buf,iVar1);
      websWrite(param_1,&DAT_10022d7c);
    }
    break;
  case 7:
    while( true ) {
      iVar1 = ReadString(fd,buf,0x1000);
      nCount = iVar1;
      if (iVar1 < 0) break;
      if (iVar1 == 0) {
        return;
      }
      buf[iVar1] = 0;
      iVar2 = strcmp(buf,"<!--Set8 -->");
      if (iVar2 == 0) goto LAB_100099b4;
      websWriteDataNonBlock(param_1,buf,iVar1);
      websWrite(param_1,&DAT_10022d7c);
    }
    break;
  case 8:
    while( true ) {
      iVar1 = ReadString(fd,buf,0x1000);
      nCount = iVar1;
      if (iVar1 < 0) break;
      if (iVar1 == 0) {
        return;
      }
      buf[iVar1] = 0;
      iVar2 = strcmp(buf,"<!--Set9 -->");
      if (iVar2 == 0) goto LAB_100099b4;
      websWriteDataNonBlock(param_1,buf,iVar1);
      websWrite(param_1,&DAT_10022d7c);
    }
    break;
  case 9:
    while( true ) {
      iVar1 = ReadString(fd,buf,0x1000);
      nCount = iVar1;
      if (iVar1 < 0) break;
      if (iVar1 == 0) {
        return;
      }
      buf[iVar1] = 0;
      iVar2 = strcmp(buf,"<!--Set10 -->");
      if (iVar2 == 0) goto LAB_100099b4;
      websWriteDataNonBlock(param_1,buf,iVar1);
      websWrite(param_1,&DAT_10022d7c);
    }
    break;
  case 10:
    while( true ) {
      iVar1 = ReadString(fd,buf,0x1000);
      nCount = iVar1;
      if (iVar1 < 0) break;
      if (iVar1 == 0) {
        return;
      }
      buf[iVar1] = 0;
      iVar2 = strcmp(buf,"<!--Set11 -->");
      if (iVar2 == 0) goto LAB_100099b4;
      websWriteDataNonBlock(param_1,buf,iVar1);
      websWrite(param_1,&DAT_10022d7c);
    }
    break;
  case 0xb:
    while( true ) {
      iVar1 = ReadString(fd,buf,0x1000);
      nCount = iVar1;
      if (iVar1 < 0) break;
      if (iVar1 == 0) {
        return;
      }
      buf[iVar1] = 0;
      iVar2 = strcmp(buf,"<!--Set12 -->");
      if (iVar2 == 0) goto LAB_100099b4;
      websWriteDataNonBlock(param_1,buf,iVar1);
      websWrite(param_1,&DAT_10022d7c);
    }
    break;
  case 0xc:
    while( true ) {
      iVar1 = ReadString(fd,buf,0x1000);
      nCount = iVar1;
      if (iVar1 < 0) break;
      if (iVar1 == 0) {
        return;
      }
      buf[iVar1] = 0;
      iVar2 = strcmp(buf,"<!--Set13 -->");
      if (iVar2 == 0) goto LAB_100099b4;
      websWriteDataNonBlock(param_1,buf,iVar1);
      websWrite(param_1,&DAT_10022d7c);
    }
    break;
  case 0xd:
    while( true ) {
      iVar1 = ReadString(fd,buf,0x1000);
      nCount = iVar1;
      if (iVar1 < 0) break;
      if (iVar1 == 0) {
        return;
      }
      buf[iVar1] = 0;
      iVar2 = strcmp(buf,"<!--Set14 -->");
      if (iVar2 == 0) goto LAB_100099b4;
      websWriteDataNonBlock(param_1,buf,iVar1);
      websWrite(param_1,&DAT_10022d7c);
    }
    break;
  case 0xe:
    while( true ) {
      iVar1 = ReadString(fd,buf,0x1000);
      nCount = iVar1;
      if (iVar1 < 0) break;
      if (iVar1 == 0) {
        return;
      }
      buf[iVar1] = 0;
      iVar2 = strcmp(buf,"<!--Set15 -->");
      if (iVar2 == 0) goto LAB_100099b4;
      websWriteDataNonBlock(param_1,buf,iVar1);
      websWrite(param_1,&DAT_10022d7c);
    }
    break;
  case 0xf:
    while( true ) {
      iVar1 = ReadString(fd,buf,0x1000);
      nCount = iVar1;
      if (iVar1 < 0) break;
      if (iVar1 == 0) {
        return;
      }
      buf[iVar1] = 0;
      iVar2 = strcmp(buf,"<!--Set16 -->");
      if (iVar2 == 0) goto LAB_100099b4;
      websWriteDataNonBlock(param_1,buf,iVar1);
      websWrite(param_1,&DAT_10022d7c);
    }
    break;
  default:
    return;
  }
LAB_100092c8:
  if (0 < fd) {
    httpPlatformClose();
  }
  websError(param_1,0x194,"Cannot open URL:%s","/PortConf8s.htm");
  return;
LAB_100099b4:
  nCount = ReadString(fd,buf,0x1000);
  if (-1 < nCount) {
    if (nCount != 0) {
      websWriteDataNonBlock(param_1,buf,nCount + -3);
      websWrite(param_1,"background-color:");
      websWriteDataNonBlock(param_1,"#00FFFF",7);
      websWrite(param_1,&DAT_10020f9c);
      return;
    }
    return;
  }
  goto LAB_100092c8;
}
----------------------------------------

Function: Save_data

bool Save_data(undefined4 param_1,int param_2)

{
  bool bVar1;
  bool bVar2;
  char cVar3;
  char *pcVar4;
  int iVar5;
  uint uVar6;
  undefined *puVar7;
  undefined uVar8;
  undefined uVar9;
  char *__dest;
  bool bVar10;
  
  pcVar4 = (char *)websGetVar(param_1,"channelName",&DAT_10023fc4);
  param_2 = param_2 * 0x12a;
  if (*pcVar4 == '\0') {
    __dest = pcVar4;
    pcVar4 = " ";
  }
  else {
    __dest = P_Web_port + param_2 + 0x16f;
    memset(__dest,0,100);
  }
  strcpy(__dest,pcVar4);
  pcVar4 = (char *)websGetVar(param_1,"G_Bvalue",&DAT_10023fc4);
  iVar5 = atoi(pcVar4);
  if (0 < iVar5) {
    P_Web_port[param_2 + 0xd5] = (char)iVar5;
  }
  cVar3 = P_Web_port[param_2 + 0xd5];
  if (cVar3 == '\x01') {
    pcVar4 = (char *)websGetVar(param_1,"B_sendP",&DAT_10023fc4);
    iVar5 = atoi(pcVar4);
    bVar1 = iVar5 - 1U < 0xffff;
    if (bVar1) {
      P_Web_port[param_2 + 0xe2] = (char)iVar5;
      P_Web_port[param_2 + 0xdf] = (char)((uint)iVar5 >> 0x18);
      P_Web_port[param_2 + 0xe0] = (char)((uint)iVar5 >> 0x10);
      P_Web_port[param_2 + 0xe1] = (char)((uint)iVar5 >> 8);
    }
    pcVar4 = (char *)websGetVar(param_1,"B_revcP",&DAT_10023fc4);
    iVar5 = atoi(pcVar4);
    bVar2 = iVar5 - 1U < 0xffff;
    if (bVar2) {
      P_Web_port[param_2 + 0xe7] = (char)((uint)iVar5 >> 0x18);
      P_Web_port[param_2 + 0xe8] = (char)((uint)iVar5 >> 0x10);
      P_Web_port[param_2 + 0xe9] = (char)((uint)iVar5 >> 8);
      P_Web_port[param_2 + 0xea] = (char)iVar5;
    }
    pcVar4 = (char *)websGetVar(param_1,"B_sendP1",&DAT_10023fc4);
    iVar5 = atoi(pcVar4);
    bVar10 = iVar5 - 1U < 0xffff;
    if (bVar10) {
      P_Web_port[param_2 + 0xe3] = (char)((uint)iVar5 >> 0x18);
      P_Web_port[param_2 + 0xe4] = (char)((uint)iVar5 >> 0x10);
      P_Web_port[param_2 + 0xe5] = (char)((uint)iVar5 >> 8);
      P_Web_port[param_2 + 0xe6] = (char)iVar5;
    }
    bVar10 = bVar10 && (bVar2 && bVar1);
    pcVar4 = (char *)websGetVar(param_1,"B_revcP1",&DAT_10023fc4);
    iVar5 = atoi(pcVar4);
    if (iVar5 - 1U < 0xffff) {
      P_Web_port[param_2 + 0xeb] = (char)((uint)iVar5 >> 0x18);
      P_Web_port[param_2 + 0xec] = (char)((uint)iVar5 >> 0x10);
      P_Web_port[param_2 + 0xed] = (char)((uint)iVar5 >> 8);
      P_Web_port[param_2 + 0xee] = (char)iVar5;
    }
    else {
LAB_1000a13c:
      bVar10 = false;
    }
  }
  else if (cVar3 == '\x02') {
    pcVar4 = (char *)websGetVar(param_1,"ZADDRES",&DAT_10023fc4);
    memset(&str_ZADDR,0,0x44);
    StringSplit_Struct(&str_ZADDR,pcVar4,&DAT_10021168);
    if ((((((uint)DAT_100b1a07 |
           (uint)DAT_100b1a06 << 8 | (uint)DAT_100b1a05 << 0x10 | (uint)str_ZADDR << 0x18) != 3) ||
         (iVar5 = atoi(&DAT_100b1a08), 0xf < iVar5 - 0xe0U)) ||
        (uVar6 = atoi(&DAT_100b1a18), 0xfe < uVar6)) ||
       ((uVar6 = atoi(&DAT_100b1a28), 0xfe < uVar6 || (uVar6 = atoi(&DAT_100b1a38), 0xfe < uVar6))))
    {
      puVar7 = &DAT_10021cf0;
LAB_1000a37c:
      websWrite(param_1,puVar7);
      return false;
    }
    strcpy(P_Web_port + param_2 + 0x10f,pcVar4);
    pcVar4 = (char *)websGetVar(param_1,"ZADDRES2",&DAT_10023fc4);
    memset(&str_ZADDR,0,0x44);
    StringSplit_Struct(&str_ZADDR,pcVar4,&DAT_10021168);
    if (((((uint)DAT_100b1a07 |
          (uint)DAT_100b1a06 << 8 | (uint)DAT_100b1a05 << 0x10 | (uint)str_ZADDR << 0x18) != 3) ||
        (iVar5 = atoi(&DAT_100b1a08), 0xf < iVar5 - 0xe0U)) ||
       ((uVar6 = atoi(&DAT_100b1a18), 0xfe < uVar6 ||
        ((uVar6 = atoi(&DAT_100b1a28), 0xfe < uVar6 || (uVar6 = atoi(&DAT_100b1a38), 0xfe < uVar6)))
        ))) {
      puVar7 = &DAT_10021d3c;
      goto LAB_1000a37c;
    }
    strcpy(P_Web_port + param_2 + 0x11f,pcVar4);
    pcVar4 = (char *)websGetVar(param_1,"G_sendP",&DAT_10023fc4);
    iVar5 = atoi(pcVar4);
    bVar1 = iVar5 - 1U < 0xffff;
    if (bVar1) {
      P_Web_port[param_2 + 0xef] = (char)((uint)iVar5 >> 0x18);
      P_Web_port[param_2 + 0xf0] = (char)((uint)iVar5 >> 0x10);
      P_Web_port[param_2 + 0xf1] = (char)((uint)iVar5 >> 8);
      P_Web_port[param_2 + 0xf2] = (char)iVar5;
    }
    pcVar4 = (char *)websGetVar(param_1,"G_revcP",&DAT_10023fc4);
    iVar5 = atoi(pcVar4);
    bVar2 = iVar5 - 1U < 0xffff;
    if (bVar2) {
      P_Web_port[param_2 + 0xf7] = (char)((uint)iVar5 >> 0x18);
      P_Web_port[param_2 + 0xf8] = (char)((uint)iVar5 >> 0x10);
      P_Web_port[param_2 + 0xf9] = (char)((uint)iVar5 >> 8);
      P_Web_port[param_2 + 0xfa] = (char)iVar5;
    }
    pcVar4 = (char *)websGetVar(param_1,"G_sendP1",&DAT_10023fc4);
    iVar5 = atoi(pcVar4);
    bVar10 = iVar5 - 1U < 0xffff;
    if (bVar10) {
      P_Web_port[param_2 + 0xf3] = (char)((uint)iVar5 >> 0x18);
      P_Web_port[param_2 + 0xf4] = (char)((uint)iVar5 >> 0x10);
      P_Web_port[param_2 + 0xf5] = (char)((uint)iVar5 >> 8);
      P_Web_port[param_2 + 0xf6] = (char)iVar5;
    }
    bVar10 = bVar10 && (bVar2 && bVar1);
    pcVar4 = (char *)websGetVar(param_1,"G_revcP1",&DAT_10023fc4);
    iVar5 = atoi(pcVar4);
    if (0xfffe < iVar5 - 1U) goto LAB_1000a13c;
    P_Web_port[param_2 + 0xfb] = (char)((uint)iVar5 >> 0x18);
    P_Web_port[param_2 + 0xfc] = (char)((uint)iVar5 >> 0x10);
    P_Web_port[param_2 + 0xfd] = (char)((uint)iVar5 >> 8);
    P_Web_port[param_2 + 0xfe] = (char)iVar5;
  }
  else {
    bVar10 = true;
    if (cVar3 == '\x03') {
      pcVar4 = (char *)websGetVar(param_1,"DADDRES",&DAT_10023fc4);
      memset(&str_ZADDR,0,0x44);
      StringSplit_Struct(&str_ZADDR,pcVar4,&DAT_10021168);
      if ((((uint)DAT_100b1a07 |
           (uint)DAT_100b1a06 << 8 | (uint)DAT_100b1a05 << 0x10 | (uint)str_ZADDR << 0x18) != 3) ||
         (iVar5 = atoi(&DAT_100b1a08), 0xfd < iVar5 - 1U)) {
        puVar7 = &DAT_10021db4;
        goto LAB_1000a37c;
      }
      strcpy(P_Web_port + param_2 + 0x12f,pcVar4);
      pcVar4 = (char *)websGetVar(param_1,"DADDRES2",&DAT_10023fc4);
      memset(&str_ZADDR,0,0x44);
      StringSplit_Struct(&str_ZADDR,pcVar4,&DAT_10021168);
      if ((((uint)DAT_100b1a07 |
           (uint)DAT_100b1a06 << 8 | (uint)DAT_100b1a05 << 0x10 | (uint)str_ZADDR << 0x18) != 3) ||
         (iVar5 = atoi(&DAT_100b1a08), 0xfd < iVar5 - 1U)) {
        puVar7 = &DAT_10021e00;
        goto LAB_1000a37c;
      }
      strcpy(P_Web_port + param_2 + 0x13f,pcVar4);
      pcVar4 = (char *)websGetVar(param_1,"D_sendP",&DAT_10023fc4);
      iVar5 = atoi(pcVar4);
      bVar1 = iVar5 - 1U < 0xffff;
      if (bVar1) {
        P_Web_port[param_2 + 0x102] = (char)iVar5;
        P_Web_port[param_2 + 0xff] = (char)((uint)iVar5 >> 0x18);
        P_Web_port[param_2 + 0x100] = (char)((uint)iVar5 >> 0x10);
        P_Web_port[param_2 + 0x101] = (char)((uint)iVar5 >> 8);
      }
      pcVar4 = (char *)websGetVar(param_1,"D_revcP",&DAT_10023fc4);
      iVar5 = atoi(pcVar4);
      bVar2 = iVar5 - 1U < 0xffff;
      if (bVar2) {
        P_Web_port[param_2 + 0x107] = (char)((uint)iVar5 >> 0x18);
        P_Web_port[param_2 + 0x108] = (char)((uint)iVar5 >> 0x10);
        P_Web_port[param_2 + 0x109] = (char)((uint)iVar5 >> 8);
        P_Web_port[param_2 + 0x10a] = (char)iVar5;
      }
      pcVar4 = (char *)websGetVar(param_1,"D_sendP1",&DAT_10023fc4);
      iVar5 = atoi(pcVar4);
      bVar10 = iVar5 - 1U < 0xffff;
      if (bVar10) {
        P_Web_port[param_2 + 0x103] = (char)((uint)iVar5 >> 0x18);
        P_Web_port[param_2 + 0x104] = (char)((uint)iVar5 >> 0x10);
        P_Web_port[param_2 + 0x105] = (char)((uint)iVar5 >> 8);
        P_Web_port[param_2 + 0x106] = (char)iVar5;
      }
      bVar10 = bVar10 && (bVar2 && bVar1);
      pcVar4 = (char *)websGetVar(param_1,"D_revcP1",&DAT_10023fc4);
      iVar5 = atoi(pcVar4);
      if (0xfffe < iVar5 - 1U) goto LAB_1000a13c;
      P_Web_port[param_2 + 0x10b] = (char)((uint)iVar5 >> 0x18);
      P_Web_port[param_2 + 0x10c] = (char)((uint)iVar5 >> 0x10);
      P_Web_port[param_2 + 0x10d] = (char)((uint)iVar5 >> 8);
      P_Web_port[param_2 + 0x10e] = (char)iVar5;
    }
  }
  pcVar4 = (char *)websGetVar(param_1,"TongBu",&DAT_10023fc4);
  uVar6 = atoi(pcVar4);
  P_Web_port[param_2 + 0xd6] = (char)uVar6;
  if ((uVar6 & 0xff) == 1) {
    pcVar4 = (char *)websGetVar(param_1,"Xieyi",&DAT_10023fc4);
    iVar5 = atoi(pcVar4);
    P_Web_port[param_2 + 0xd7] = (char)iVar5;
    pcVar4 = (char *)websGetVar(param_1,"I_Ovalue",&DAT_10023fc4);
    iVar5 = atoi(pcVar4);
    P_Web_port[param_2 + 0xd4] = (char)iVar5;
  }
  else if ((uVar6 & 0xff) == 2) {
    pcVar4 = (char *)websGetVar(param_1,"Shujuw",&DAT_10023fc4);
    iVar5 = atoi(pcVar4);
    P_Web_port[param_2 + 0xdc] = (char)iVar5;
    pcVar4 = (char *)websGetVar(param_1,"Tingz",&DAT_10023fc4);
    iVar5 = atoi(pcVar4);
    P_Web_port[param_2 + 0xdd] = (char)iVar5;
    pcVar4 = (char *)websGetVar(param_1,"Jiaoy",&DAT_10023fc4);
    iVar5 = atoi(pcVar4);
    P_Web_port[param_2 + 0xde] = (char)iVar5;
  }
  pcVar4 = (char *)websGetVar(param_1,"Shulv",&DAT_10023fc4);
  iVar5 = atoi(pcVar4);
  if (0xb < iVar5 - 1U) goto LAB_1000a8c4;
  uVar9 = 0;
  P_Web_port[param_2 + 0xd8] = 0;
  switch(iVar5) {
  case 1:
    P_Web_port[param_2 + 0xd9] = 0;
    P_Web_port[param_2 + 0xda] = 9;
    uVar9 = 0x60;
    goto LAB_1000a8c0;
  case 2:
    P_Web_port[param_2 + 0xd9] = 0;
    uVar9 = 0x12;
    goto LAB_1000a858;
  case 3:
    P_Web_port[param_2 + 0xd9] = 0;
    P_Web_port[param_2 + 0xda] = 0x25;
    uVar9 = 0x80;
    goto LAB_1000a8c0;
  case 4:
    P_Web_port[param_2 + 0xd9] = 0;
    uVar8 = 0x4b;
    break;
  case 5:
    P_Web_port[param_2 + 0xd9] = 0;
    P_Web_port[param_2 + 0xda] = 0x83;
    uVar9 = 0x40;
    goto LAB_1000a8c0;
  case 6:
    P_Web_port[param_2 + 0xd9] = 0;
    uVar9 = 0xda;
LAB_1000a858:
    P_Web_port[param_2 + 0xda] = uVar9;
    uVar9 = 0xc0;
    goto LAB_1000a8c0;
  case 7:
    P_Web_port[param_2 + 0xd9] = 0;
    uVar8 = 0xfa;
    break;
  case 8:
    P_Web_port[param_2 + 0xd9] = 1;
    uVar8 = 0xf4;
    break;
  case 9:
    P_Web_port[param_2 + 0xd9] = 3;
    uVar8 = 0xe8;
    break;
  case 10:
    P_Web_port[param_2 + 0xd9] = 7;
    uVar8 = 0xd0;
    break;
  case 0xb:
    P_Web_port[param_2 + 0xd9] = 0xf;
    uVar8 = 0xa0;
    break;
  case 0xc:
    P_Web_port[param_2 + 0xd9] = 0x1f;
    uVar8 = 0x40;
  }
  P_Web_port[param_2 + 0xda] = uVar8;
LAB_1000a8c0:
  P_Web_port[param_2 + 0xdb] = uVar9;
LAB_1000a8c4:
  pcVar4 = (char *)websGetVar(param_1,"SHUJUYUAN",&DAT_10023fc4);
  iVar5 = atoi(pcVar4);
  P_Web_port[param_2 + 0x1fa] = (char)iVar5;
  P_Web_port[param_2 + 0x1f7] = (char)((uint)iVar5 >> 0x18);
  P_Web_port[param_2 + 0x1f8] = (char)((uint)iVar5 >> 0x10);
  P_Web_port[param_2 + 0x1f9] = (char)((uint)iVar5 >> 8);
  P_Web_port[param_2 + 0xd1] = 1;
  return bVar10;
}
----------------------------------------

Function: PortConf

void PortConf(undefined4 param_1)

{
  char cVar1;
  byte bVar2;
  int iVar3;
  int iVar4;
  uint uVar5;
  
  fd = httpPlatformOpen("/PortConf8s.htm",0);
  if ((-1 < fd) && (iVar3 = InitReadString(), -1 < iVar3)) {
    LOAD_Data(0);
    SButtonHandle(param_1,0);
    while( true ) {
      iVar3 = ReadString(fd,buf,0x1000);
      nCount = iVar3;
      if (iVar3 < 0) break;
      if (iVar3 == 0) {
        nCount = 0;
        goto LAB_1000b040;
      }
      buf[iVar3] = 0;
      iVar4 = strcmp(buf,"<!--ChannelNum -->");
      if (iVar4 == 0) {
                    /* WARNING: Subroutine does not return */
        strlen(*(char **)(flavors + Nchoice * 4));
      }
      websWriteDataNonBlock(param_1,buf,iVar3);
      websWrite(param_1,&DAT_10022d7c);
    }
  }
  goto LAB_1000da10;
LAB_1000b040:
  iVar3 = ReadString(fd,buf,0x1000);
  nCount = iVar3;
  if (iVar3 < 0) goto LAB_1000da10;
  if (iVar3 == 0) {
LAB_1000b0f4:
    Chang_Bg_color(param_1,Nchoice);
    cVar1 = P_Web_port[Nchoice * 0x12a + 0xd5];
    if (cVar1 == '\x01') goto LAB_1000b13c;
    if (cVar1 == '\x02') goto LAB_1000b1bc;
    if (cVar1 != '\x03') goto LAB_1000b33c;
    goto LAB_1000b23c;
  }
  buf[iVar3] = 0;
  iVar4 = strcmp(buf,"<!--channelName -->");
  if (iVar4 == 0) {
    nCount = ReadString(fd,buf,0x1000);
    if (-1 < nCount) {
      if (nCount != 0) {
        websWriteDataNonBlock(param_1,buf,nCount + -2);
        websWrite(param_1," value=\"");
                    /* WARNING: Subroutine does not return */
        strlen(P_Web_port + Nchoice * 0x12a + 0x16f);
      }
      goto LAB_1000b0f4;
    }
    goto LAB_1000da10;
  }
  websWriteDataNonBlock(param_1,buf,iVar3);
  websWrite(param_1,&DAT_10022d7c);
  goto LAB_1000b040;
LAB_1000b13c:
  iVar3 = ReadString(fd,buf,0x1000);
  nCount = iVar3;
  if (iVar3 < 0) goto LAB_1000da10;
  if (iVar3 == 0) goto LAB_1000b33c;
  buf[iVar3] = 0;
  iVar4 = strcmp(buf,"<!--Readio1 -->");
  if (iVar4 == 0) goto LAB_1000b278;
  websWriteDataNonBlock(param_1,buf,iVar3);
  websWrite(param_1,&DAT_10022d7c);
  goto LAB_1000b13c;
LAB_1000b1bc:
  iVar3 = ReadString(fd,buf,0x1000);
  nCount = iVar3;
  if (iVar3 < 0) goto LAB_1000da10;
  if (iVar3 == 0) goto LAB_1000b33c;
  buf[iVar3] = 0;
  iVar4 = strcmp(buf,"<!--Readio2 -->");
  if (iVar4 == 0) goto LAB_1000b278;
  websWriteDataNonBlock(param_1,buf,iVar3);
  websWrite(param_1,&DAT_10022d7c);
  goto LAB_1000b1bc;
LAB_1000b23c:
  iVar3 = ReadString(fd,buf,0x1000);
  nCount = iVar3;
  if (iVar3 < 0) goto LAB_1000da10;
  if (iVar3 == 0) goto LAB_1000b33c;
  buf[iVar3] = 0;
  iVar4 = strcmp(buf,"<!--Readio3 -->");
  if (iVar4 == 0) goto LAB_1000b278;
  websWriteDataNonBlock(param_1,buf,iVar3);
  websWrite(param_1,&DAT_10022d7c);
  goto LAB_1000b23c;
LAB_1000b278:
  nCount = ReadString(fd,buf,0x1000);
  if (-1 < nCount) {
    if (nCount != 0) {
      websWriteDataNonBlock(param_1,buf,nCount + -2);
      websWrite(param_1," checked=\"checked\" />\n");
    }
LAB_1000b33c:
    do {
      iVar3 = ReadString(fd,buf,0x1000);
      nCount = iVar3;
      if (iVar3 < 0) break;
      if (iVar3 == 0) goto LAB_1000b43c;
      buf[iVar3] = 0;
      iVar4 = strcmp(buf,"<!--BADDRES -->");
      if (iVar4 == 0) {
        nCount = ReadString(fd,buf,0x1000);
        if (-1 < nCount) {
          if (nCount != 0) {
            websWriteDataNonBlock(param_1,buf,nCount + -2);
            websWrite(param_1," value=\"");
                    /* WARNING: Subroutine does not return */
            strlen(P_Web_port + Nchoice * 0x12a + 0x14f);
          }
          goto LAB_1000b43c;
        }
        break;
      }
      websWriteDataNonBlock(param_1,buf,iVar3);
      websWrite(param_1,&DAT_10022d7c);
    } while( true );
  }
  goto LAB_1000da10;
LAB_1000b43c:
  iVar3 = ReadString(fd,buf,0x1000);
  nCount = iVar3;
  if (iVar3 < 0) goto LAB_1000da10;
  if (iVar3 == 0) goto LAB_1000b53c;
  buf[iVar3] = 0;
  iVar4 = strcmp(buf,"<!--ZADDRES -->");
  if (iVar4 == 0) {
    nCount = ReadString(fd,buf,0x1000);
    if (-1 < nCount) {
      if (nCount != 0) {
        websWriteDataNonBlock(param_1,buf,nCount + -2);
        websWrite(param_1," value=\"");
                    /* WARNING: Subroutine does not return */
        strlen(P_Web_port + Nchoice * 0x12a + 0x10f);
      }
      goto LAB_1000b53c;
    }
    goto LAB_1000da10;
  }
  websWriteDataNonBlock(param_1,buf,iVar3);
  websWrite(param_1,&DAT_10022d7c);
  goto LAB_1000b43c;
LAB_1000b53c:
  iVar3 = ReadString(fd,buf,0x1000);
  nCount = iVar3;
  if (iVar3 < 0) goto LAB_1000da10;
  if (iVar3 == 0) goto LAB_1000b63c;
  buf[iVar3] = 0;
  iVar4 = strcmp(buf,"<!--DADDRES -->");
  if (iVar4 == 0) {
    nCount = ReadString(fd,buf,0x1000);
    if (-1 < nCount) {
      if (nCount != 0) {
        websWriteDataNonBlock(param_1,buf,nCount + -2);
        websWrite(param_1," value=\"");
                    /* WARNING: Subroutine does not return */
        strlen(P_Web_port + Nchoice * 0x12a + 0x12f);
      }
      goto LAB_1000b63c;
    }
    goto LAB_1000da10;
  }
  websWriteDataNonBlock(param_1,buf,iVar3);
  websWrite(param_1,&DAT_10022d7c);
  goto LAB_1000b53c;
LAB_1000b63c:
  iVar3 = ReadString(fd,buf,0x1000);
  nCount = iVar3;
  if (iVar3 < 0) goto LAB_1000da10;
  if (iVar3 == 0) goto LAB_1000b734;
  buf[iVar3] = 0;
  iVar4 = strcmp(buf,"<!--B_sendP -->");
  if (iVar4 == 0) {
    nCount = ReadString(fd,buf,0x1000);
    if (-1 < nCount) {
      if (nCount != 0) {
        websWriteDataNonBlock(param_1,buf,nCount + -2);
        iVar3 = Nchoice * 0x12a;
        websWrite(param_1," value=\"%d\"/>\n",
                  (uint)(byte)P_Web_port[iVar3 + 0xe2] |
                  (uint)(byte)P_Web_port[iVar3 + 0xe1] << 8 |
                  (uint)(byte)P_Web_port[iVar3 + 0xe0] << 0x10 |
                  (uint)(byte)P_Web_port[iVar3 + 0xdf] << 0x18);
      }
      goto LAB_1000b734;
    }
    goto LAB_1000da10;
  }
  websWriteDataNonBlock(param_1,buf,iVar3);
  websWrite(param_1,&DAT_10022d7c);
  goto LAB_1000b63c;
LAB_1000b734:
  iVar3 = ReadString(fd,buf,0x1000);
  nCount = iVar3;
  if (iVar3 < 0) goto LAB_1000da10;
  if (iVar3 == 0) goto LAB_1000b82c;
  buf[iVar3] = 0;
  iVar4 = strcmp(buf,"<!--G_sendP -->");
  if (iVar4 == 0) {
    nCount = ReadString(fd,buf,0x1000);
    if (-1 < nCount) {
      if (nCount != 0) {
        websWriteDataNonBlock(param_1,buf,nCount + -2);
        iVar3 = Nchoice * 0x12a;
        websWrite(param_1," value=\"%d\"/>\n",
                  (uint)(byte)P_Web_port[iVar3 + 0xf2] |
                  (uint)(byte)P_Web_port[iVar3 + 0xf1] << 8 |
                  (uint)(byte)P_Web_port[iVar3 + 0xf0] << 0x10 |
                  (uint)(byte)P_Web_port[iVar3 + 0xef] << 0x18);
      }
      goto LAB_1000b82c;
    }
    goto LAB_1000da10;
  }
  websWriteDataNonBlock(param_1,buf,iVar3);
  websWrite(param_1,&DAT_10022d7c);
  goto LAB_1000b734;
LAB_1000b82c:
  iVar3 = ReadString(fd,buf,0x1000);
  nCount = iVar3;
  if (iVar3 < 0) goto LAB_1000da10;
  if (iVar3 == 0) goto LAB_1000b924;
  buf[iVar3] = 0;
  iVar4 = strcmp(buf,"<!--D_sendP -->");
  if (iVar4 == 0) {
    nCount = ReadString(fd,buf,0x1000);
    if (-1 < nCount) {
      if (nCount != 0) {
        websWriteDataNonBlock(param_1,buf,nCount + -2);
        iVar3 = Nchoice * 0x12a;
        websWrite(param_1," value=\"%d\"/>\n",
                  (uint)(byte)P_Web_port[iVar3 + 0x102] |
                  (uint)(byte)P_Web_port[iVar3 + 0x101] << 8 |
                  (uint)(byte)P_Web_port[iVar3 + 0x100] << 0x10 |
                  (uint)(byte)P_Web_port[iVar3 + 0xff] << 0x18);
      }
      goto LAB_1000b924;
    }
    goto LAB_1000da10;
  }
  websWriteDataNonBlock(param_1,buf,iVar3);
  websWrite(param_1,&DAT_10022d7c);
  goto LAB_1000b82c;
LAB_1000b924:
  iVar3 = ReadString(fd,buf,0x1000);
  nCount = iVar3;
  if (iVar3 < 0) goto LAB_1000da10;
  if (iVar3 == 0) goto LAB_1000ba18;
  buf[iVar3] = 0;
  iVar4 = strcmp(buf,"<!--B_revcP -->");
  if (iVar4 == 0) {
    nCount = ReadString(fd,buf,0x1000);
    if (-1 < nCount) {
      if (nCount != 0) {
        websWriteDataNonBlock(param_1,buf,nCount + -2);
        iVar3 = Nchoice * 0x12a;
        websWrite(param_1," value=\"%d\"/>\n",
                  (uint)(byte)P_Web_port[iVar3 + 0xea] |
                  (uint)(byte)P_Web_port[iVar3 + 0xe9] << 8 |
                  (uint)(byte)P_Web_port[iVar3 + 0xe8] << 0x10 |
                  (uint)(byte)P_Web_port[iVar3 + 0xe7] << 0x18);
      }
      goto LAB_1000ba18;
    }
    goto LAB_1000da10;
  }
  websWriteDataNonBlock(param_1,buf,iVar3);
  websWrite(param_1,&DAT_10022d7c);
  goto LAB_1000b924;
LAB_1000ba18:
  iVar3 = ReadString(fd,buf,0x1000);
  nCount = iVar3;
  if (iVar3 < 0) goto LAB_1000da10;
  if (iVar3 == 0) goto LAB_1000bb24;
  buf[iVar3] = 0;
  iVar4 = strcmp(buf,"<!--G_revcP -->");
  if (iVar4 == 0) {
    nCount = ReadString(fd,buf,0x1000);
    if (-1 < nCount) {
      if (nCount != 0) {
        websWriteDataNonBlock(param_1,buf,nCount + -2);
        iVar3 = Nchoice * 0x12a;
        websWrite(param_1," value=\"%d\"/>\n",
                  (uint)(byte)P_Web_port[iVar3 + 0xfa] |
                  (uint)(byte)P_Web_port[iVar3 + 0xf9] << 8 |
                  (uint)(byte)P_Web_port[iVar3 + 0xf8] << 0x10 |
                  (uint)(byte)P_Web_port[iVar3 + 0xf7] << 0x18);
      }
      goto LAB_1000bb24;
    }
    goto LAB_1000da10;
  }
  websWriteDataNonBlock(param_1,buf,iVar3);
  websWrite(param_1,&DAT_10022d7c);
  goto LAB_1000ba18;
LAB_1000bb24:
  iVar3 = ReadString(fd,buf,0x1000);
  nCount = iVar3;
  if (iVar3 < 0) goto LAB_1000da10;
  if (iVar3 == 0) goto LAB_1000bc34;
  buf[iVar3] = 0;
  iVar4 = strcmp(buf,"<!--D_revcP -->");
  if (iVar4 == 0) {
    nCount = ReadString(fd,buf,0x1000);
    if (-1 < nCount) {
      if (nCount != 0) {
        websWriteDataNonBlock(param_1,buf,nCount + -2);
        iVar3 = Nchoice * 0x12a;
        websWrite(param_1," value=\"%d\"/>\n",
                  (uint)(byte)P_Web_port[iVar3 + 0x10a] |
                  (uint)(byte)P_Web_port[iVar3 + 0x109] << 8 |
                  (uint)(byte)P_Web_port[iVar3 + 0x108] << 0x10 |
                  (uint)(byte)P_Web_port[iVar3 + 0x107] << 0x18);
      }
      goto LAB_1000bc34;
    }
    goto LAB_1000da10;
  }
  websWriteDataNonBlock(param_1,buf,iVar3);
  websWrite(param_1,&DAT_10022d7c);
  goto LAB_1000bb24;
LAB_1000bc34:
  iVar3 = ReadString(fd,buf,0x1000);
  nCount = iVar3;
  if (iVar3 < 0) goto LAB_1000da10;
  if (iVar3 == 0) goto LAB_1000bd40;
  buf[iVar3] = 0;
  iVar4 = strcmp(buf,"<!--BADDRES2 -->");
  if (iVar4 == 0) {
    nCount = ReadString(fd,buf,0x1000);
    if (-1 < nCount) {
      if (nCount != 0) {
        websWriteDataNonBlock(param_1,buf,nCount + -2);
        websWrite(param_1," value=\"");
                    /* WARNING: Subroutine does not return */
        strlen(P_Web_port + Nchoice * 0x12a + 0x15f);
      }
      goto LAB_1000bd40;
    }
    goto LAB_1000da10;
  }
  websWriteDataNonBlock(param_1,buf,iVar3);
  websWrite(param_1,&DAT_10022d7c);
  goto LAB_1000bc34;
LAB_1000bd40:
  iVar3 = ReadString(fd,buf,0x1000);
  nCount = iVar3;
  if (iVar3 < 0) goto LAB_1000da10;
  if (iVar3 == 0) goto LAB_1000be4c;
  buf[iVar3] = 0;
  iVar4 = strcmp(buf,"<!--ZADDRES2 -->");
  if (iVar4 == 0) {
    nCount = ReadString(fd,buf,0x1000);
    if (-1 < nCount) {
      if (nCount != 0) {
        websWriteDataNonBlock(param_1,buf,nCount + -2);
        websWrite(param_1," value=\"");
                    /* WARNING: Subroutine does not return */
        strlen(P_Web_port + Nchoice * 0x12a + 0x11f);
      }
      goto LAB_1000be4c;
    }
    goto LAB_1000da10;
  }
  websWriteDataNonBlock(param_1,buf,iVar3);
  websWrite(param_1,&DAT_10022d7c);
  goto LAB_1000bd40;
LAB_1000be4c:
  iVar3 = ReadString(fd,buf,0x1000);
  nCount = iVar3;
  if (iVar3 < 0) goto LAB_1000da10;
  if (iVar3 == 0) goto LAB_1000bf58;
  buf[iVar3] = 0;
  iVar4 = strcmp(buf,"<!--DADDRES2 -->");
  if (iVar4 == 0) {
    nCount = ReadString(fd,buf,0x1000);
    if (-1 < nCount) {
      if (nCount != 0) {
        websWriteDataNonBlock(param_1,buf,nCount + -2);
        websWrite(param_1," value=\"");
                    /* WARNING: Subroutine does not return */
        strlen(P_Web_port + Nchoice * 0x12a + 0x13f);
      }
      goto LAB_1000bf58;
    }
    goto LAB_1000da10;
  }
  websWriteDataNonBlock(param_1,buf,iVar3);
  websWrite(param_1,&DAT_10022d7c);
  goto LAB_1000be4c;
LAB_1000bf58:
  iVar3 = ReadString(fd,buf,0x1000);
  nCount = iVar3;
  if (iVar3 < 0) goto LAB_1000da10;
  if (iVar3 == 0) goto LAB_1000c05c;
  buf[iVar3] = 0;
  iVar4 = strcmp(buf,"<!--B_sendP1 -->");
  if (iVar4 == 0) {
    nCount = ReadString(fd,buf,0x1000);
    if (-1 < nCount) {
      if (nCount != 0) {
        websWriteDataNonBlock(param_1,buf,nCount + -2);
        iVar3 = Nchoice * 0x12a;
        websWrite(param_1," value=\"%d\"/>\n",
                  (uint)(byte)P_Web_port[iVar3 + 0xe6] |
                  (uint)(byte)P_Web_port[iVar3 + 0xe5] << 8 |
                  (uint)(byte)P_Web_port[iVar3 + 0xe4] << 0x10 |
                  (uint)(byte)P_Web_port[iVar3 + 0xe3] << 0x18);
      }
      goto LAB_1000c05c;
    }
    goto LAB_1000da10;
  }
  websWriteDataNonBlock(param_1,buf,iVar3);
  websWrite(param_1,&DAT_10022d7c);
  goto LAB_1000bf58;
LAB_1000c05c:
  iVar3 = ReadString(fd,buf,0x1000);
  nCount = iVar3;
  if (iVar3 < 0) goto LAB_1000da10;
  if (iVar3 == 0) goto LAB_1000c160;
  buf[iVar3] = 0;
  iVar4 = strcmp(buf,"<!--G_sendP1 -->");
  if (iVar4 == 0) {
    nCount = ReadString(fd,buf,0x1000);
    if (-1 < nCount) {
      if (nCount != 0) {
        websWriteDataNonBlock(param_1,buf,nCount + -2);
        iVar3 = Nchoice * 0x12a;
        websWrite(param_1," value=\"%d\"/>\n",
                  (uint)(byte)P_Web_port[iVar3 + 0xf6] |
                  (uint)(byte)P_Web_port[iVar3 + 0xf5] << 8 |
                  (uint)(byte)P_Web_port[iVar3 + 0xf4] << 0x10 |
                  (uint)(byte)P_Web_port[iVar3 + 0xf3] << 0x18);
      }
      goto LAB_1000c160;
    }
    goto LAB_1000da10;
  }
  websWriteDataNonBlock(param_1,buf,iVar3);
  websWrite(param_1,&DAT_10022d7c);
  goto LAB_1000c05c;
LAB_1000c160:
  iVar3 = ReadString(fd,buf,0x1000);
  nCount = iVar3;
  if (iVar3 < 0) goto LAB_1000da10;
  if (iVar3 == 0) goto LAB_1000c264;
  buf[iVar3] = 0;
  iVar4 = strcmp(buf,"<!--D_sendP1 -->");
  if (iVar4 == 0) {
    nCount = ReadString(fd,buf,0x1000);
    if (-1 < nCount) {
      if (nCount != 0) {
        websWriteDataNonBlock(param_1,buf,nCount + -2);
        iVar3 = Nchoice * 0x12a;
        websWrite(param_1," value=\"%d\"/>\n",
                  (uint)(byte)P_Web_port[iVar3 + 0x106] |
                  (uint)(byte)P_Web_port[iVar3 + 0x105] << 8 |
                  (uint)(byte)P_Web_port[iVar3 + 0x104] << 0x10 |
                  (uint)(byte)P_Web_port[iVar3 + 0x103] << 0x18);
      }
      goto LAB_1000c264;
    }
    goto LAB_1000da10;
  }
  websWriteDataNonBlock(param_1,buf,iVar3);
  websWrite(param_1,&DAT_10022d7c);
  goto LAB_1000c160;
LAB_1000c264:
  iVar3 = ReadString(fd,buf,0x1000);
  nCount = iVar3;
  if (iVar3 < 0) goto LAB_1000da10;
  if (iVar3 == 0) goto LAB_1000c368;
  buf[iVar3] = 0;
  iVar4 = strcmp(buf,"<!--B_revcP1 -->");
  if (iVar4 == 0) {
    nCount = ReadString(fd,buf,0x1000);
    if (-1 < nCount) {
      if (nCount != 0) {
        websWriteDataNonBlock(param_1,buf,nCount + -2);
        iVar3 = Nchoice * 0x12a;
        websWrite(param_1," value=\"%d\"/>\n",
                  (uint)(byte)P_Web_port[iVar3 + 0xee] |
                  (uint)(byte)P_Web_port[iVar3 + 0xed] << 8 |
                  (uint)(byte)P_Web_port[iVar3 + 0xec] << 0x10 |
                  (uint)(byte)P_Web_port[iVar3 + 0xeb] << 0x18);
      }
      goto LAB_1000c368;
    }
    goto LAB_1000da10;
  }
  websWriteDataNonBlock(param_1,buf,iVar3);
  websWrite(param_1,&DAT_10022d7c);
  goto LAB_1000c264;
LAB_1000c368:
  iVar3 = ReadString(fd,buf,0x1000);
  nCount = iVar3;
  if (iVar3 < 0) goto LAB_1000da10;
  if (iVar3 == 0) goto LAB_1000c468;
  buf[iVar3] = 0;
  iVar4 = strcmp(buf,"<!--G_revcP1 -->");
  if (iVar4 == 0) {
    nCount = ReadString(fd,buf,0x1000);
    if (-1 < nCount) {
      if (nCount != 0) {
        websWriteDataNonBlock(param_1,buf,nCount + -2);
        iVar3 = Nchoice * 0x12a;
        websWrite(param_1," value=\"%d\"/>\n",
                  (uint)(byte)P_Web_port[iVar3 + 0xfe] |
                  (uint)(byte)P_Web_port[iVar3 + 0xfd] << 8 |
                  (uint)(byte)P_Web_port[iVar3 + 0xfc] << 0x10 |
                  (uint)(byte)P_Web_port[iVar3 + 0xfb] << 0x18);
      }
      goto LAB_1000c468;
    }
    goto LAB_1000da10;
  }
  websWriteDataNonBlock(param_1,buf,iVar3);
  websWrite(param_1,&DAT_10022d7c);
  goto LAB_1000c368;
LAB_1000c468:
  iVar3 = ReadString(fd,buf,0x1000);
  nCount = iVar3;
  if (iVar3 < 0) goto LAB_1000da10;
  if (iVar3 == 0) {
LAB_1000c514:
    if (P_Web_port[Nchoice * 0x12a + 0xd6] == '\x01') goto LAB_1000c568;
    goto LAB_1000c5d8;
  }
  buf[iVar3] = 0;
  iVar4 = strcmp(buf,"<!--D_revcP1 -->");
  if (iVar4 == 0) {
    nCount = ReadString(fd,buf,0x1000);
    if (-1 < nCount) {
      if (nCount != 0) {
        websWriteDataNonBlock(param_1,buf,nCount + -2);
        iVar3 = Nchoice * 0x12a;
        websWrite(param_1," value=\"%d\"/>\n",
                  (uint)(byte)P_Web_port[iVar3 + 0x10e] |
                  (uint)(byte)P_Web_port[iVar3 + 0x10d] << 8 |
                  (uint)(byte)P_Web_port[iVar3 + 0x10c] << 0x10 |
                  (uint)(byte)P_Web_port[iVar3 + 0x10b] << 0x18);
      }
      goto LAB_1000c514;
    }
    goto LAB_1000da10;
  }
  websWriteDataNonBlock(param_1,buf,iVar3);
  websWrite(param_1,&DAT_10022d7c);
  goto LAB_1000c468;
LAB_1000c5d8:
  iVar3 = ReadString(fd,buf,0x1000);
  nCount = iVar3;
  if (iVar3 < 0) goto LAB_1000da10;
  if (iVar3 == 0) goto LAB_1000c684;
  buf[iVar3] = 0;
  iVar4 = strcmp(buf,"<!--TongBu2 -->");
  if (iVar4 == 0) goto LAB_1000c614;
  websWriteDataNonBlock(param_1,buf,iVar3);
  websWrite(param_1,&DAT_10022d7c);
  goto LAB_1000c5d8;
LAB_1000c568:
  iVar3 = ReadString(fd,buf,0x1000);
  nCount = iVar3;
  if (iVar3 < 0) goto LAB_1000da10;
  if (iVar3 == 0) goto LAB_1000c684;
  buf[iVar3] = 0;
  iVar4 = strcmp(buf,"<!--TongBu1 -->");
  if (iVar4 == 0) goto LAB_1000c614;
  websWriteDataNonBlock(param_1,buf,iVar3);
  websWrite(param_1,&DAT_10022d7c);
  goto LAB_1000c568;
LAB_1000c614:
  nCount = ReadString(fd,buf,0x1000);
  if (nCount < 0) goto LAB_1000da10;
  if (nCount != 0) {
    websWriteDataNonBlock(param_1,buf,nCount + -2);
    websWrite(param_1," selected=\"selected\" >\n");
  }
LAB_1000c684:
  bVar2 = P_Web_port[Nchoice * 0x12a + 0xdc];
  if (bVar2 == 2) {
    while( true ) {
      iVar3 = ReadString(fd,buf,0x1000);
      nCount = iVar3;
      if (iVar3 < 0) break;
      if (iVar3 == 0) goto LAB_1000c8ec;
      buf[iVar3] = 0;
      iVar4 = strcmp(buf,"<!--Shujuw2 -->");
      if (iVar4 == 0) goto LAB_1000c8a4;
      websWriteDataNonBlock(param_1,buf,iVar3);
      websWrite(param_1,&DAT_10022d7c);
    }
    goto LAB_1000da10;
  }
  if (bVar2 < 3) {
    if (bVar2 == 1) {
      while( true ) {
        iVar3 = ReadString(fd,buf,0x1000);
        nCount = iVar3;
        if (iVar3 < 0) break;
        if (iVar3 == 0) goto LAB_1000c8ec;
        buf[iVar3] = 0;
        iVar4 = strcmp(buf,"<!--Shujuw1 -->");
        if (iVar4 == 0) goto LAB_1000c8a4;
        websWriteDataNonBlock(param_1,buf,iVar3);
        websWrite(param_1,&DAT_10022d7c);
      }
      goto LAB_1000da10;
    }
  }
  else {
    if (bVar2 == 3) {
      while( true ) {
        iVar3 = ReadString(fd,buf,0x1000);
        nCount = iVar3;
        if (iVar3 < 0) break;
        if (iVar3 == 0) goto LAB_1000c8ec;
        buf[iVar3] = 0;
        iVar4 = strcmp(buf,"<!--Shujuw3 -->");
        if (iVar4 == 0) goto LAB_1000c8a4;
        websWriteDataNonBlock(param_1,buf,iVar3);
        websWrite(param_1,&DAT_10022d7c);
      }
      goto LAB_1000da10;
    }
    if (bVar2 == 4) {
      while( true ) {
        iVar3 = ReadString(fd,buf,0x1000);
        nCount = iVar3;
        if (iVar3 < 0) break;
        if (iVar3 == 0) goto LAB_1000c8ec;
        buf[iVar3] = 0;
        iVar4 = strcmp(buf,"<!--Shujuw4 -->");
        if (iVar4 == 0) goto LAB_1000c8a4;
        websWriteDataNonBlock(param_1,buf,iVar3);
        websWrite(param_1,&DAT_10022d7c);
      }
      goto LAB_1000da10;
    }
  }
  goto LAB_1000c8ec;
LAB_1000c8a4:
  nCount = ReadString(fd,buf,0x1000);
  if (nCount < 0) goto LAB_1000da10;
  if (nCount != 0) {
    websWriteDataNonBlock(param_1,buf,nCount + -2);
    websWrite(param_1," selected=\"selected\" >\n");
  }
LAB_1000c8ec:
  cVar1 = P_Web_port[Nchoice * 0x12a + 0xd7];
  if (cVar1 == '\x02') {
    while( true ) {
      iVar3 = ReadString(fd,buf,0x1000);
      nCount = iVar3;
      if (iVar3 < 0) break;
      if (iVar3 == 0) goto LAB_1000cac8;
      buf[iVar3] = 0;
      iVar4 = strcmp(buf,"<!--Xieyi2 -->");
      if (iVar4 == 0) goto LAB_1000ca58;
      websWriteDataNonBlock(param_1,buf,iVar3);
      websWrite(param_1,&DAT_10022d7c);
    }
  }
  else if (cVar1 == '\x03') {
    while( true ) {
      iVar3 = ReadString(fd,buf,0x1000);
      nCount = iVar3;
      if (iVar3 < 0) break;
      if (iVar3 == 0) goto LAB_1000cac8;
      buf[iVar3] = 0;
      iVar4 = strcmp(buf,"<!--Xieyi3 -->");
      if (iVar4 == 0) goto LAB_1000ca58;
      websWriteDataNonBlock(param_1,buf,iVar3);
      websWrite(param_1,&DAT_10022d7c);
    }
  }
  else if (cVar1 == '\x01') {
    while( true ) {
      iVar3 = ReadString(fd,buf,0x1000);
      nCount = iVar3;
      if (iVar3 < 0) break;
      if (iVar3 == 0) goto LAB_1000cac8;
      buf[iVar3] = 0;
      iVar4 = strcmp(buf,"<!--Xieyi1 -->");
      if (iVar4 == 0) goto LAB_1000ca58;
      websWriteDataNonBlock(param_1,buf,iVar3);
      websWrite(param_1,&DAT_10022d7c);
    }
  }
  else {
LAB_1000cac8:
    if (P_Web_port[Nchoice * 0x12a + 0xdd] == '\x01') {
      while( true ) {
        iVar3 = ReadString(fd,buf,0x1000);
        nCount = iVar3;
        if (iVar3 < 0) break;
        if (iVar3 == 0) goto LAB_1000cc24;
        buf[iVar3] = 0;
        iVar4 = strcmp(buf,"<!--Tingz1 -->");
        if (iVar4 == 0) goto LAB_1000cbdc;
        websWriteDataNonBlock(param_1,buf,iVar3);
        websWrite(param_1,&DAT_10022d7c);
      }
    }
    else if (P_Web_port[Nchoice * 0x12a + 0xdd] == '\x02') {
      while( true ) {
        iVar3 = ReadString(fd,buf,0x1000);
        nCount = iVar3;
        if (iVar3 < 0) break;
        if (iVar3 == 0) goto LAB_1000cc24;
        buf[iVar3] = 0;
        iVar4 = strcmp(buf,"<!--Tingz2 -->");
        if (iVar4 == 0) goto LAB_1000cbdc;
        websWriteDataNonBlock(param_1,buf,iVar3);
        websWrite(param_1,&DAT_10022d7c);
      }
    }
    else {
LAB_1000cc24:
      iVar3 = Nchoice * 0x12a;
      uVar5 = (uint)(byte)P_Web_port[iVar3 + 0xdb] |
              (uint)(byte)P_Web_port[iVar3 + 0xda] << 8 |
              (uint)(byte)P_Web_port[iVar3 + 0xd9] << 0x10 |
              (uint)(byte)P_Web_port[iVar3 + 0xd8] << 0x18;
      if (uVar5 == 56000) {
        while( true ) {
          iVar3 = ReadString(fd,buf,0x1000);
          nCount = iVar3;
          if (iVar3 < 0) break;
          if (iVar3 == 0) goto LAB_1000d2f0;
          buf[iVar3] = 0;
          iVar4 = strcmp(buf,"<!--Shulv6 -->");
          if (iVar4 == 0) goto LAB_1000d280;
          websWriteDataNonBlock(param_1,buf,iVar3);
          websWrite(param_1,&DAT_10022d7c);
        }
      }
      else {
        if (uVar5 < 0xdac1) {
          if (uVar5 == 0x2580) {
            while( true ) {
              iVar3 = ReadString(fd,buf,0x1000);
              nCount = iVar3;
              if (iVar3 < 0) break;
              if (iVar3 == 0) goto LAB_1000d2f0;
              buf[iVar3] = 0;
              iVar4 = strcmp(buf,"<!--Shulv3 -->");
              if (iVar4 == 0) goto LAB_1000d280;
              websWriteDataNonBlock(param_1,buf,iVar3);
              websWrite(param_1,&DAT_10022d7c);
            }
            goto LAB_1000da10;
          }
          if (uVar5 < 0x2581) {
            if (uVar5 == 0x960) {
              while( true ) {
                iVar3 = ReadString(fd,buf,0x1000);
                nCount = iVar3;
                if (iVar3 < 0) break;
                if (iVar3 == 0) goto LAB_1000d2f0;
                buf[iVar3] = 0;
                iVar4 = strcmp(buf,"<!--Shulv1 -->");
                if (iVar4 == 0) goto LAB_1000d280;
                websWriteDataNonBlock(param_1,buf,iVar3);
                websWrite(param_1,&DAT_10022d7c);
              }
              goto LAB_1000da10;
            }
            if (uVar5 == 0x12c0) {
              while( true ) {
                iVar3 = ReadString(fd,buf,0x1000);
                nCount = iVar3;
                if (iVar3 < 0) break;
                if (iVar3 == 0) goto LAB_1000d2f0;
                buf[iVar3] = 0;
                iVar4 = strcmp(buf,"<!--Shulv2 -->");
                if (iVar4 == 0) goto LAB_1000d280;
                websWriteDataNonBlock(param_1,buf,iVar3);
                websWrite(param_1,&DAT_10022d7c);
              }
              goto LAB_1000da10;
            }
          }
          else {
            if (uVar5 == 0x4b00) {
              while( true ) {
                iVar3 = ReadString(fd,buf,0x1000);
                nCount = iVar3;
                if (iVar3 < 0) break;
                if (iVar3 == 0) goto LAB_1000d2f0;
                buf[iVar3] = 0;
                iVar4 = strcmp(buf,"<!--Shulv4 -->");
                if (iVar4 == 0) goto LAB_1000d280;
                websWriteDataNonBlock(param_1,buf,iVar3);
                websWrite(param_1,&DAT_10022d7c);
              }
              goto LAB_1000da10;
            }
            if (uVar5 == 0x8340) {
              while( true ) {
                iVar3 = ReadString(fd,buf,0x1000);
                nCount = iVar3;
                if (iVar3 < 0) break;
                if (iVar3 == 0) goto LAB_1000d2f0;
                buf[iVar3] = 0;
                iVar4 = strcmp(buf,"<!--Shulv5 -->");
                if (iVar4 == 0) goto LAB_1000d280;
                websWriteDataNonBlock(param_1,buf,iVar3);
                websWrite(param_1,&DAT_10022d7c);
              }
              goto LAB_1000da10;
            }
          }
        }
        else {
          if (uVar5 == 0x3e800) {
            while( true ) {
              iVar3 = ReadString(fd,buf,0x1000);
              nCount = iVar3;
              if (iVar3 < 0) break;
              if (iVar3 == 0) goto LAB_1000d2f0;
              buf[iVar3] = 0;
              iVar4 = strcmp(buf,"<!--Shulv9 -->");
              if (iVar4 == 0) goto LAB_1000d280;
              websWriteDataNonBlock(param_1,buf,iVar3);
              websWrite(param_1,&DAT_10022d7c);
            }
            goto LAB_1000da10;
          }
          if (uVar5 < 0x3e801) {
            if (uVar5 == 64000) {
              while( true ) {
                iVar3 = ReadString(fd,buf,0x1000);
                nCount = iVar3;
                if (iVar3 < 0) break;
                if (iVar3 == 0) goto LAB_1000d2f0;
                buf[iVar3] = 0;
                iVar4 = strcmp(buf,"<!--Shulv7 -->");
                if (iVar4 == 0) goto LAB_1000d280;
                websWriteDataNonBlock(param_1,buf,iVar3);
                websWrite(param_1,&DAT_10022d7c);
              }
              goto LAB_1000da10;
            }
            if (uVar5 == 0x1f400) {
              while( true ) {
                iVar3 = ReadString(fd,buf,0x1000);
                nCount = iVar3;
                if (iVar3 < 0) break;
                if (iVar3 == 0) goto LAB_1000d2f0;
                buf[iVar3] = 0;
                iVar4 = strcmp(buf,"<!--Shulv8 -->");
                if (iVar4 == 0) goto LAB_1000d280;
                websWriteDataNonBlock(param_1,buf,iVar3);
                websWrite(param_1,&DAT_10022d7c);
              }
              goto LAB_1000da10;
            }
          }
          else {
            if (uVar5 == 0xfa000) {
              while( true ) {
                iVar3 = ReadString(fd,buf,0x1000);
                nCount = iVar3;
                if (iVar3 < 0) break;
                if (iVar3 == 0) goto LAB_1000d2f0;
                buf[iVar3] = 0;
                iVar4 = strcmp(buf,"<!--Shulv11 -->");
                if (iVar4 == 0) goto LAB_1000d280;
                websWriteDataNonBlock(param_1,buf,iVar3);
                websWrite(param_1,&DAT_10022d7c);
              }
              goto LAB_1000da10;
            }
            if (uVar5 == 0x1f4000) {
              while( true ) {
                iVar3 = ReadString(fd,buf,0x1000);
                nCount = iVar3;
                if (iVar3 < 0) break;
                if (iVar3 == 0) goto LAB_1000d2f0;
                buf[iVar3] = 0;
                iVar4 = strcmp(buf,"<!--Shulv12 -->");
                if (iVar4 == 0) goto LAB_1000d280;
                websWriteDataNonBlock(param_1,buf,iVar3);
                websWrite(param_1,&DAT_10022d7c);
              }
              goto LAB_1000da10;
            }
            if (uVar5 == 0x7d000) {
              while( true ) {
                iVar3 = ReadString(fd,buf,0x1000);
                nCount = iVar3;
                if (iVar3 < 0) break;
                if (iVar3 == 0) goto LAB_1000d2f0;
                buf[iVar3] = 0;
                iVar4 = strcmp(buf,"<!--Shulv10 -->");
                if (iVar4 == 0) goto LAB_1000d280;
                websWriteDataNonBlock(param_1,buf,iVar3);
                websWrite(param_1,&DAT_10022d7c);
              }
              goto LAB_1000da10;
            }
          }
        }
LAB_1000d2f0:
        switch(P_Web_port[Nchoice * 0x12a + 0xde] + -1) {
        case '\0':
          while( true ) {
            iVar3 = ReadString(fd,buf,0x1000);
            nCount = iVar3;
            if (iVar3 < 0) break;
            if (iVar3 == 0) goto switchD_1000d330_caseD_5;
            buf[iVar3] = 0;
            iVar4 = strcmp(buf,"<!--Jiaoy1 -->");
            if (iVar4 == 0) goto LAB_1000d540;
            websWriteDataNonBlock(param_1,buf,iVar3);
            websWrite(param_1,&DAT_10022d7c);
          }
          break;
        case '\x01':
          while( true ) {
            iVar3 = ReadString(fd,buf,0x1000);
            nCount = iVar3;
            if (iVar3 < 0) break;
            if (iVar3 == 0) goto switchD_1000d330_caseD_5;
            buf[iVar3] = 0;
            iVar4 = strcmp(buf,"<!--Jiaoy2 -->");
            if (iVar4 == 0) goto LAB_1000d540;
            websWriteDataNonBlock(param_1,buf,iVar3);
            websWrite(param_1,&DAT_10022d7c);
          }
          break;
        case '\x02':
          while( true ) {
            iVar3 = ReadString(fd,buf,0x1000);
            nCount = iVar3;
            if (iVar3 < 0) break;
            if (iVar3 == 0) goto switchD_1000d330_caseD_5;
            buf[iVar3] = 0;
            iVar4 = strcmp(buf,"<!--Jiaoy3 -->");
            if (iVar4 == 0) goto LAB_1000d540;
            websWriteDataNonBlock(param_1,buf,iVar3);
            websWrite(param_1,&DAT_10022d7c);
          }
          break;
        case '\x03':
          while( true ) {
            iVar3 = ReadString(fd,buf,0x1000);
            nCount = iVar3;
            if (iVar3 < 0) break;
            if (iVar3 == 0) goto switchD_1000d330_caseD_5;
            buf[iVar3] = 0;
            iVar4 = strcmp(buf,"<!--Jiaoy4 -->");
            if (iVar4 == 0) goto LAB_1000d540;
            websWriteDataNonBlock(param_1,buf,iVar3);
            websWrite(param_1,&DAT_10022d7c);
          }
          break;
        case '\x04':
          while( true ) {
            iVar3 = ReadString(fd,buf,0x1000);
            nCount = iVar3;
            if (iVar3 < 0) break;
            if (iVar3 == 0) goto switchD_1000d330_caseD_5;
            buf[iVar3] = 0;
            iVar4 = strcmp(buf,"<!--Jiaoy5 -->");
            if (iVar4 == 0) goto LAB_1000d540;
            websWriteDataNonBlock(param_1,buf,iVar3);
            websWrite(param_1,&DAT_10022d7c);
          }
          break;
        default:
switchD_1000d330_caseD_5:
          iVar3 = Nchoice * 0x12a;
          uVar5 = (uint)(byte)P_Web_port[iVar3 + 0x1fa] |
                  (uint)(byte)P_Web_port[iVar3 + 0x1f9] << 8 |
                  (uint)(byte)P_Web_port[iVar3 + 0x1f8] << 0x10 |
                  (uint)(byte)P_Web_port[iVar3 + 0x1f7] << 0x18;
          if (uVar5 == 1) {
            while( true ) {
              iVar3 = ReadString(fd,buf,0x1000);
              nCount = iVar3;
              if (iVar3 < 0) break;
              if (iVar3 == 0) goto LAB_1000d82c;
              buf[iVar3] = 0;
              iVar4 = strcmp(buf,"<!--SHUJUYUAN2 -->");
              if (iVar4 == 0) goto LAB_1000d7bc;
              websWriteDataNonBlock(param_1,buf,iVar3);
              websWrite(param_1,&DAT_10022d7c);
            }
          }
          else if (uVar5 == 0) {
            while( true ) {
              iVar3 = ReadString(fd,buf,0x1000);
              nCount = iVar3;
              if (iVar3 < 0) break;
              if (iVar3 == 0) goto LAB_1000d82c;
              buf[iVar3] = 0;
              iVar4 = strcmp(buf,"<!--SHUJUYUAN1 -->");
              if (iVar4 == 0) goto LAB_1000d7bc;
              websWriteDataNonBlock(param_1,buf,iVar3);
              websWrite(param_1,&DAT_10022d7c);
            }
          }
          else if (uVar5 == 2) {
            while( true ) {
              iVar3 = ReadString(fd,buf,0x1000);
              nCount = iVar3;
              if (iVar3 < 0) break;
              if (iVar3 == 0) goto LAB_1000d82c;
              buf[iVar3] = 0;
              iVar4 = strcmp(buf,"<!--SHUJUYUAN3 -->");
              if (iVar4 == 0) goto LAB_1000d7bc;
              websWriteDataNonBlock(param_1,buf,iVar3);
              websWrite(param_1,&DAT_10022d7c);
            }
          }
          else {
            while( true ) {
              iVar3 = ReadString(fd,buf,0x1000);
              nCount = iVar3;
              if (iVar3 < 0) break;
              if (iVar3 == 0) goto LAB_1000d82c;
              buf[iVar3] = 0;
              iVar4 = strcmp(buf,"<!--SHUJUYUAN3 -->");
              if (iVar4 == 0) goto LAB_1000d7bc;
              websWriteDataNonBlock(param_1,buf,iVar3);
              websWrite(param_1,&DAT_10022d7c);
            }
          }
        }
      }
    }
  }
  goto LAB_1000da10;
LAB_1000ca58:
  nCount = ReadString(fd,buf,0x1000);
  if (nCount < 0) goto LAB_1000da10;
  if (nCount != 0) {
    websWriteDataNonBlock(param_1,buf,nCount + -2);
    websWrite(param_1," selected=\"selected\" >\n");
  }
  goto LAB_1000cac8;
LAB_1000cbdc:
  nCount = ReadString(fd,buf,0x1000);
  if (nCount < 0) goto LAB_1000da10;
  if (nCount != 0) {
    websWriteDataNonBlock(param_1,buf,nCount + -2);
    websWrite(param_1," selected=\"selected\" >\n");
  }
  goto LAB_1000cc24;
LAB_1000d280:
  nCount = ReadString(fd,buf,0x1000);
  if (nCount < 0) goto LAB_1000da10;
  if (nCount != 0) {
    websWriteDataNonBlock(param_1,buf,nCount + -2);
    websWrite(param_1," selected=\"selected\" >\n");
  }
  goto LAB_1000d2f0;
LAB_1000d540:
  nCount = ReadString(fd,buf,0x1000);
  if (nCount < 0) goto LAB_1000da10;
  if (nCount != 0) {
    websWriteDataNonBlock(param_1,buf,nCount + -2);
    websWrite(param_1," selected=\"selected\" >\n");
  }
  goto switchD_1000d330_caseD_5;
LAB_1000d7bc:
  nCount = ReadString(fd,buf,0x1000);
  if (-1 < nCount) {
    if (nCount != 0) {
      websWriteDataNonBlock(param_1,buf,nCount + -2);
      websWrite(param_1," selected=\"selected\" >\n");
    }
LAB_1000d82c:
    if (P_Web_port[Nchoice * 0x12a + 0xd4] == '\x01') {
      while( true ) {
        iVar3 = ReadString(fd,buf,0x1000);
        nCount = iVar3;
        if (iVar3 < 0) break;
        if (iVar3 == 0) goto LAB_1000d9a4;
        buf[iVar3] = 0;
        iVar4 = strcmp(buf,"<!--Iclock -->");
        if (iVar4 == 0) goto LAB_1000d908;
        websWriteDataNonBlock(param_1,buf,iVar3);
        websWrite(param_1,&DAT_10022d7c);
      }
    }
    else {
      while( true ) {
        iVar3 = ReadString(fd,buf,0x1000);
        nCount = iVar3;
        if (iVar3 < 0) break;
        if (iVar3 == 0) goto LAB_1000d9a4;
        buf[iVar3] = 0;
        iVar4 = strcmp(buf,"<!--Oclock -->");
        if (iVar4 == 0) goto LAB_1000d908;
        websWriteDataNonBlock(param_1,buf,iVar3);
        websWrite(param_1,&DAT_10022d7c);
      }
    }
  }
  goto LAB_1000da10;
LAB_1000d908:
  nCount = ReadString(fd,buf,0x1000);
  if (-1 < nCount) {
    if (nCount != 0) {
      websWriteDataNonBlock(param_1,buf,nCount + -2);
      websWrite(param_1," checked=\"checked\" />\n");
    }
LAB_1000d9a4:
    while( true ) {
      nCount = ReadString(fd,buf,0x1000);
      if (nCount < 0) break;
      if (nCount == 0) {
        if (0 < fd) {
          httpPlatformClose();
        }
        websDone(param_1,0xc9);
        return;
      }
      iVar3 = 0;
      for (; nCount != 0; nCount = nCount - iVar3) {
        iVar3 = websWriteDataNonBlock(param_1,buf + iVar3);
        if (iVar3 < 0) goto LAB_1000da10;
      }
      websWrite(param_1,&DAT_10022d7c);
    }
  }
LAB_1000da10:
  if (0 < fd) {
    httpPlatformClose();
  }
  websError(param_1,0x194,"Cannot open URL:%s","/PortConf8s.htm");
  return;
}
----------------------------------------

Function: Save_time_cgf

void Save_time_cgf(undefined4 param_1,char *param_2,int param_3)

{
  FILE *__stream;
  int iVar1;
  char *__command;
  
  __stream = fopen("/etc/config/system","w+");
  if (__stream == (FILE *)0x0) {
    puts("open cfg error");
  }
  fputc(10,__stream);
  fputs("config system\n",__stream);
  fputs("        option \'hostname\'       \'MPDC-II\'\n",__stream);
  fputs("        option \'timezone\'       \'CST-8\'\n",__stream);
  fputs("        option \'zonename\'       \'Asia/Shanghai\'\n",__stream);
  fputc(10,__stream);
  fputs("config restore\n",__stream);
  iVar1 = atoi(param_2);
  fprintf(__stream,"        option \'filter\'         \'%d\'\n",iVar1);
  fputs("        option \'mode\'           \'minimal\'\n",__stream);
  fputc(10,__stream);
  fputs("config timeserver ntp\n",__stream);
  fprintf(__stream,"        list server     %s\n",param_1);
  fputs("        list server     0.openwrt.pool.ntp.org\n",__stream);
  fputs("        list server     1.openwrt.pool.ntp.org\n",__stream);
  fputs("        list server     2.openwrt.pool.ntp.org\n",__stream);
  fputs("        list server     3.openwrt.pool.ntp.org\n",__stream);
  if (param_3 == 1) {
    fputs("        option enable_server 1\n",__stream);
    fclose(__stream);
    __command = "/etc/init.d/sysntpd restart";
  }
  else {
    fputs("        option enable_server 0\n",__stream);
    fclose(__stream);
    __command = "/etc/init.d/sysntpd stop";
  }
  system(__command);
  return;
}
----------------------------------------

Function: ModifyNet1Time

void ModifyNet1Time(undefined4 param_1)

{
  char *__s;
  char *__nptr;
  
  __s = (char *)websGetVar(param_1,"TimeSerIp",&DAT_10023fc4);
  websGetVar(param_1,"TimeInterval",&DAT_10023fc4);
  __nptr = (char *)websGetVar(param_1,"statntp",&DAT_10023fc4);
  websGetVar(param_1,"stopntp",&DAT_10023fc4);
  atoi(__nptr);
  memset(g_pWrData,0,0x20);
                    /* WARNING: Subroutine does not return */
  strlen(__s);
}
----------------------------------------

Function: ModifyNetTime

void ModifyNetTime(undefined4 param_1)

{
  char *__nptr;
  char *__nptr_00;
  char *__nptr_01;
  char *__nptr_02;
  char *__nptr_03;
  char *__nptr_04;
  int iVar1;
  int iVar2;
  int iVar3;
  int iVar4;
  int iVar5;
  int iVar6;
  char acStack_120 [128];
  char acStack_a0 [128];
  
  __nptr = (char *)websGetVar(param_1,"SetYear",&DAT_10023fc4);
  __nptr_00 = (char *)websGetVar(param_1,"SetMonth",&DAT_10023fc4);
  __nptr_01 = (char *)websGetVar(param_1,"SetDay",&DAT_10023fc4);
  __nptr_02 = (char *)websGetVar(param_1,"SetHour",&DAT_10023fc4);
  __nptr_03 = (char *)websGetVar(param_1,"SetMinute",&DAT_10023fc4);
  __nptr_04 = (char *)websGetVar(param_1,"SetSecond",&DAT_10023fc4);
  websGetVar(param_1,"TimeSerIp",&DAT_10023fc4);
  websGetVar(param_1,"TimeInterval",&DAT_10023fc4);
  iVar1 = atoi(__nptr);
  iVar2 = atoi(__nptr_00);
  iVar3 = atoi(__nptr_01);
  iVar4 = atoi(__nptr_02);
  iVar5 = atoi(__nptr_03);
  iVar6 = atoi(__nptr_04);
  sprintf(acStack_120,"%c%d-%d-%d %d:%d:%d%c",0x22,iVar1,iVar2,iVar3,iVar4,iVar5,iVar6,0x22);
  sprintf(acStack_a0,"date -s %s",acStack_120);
  system(acStack_a0);
  system("hwclock -w");
  return;
}
----------------------------------------

Function: NetSave

void NetSave(void)

{
  int iVar1;
  char *pcVar2;
  char *pcVar3;
  char acStack_98 [136];
  
  memset(acStack_98,0,0x80);
  sprintf(acStack_98,"uci set network.lan0.ipaddr=%s",g_pWrData + 0x65);
  system(acStack_98);
  memset(acStack_98,0,0x80);
  sprintf(acStack_98,"uci set network.lan0.netmask=%s",g_pWrData + 0x75);
  system(acStack_98);
  iVar1 = g_pWrData;
  pcVar3 = (char *)(g_pWrData + 0x85);
  pcVar2 = strstr(pcVar3,"0.0.0.0");
  if ((pcVar2 == (char *)0x0) && (*(char *)(iVar1 + 0x85) != '\0')) {
    memset(acStack_98,0,0x80);
    sprintf(acStack_98,"uci set network.lan0.gateway=%s",pcVar3);
    system(acStack_98);
  }
  memset(acStack_98,0,0x80);
  sprintf(acStack_98,"uci set network.lan1.ipaddr=%s",g_pWrData + 0xa1);
  system(acStack_98);
  memset(acStack_98,0,0x80);
  sprintf(acStack_98,"uci set network.lan1.netmask=%s",g_pWrData + 0xb1);
  system(acStack_98);
  iVar1 = g_pWrData;
  pcVar3 = (char *)(g_pWrData + 0xc1);
  pcVar2 = strstr(pcVar3,"0.0.0.0");
  if ((pcVar2 == (char *)0x0) && (*(char *)(iVar1 + 0xc1) != '\0')) {
    memset(acStack_98,0,0x80);
    sprintf(acStack_98,"uci set network.lan1.gateway=%s",pcVar3);
    system(acStack_98);
  }
  system("uci commit network");
  return;
}
----------------------------------------

Function: Read_Netinfo

undefined4 Read_Netinfo(char *param_1,int param_2)

{
  int iVar1;
  char *pcVar2;
  int iVar3;
  uint uVar4;
  char acStack_48 [15];
  undefined local_39;
  undefined4 local_34;
  in_addr local_28;
  in_addr local_24;
  in_addr local_20 [2];
  uint local_18;
  
  iVar1 = socket(2,2,0);
  strncpy(acStack_48,param_1,0x10);
  local_39 = 0;
  iVar1 = ioctl(iVar1,0x8915,acStack_48);
  if (-1 < iVar1) {
    if (param_2 == 0) {
      local_18 = local_34;
      pcVar2 = inet_ntoa((in_addr)&local_18);
      strcpy(NEWstrIPAddress1,pcVar2);
      iVar1 = socket(2,1,0);
      if (iVar1 < 0) {
LAB_1000ee18:
        perror("socket");
        return 2;
      }
      iVar3 = ioctl(iVar1,0x8927,acStack_48);
      if ((-1 < iVar3) && (iVar1 = ioctl(iVar1,0x891b,acStack_48), -1 < iVar1)) {
        local_18 = local_34;
        pcVar2 = inet_ntoa((in_addr)&local_18);
        strcpy(NEWstrNetMask1,pcVar2);
        inet_aton(NEWstrIPAddress1,local_20);
        inet_aton(NEWstrNetMask1,&local_24);
        inet_aton("0.0.0.1",&local_28);
        local_18 = local_24.s_addr & local_20[0].s_addr;
        uVar4 = local_18 | local_28.s_addr;
        pcVar2 = inet_ntoa((in_addr)&local_18);
        strcpy(NEWstrNetWork1,pcVar2);
        local_18 = local_20[0].s_addr | ~local_24.s_addr;
        pcVar2 = inet_ntoa((in_addr)&local_18);
        strcpy(NEWstrBroadcast1,pcVar2);
        local_18 = uVar4;
        pcVar2 = inet_ntoa((in_addr)&local_18);
        strcpy(NEWstrGateAddress1,pcVar2);
        return 0;
      }
    }
    else {
      if (param_2 != 1) {
        return 0;
      }
      local_18 = local_34;
      pcVar2 = inet_ntoa((in_addr)&local_18);
      strcpy(NEWstrIPAddress2,pcVar2);
      iVar1 = socket(2,1,0);
      if (iVar1 < 0) goto LAB_1000ee18;
      iVar3 = ioctl(iVar1,0x8927,acStack_48);
      if ((-1 < iVar3) && (iVar1 = ioctl(iVar1,0x891b,acStack_48), -1 < iVar1)) {
        local_18 = local_34;
        pcVar2 = inet_ntoa((in_addr)&local_18);
        strcpy(NEWstrNetMask2,pcVar2);
        inet_aton(NEWstrIPAddress2,local_20);
        inet_aton(NEWstrNetMask2,&local_24);
        inet_aton("0.0.0.1",&local_28);
        local_18 = local_24.s_addr & local_20[0].s_addr;
        uVar4 = local_18 | local_28.s_addr;
        pcVar2 = inet_ntoa((in_addr)&local_18);
        strcpy(NEWstrNetWork2,pcVar2);
        local_18 = local_20[0].s_addr | ~local_24.s_addr;
        pcVar2 = inet_ntoa((in_addr)&local_18);
        strcpy(NEWstrBroadcast2,pcVar2);
        local_18 = uVar4;
        pcVar2 = inet_ntoa((in_addr)&local_18);
        strcpy(NEWstrGateAddress2,pcVar2);
        return 0;
      }
    }
  }
  perror("ioctl");
  return 3;
}
----------------------------------------

Function: Modify_ip_port

undefined4 Modify_ip_port(undefined4 param_1,int param_2)

{
  int iVar1;
  char *pcVar2;
  char *pcVar3;
  char *pcVar4;
  uint uVar5;
  int iVar6;
  undefined *puVar7;
  char *pcVar8;
  int local_78;
  char acStack_74 [64];
  char acStack_34 [20];
  
  if (param_2 == 0) {
    pcVar2 = (char *)websGetVar(param_1,"IpAddr1",&DAT_10023fc4);
    pcVar3 = (char *)websGetVar(param_1,"NETMASK1",&DAT_10023fc4);
    pcVar4 = (char *)websGetVar(param_1,"GATEWAY1",&DAT_10023fc4);
    memset(&str_addr,0,0x44);
    StringSplit_Struct(&str_addr,pcVar2,&DAT_10021168);
    if (((uint)DAT_100b1a6b |
        (uint)DAT_100b1a6a << 8 | (uint)DAT_100b1a69 << 0x10 | (uint)str_addr << 0x18) != 3) {
LAB_1000f148:
      puVar7 = &DAT_100227b8;
      goto LAB_1000f304;
    }
    pcVar8 = &DAT_100b1a6c;
    do {
      uVar5 = atoi(pcVar8);
      iVar1 = g_pWrData;
      if (0xfe < uVar5) goto LAB_1000f148;
      pcVar8 = pcVar8 + 0x10;
    } while (pcVar8 != strNetWork);
    pcVar8 = strstr((char *)(g_pWrData + 0xa1),pcVar2);
    if (pcVar8 == (char *)0x0) {
      strncpy((char *)(iVar1 + 0x65),pcVar2,0x10);
      memset(&local_78,0,0x44);
      StringSplit_Struct(&local_78,pcVar3,&DAT_10021168);
      if (local_78 == 3) {
        pcVar2 = acStack_74;
        do {
          uVar5 = atoi(pcVar2);
          if (0xff < uVar5) goto LAB_1000f2a4;
          pcVar2 = pcVar2 + 0x10;
        } while (pcVar2 != acStack_34);
        strncpy((char *)(g_pWrData + 0x75),pcVar3,0x10);
        memset(&str_ZADDR,0,0x44);
        StringSplit_Struct(&str_ZADDR,pcVar4,&DAT_10021168);
        if (((uint)DAT_100b1a07 |
            (uint)DAT_100b1a06 << 8 | (uint)DAT_100b1a05 << 0x10 | (uint)str_ZADDR << 0x18) == 3) {
          pcVar2 = &DAT_100b1a08;
          while (uVar5 = atoi(pcVar2), uVar5 < 0xff) {
            pcVar2 = pcVar2 + 0x10;
            if (pcVar2 == g_SysDev_t) {
              strncpy((char *)(g_pWrData + 0x85),pcVar4,0x10);
              pcVar2 = (char *)websGetVar(param_1,&DAT_100229d8,&DAT_10023fc4);
              iVar6 = atoi(pcVar2);
              iVar1 = g_pWrData;
              if (0xfffd < iVar6 - 1U) {
                return 0;
              }
              *(char *)(g_pWrData + 0x5d) = (char)((uint)iVar6 >> 0x18);
              *(char *)(iVar1 + 0x5e) = (char)((uint)iVar6 >> 0x10);
              *(char *)(iVar1 + 0x60) = (char)iVar6;
              *(char *)(iVar1 + 0x5f) = (char)((uint)iVar6 >> 8);
              pcVar2 = (char *)websGetVar(param_1,&DAT_10022898,&DAT_10023fc4);
              iVar6 = atoi(pcVar2);
              iVar1 = g_pWrData;
              if (0xfffd < iVar6 - 1U) {
                return 0;
              }
              *(char *)(g_pWrData + 0x61) = (char)((uint)iVar6 >> 0x18);
              *(char *)(iVar1 + 0x62) = (char)((uint)iVar6 >> 0x10);
              *(char *)(iVar1 + 99) = (char)((uint)iVar6 >> 8);
              *(char *)(iVar1 + 100) = (char)iVar6;
              return 1;
            }
          }
        }
        puVar7 = &DAT_1002284c;
      }
      else {
LAB_1000f2a4:
        puVar7 = &DAT_10022800;
      }
      goto LAB_1000f304;
    }
  }
  else {
    pcVar2 = (char *)websGetVar(param_1,"IpAddr2",&DAT_10023fc4);
    pcVar3 = (char *)websGetVar(param_1,"NETMASK2",&DAT_10023fc4);
    pcVar4 = (char *)websGetVar(param_1,"GATEWAY2",&DAT_10023fc4);
    memset(&str_addr,0,0x44);
    StringSplit_Struct(&str_addr,pcVar2,&DAT_10021168);
    if (((uint)DAT_100b1a6b |
        (uint)DAT_100b1a6a << 8 | (uint)DAT_100b1a69 << 0x10 | (uint)str_addr << 0x18) != 3) {
LAB_1000f214:
      puVar7 = &DAT_100228b4;
      goto LAB_1000f304;
    }
    pcVar8 = &DAT_100b1a6c;
    do {
      uVar5 = atoi(pcVar8);
      iVar1 = g_pWrData;
      if (0xfe < uVar5) goto LAB_1000f214;
      pcVar8 = pcVar8 + 0x10;
    } while (pcVar8 != strNetWork);
    pcVar8 = strstr((char *)(g_pWrData + 0x65),pcVar2);
    if (pcVar8 == (char *)0x0) {
      strncpy((char *)(iVar1 + 0xa1),pcVar2,0x10);
      memset(&local_78,0,0x44);
      StringSplit_Struct(&local_78,pcVar3,&DAT_10021168);
      if (local_78 == 3) {
        pcVar2 = acStack_74;
        do {
          uVar5 = atoi(pcVar2);
          if (0xff < uVar5) goto LAB_1000f5f0;
          pcVar2 = pcVar2 + 0x10;
        } while (pcVar2 != acStack_34);
        strncpy((char *)(g_pWrData + 0xb1),pcVar3,0x10);
        memset(&str_ZADDR,0,0x44);
        StringSplit_Struct(&str_ZADDR,pcVar4,&DAT_10021168);
        if (((uint)DAT_100b1a07 |
            (uint)DAT_100b1a06 << 8 | (uint)DAT_100b1a05 << 0x10 | (uint)str_ZADDR << 0x18) == 3) {
          pcVar2 = &DAT_100b1a08;
          while (uVar5 = atoi(pcVar2), uVar5 < 0xff) {
            pcVar2 = pcVar2 + 0x10;
            if (pcVar2 == g_SysDev_t) {
              strncpy((char *)(g_pWrData + 0xc1),pcVar4,0x10);
              pcVar2 = (char *)websGetVar(param_1,"DNS11",&DAT_10023fc4);
              iVar6 = atoi(pcVar2);
              iVar1 = g_pWrData;
              if (0xfffd < iVar6 - 1U) {
                return 0;
              }
              *(char *)(g_pWrData + 0x99) = (char)((uint)iVar6 >> 0x18);
              *(char *)(iVar1 + 0x9a) = (char)((uint)iVar6 >> 0x10);
              *(char *)(iVar1 + 0x9c) = (char)iVar6;
              *(char *)(iVar1 + 0x9b) = (char)((uint)iVar6 >> 8);
              pcVar2 = (char *)websGetVar(param_1,"DNS22",&DAT_10023fc4);
              iVar6 = atoi(pcVar2);
              iVar1 = g_pWrData;
              if (0xfffd < iVar6 - 1U) {
                return 0;
              }
              *(char *)(g_pWrData + 0x9d) = (char)((uint)iVar6 >> 0x18);
              *(char *)(iVar1 + 0x9e) = (char)((uint)iVar6 >> 0x10);
              *(char *)(iVar1 + 0x9f) = (char)((uint)iVar6 >> 8);
              *(char *)(iVar1 + 0xa0) = (char)iVar6;
              return 1;
            }
          }
        }
        puVar7 = &DAT_10022948;
      }
      else {
LAB_1000f5f0:
        puVar7 = &DAT_100228fc;
      }
      goto LAB_1000f304;
    }
  }
  puVar7 = &DAT_1002299c;
LAB_1000f304:
  websWrite(param_1,puVar7);
  return 0;
}
----------------------------------------

Function: GetModifyAddrSegment

void GetModifyAddrSegment(char *param_1,char *param_2,char *param_3)

{
  char *__src;
  int iVar1;
  in_addr local_24;
  in_addr local_20 [2];
  uint local_18;
  
  local_20[0].s_addr = 0;
  local_24.s_addr = 0;
  inet_aton(param_2,local_20);
  inet_aton(param_3,&local_24);
  local_18 = local_24.s_addr & local_20[0].s_addr;
  __src = inet_ntoa((in_addr)&local_18);
  strcpy(strNetWork,__src);
  iVar1 = strcmp(param_1,"eth0");
  if (iVar1 == 0) {
    AddOrAltNetConfig("/etc/sysconfig/networking/ifcfg-eth0","NETWORK",__src);
  }
  return;
}
----------------------------------------

Function: NetConf1

void NetConf1(undefined4 param_1)

{
  int iVar1;
  int iVar2;
  int iVar3;
  
  iVar1 = httpPlatformOpen("/NEW_NetConf1.htm",0);
  if (-1 < iVar1) {
    iVar2 = InitReadString();
    if (-1 < iVar2) {
      iVar2 = websCompareVar(param_1,"Submit",&DAT_10022a34);
      if (iVar2 != 0) {
        NetConfHandleSubmit(param_1,1);
      }
      iVar2 = websCompareVar(param_1,"RESTART",&DAT_10022a44);
      if (iVar2 != 0) {
        Sys_Reboot();
      }
      while( true ) {
        iVar2 = ReadString(iVar1,buf,0x1000);
        if (iVar2 < 0) break;
        if (iVar2 == 0) goto LAB_1000f90c;
        buf[iVar2] = 0;
        iVar3 = strcmp(buf,"<!--IpAddr2 -->");
        if (iVar3 == 0) {
          iVar2 = ReadString(iVar1,buf,0x1000);
          if (-1 < iVar2) {
            if (iVar2 != 0) {
              websWriteDataNonBlock(param_1,buf,iVar2 + -2);
              websWrite(param_1," value=\"");
                    /* WARNING: Subroutine does not return */
              strlen((char *)(g_pWrData + 0xa1));
            }
            goto LAB_1000f90c;
          }
          break;
        }
        websWriteDataNonBlock(param_1,buf,iVar2);
        websWrite(param_1,&DAT_10022d7c);
      }
    }
LAB_1000fcf0:
    if (iVar1 != 0) {
      httpPlatformClose(iVar1);
    }
  }
  websError(param_1,0x194,"Cannot open URL:%s","/NEW_NetConf.htm");
  return;
LAB_1000f90c:
  iVar2 = ReadString(iVar1,buf,0x1000);
  if (iVar2 < 0) goto LAB_1000fcf0;
  if (iVar2 == 0) goto LAB_1000f9f8;
  buf[iVar2] = 0;
  iVar3 = strcmp(buf,"<!--NETMASK2 -->");
  if (iVar3 == 0) {
    iVar2 = ReadString(iVar1,buf,0x1000);
    if (-1 < iVar2) {
      if (iVar2 != 0) {
        websWriteDataNonBlock(param_1,buf,iVar2 + -2);
        websWrite(param_1," value=\"");
                    /* WARNING: Subroutine does not return */
        strlen((char *)(g_pWrData + 0xb1));
      }
      goto LAB_1000f9f8;
    }
    goto LAB_1000fcf0;
  }
  websWriteDataNonBlock(param_1,buf,iVar2);
  websWrite(param_1,&DAT_10022d7c);
  goto LAB_1000f90c;
LAB_1000f9f8:
  iVar2 = ReadString(iVar1,buf,0x1000);
  if (iVar2 < 0) goto LAB_1000fcf0;
  if (iVar2 == 0) goto LAB_1000fae4;
  buf[iVar2] = 0;
  iVar3 = strcmp(buf,"<!--GATEWAY2 -->");
  if (iVar3 == 0) {
    iVar2 = ReadString(iVar1,buf,0x1000);
    if (-1 < iVar2) {
      if (iVar2 != 0) {
        websWriteDataNonBlock(param_1,buf,iVar2 + -2);
        websWrite(param_1," value=\"");
                    /* WARNING: Subroutine does not return */
        strlen((char *)(g_pWrData + 0xc1));
      }
      goto LAB_1000fae4;
    }
    goto LAB_1000fcf0;
  }
  websWriteDataNonBlock(param_1,buf,iVar2);
  websWrite(param_1,&DAT_10022d7c);
  goto LAB_1000f9f8;
LAB_1000fae4:
  iVar2 = ReadString(iVar1,buf,0x1000);
  if (iVar2 < 0) goto LAB_1000fcf0;
  if (iVar2 == 0) goto LAB_1000fbc8;
  buf[iVar2] = 0;
  iVar3 = strcmp(buf,"<!--DNS11 -->");
  if (iVar3 == 0) {
    iVar2 = ReadString(iVar1,buf,0x1000);
    if (-1 < iVar2) {
      if (iVar2 != 0) {
        websWriteDataNonBlock(param_1,buf,iVar2 + -2);
        websWrite(param_1," value=\"%d\"/>\n",
                  (uint)*(byte *)(g_pWrData + 0x9c) |
                  (uint)*(byte *)(g_pWrData + 0x9b) << 8 |
                  (uint)*(byte *)(g_pWrData + 0x9a) << 0x10 |
                  (uint)*(byte *)(g_pWrData + 0x99) << 0x18);
      }
      goto LAB_1000fbc8;
    }
    goto LAB_1000fcf0;
  }
  websWriteDataNonBlock(param_1,buf,iVar2);
  websWrite(param_1,&DAT_10022d7c);
  goto LAB_1000fae4;
LAB_1000fbc8:
  iVar2 = ReadString(iVar1,buf,0x1000);
  if (-1 < iVar2) {
    if (iVar2 == 0) {
LAB_1000fc54:
      Old_Inchoice1 = Inchoice1;
      while( true ) {
        iVar2 = ReadString(iVar1,buf,0x1000);
        if (iVar2 < 0) break;
        if (iVar2 == 0) {
          if (iVar1 != 0) {
            httpPlatformClose(iVar1);
          }
          websDone(param_1,0xc9);
          return;
        }
        iVar3 = 0;
        do {
          iVar3 = websWriteDataNonBlock(param_1,buf + iVar3,iVar2);
          if (iVar3 < 0) goto LAB_1000fcf0;
          iVar2 = iVar2 - iVar3;
        } while (iVar2 != 0);
        websWrite(param_1,&DAT_10022d7c);
      }
    }
    else {
      buf[iVar2] = 0;
      iVar3 = strcmp(buf,"<!--DNS22 -->");
      if (iVar3 != 0) goto code_r0x1000fba8;
      iVar2 = ReadString(iVar1,buf,0x1000);
      if (-1 < iVar2) {
        if (iVar2 != 0) {
          websWriteDataNonBlock(param_1,buf,iVar2 + -2);
          websWrite(param_1," value=\"%d\"/>\n",
                    (uint)*(byte *)(g_pWrData + 0xa0) |
                    (uint)*(byte *)(g_pWrData + 0x9f) << 8 |
                    (uint)*(byte *)(g_pWrData + 0x9e) << 0x10 |
                    (uint)*(byte *)(g_pWrData + 0x9d) << 0x18);
        }
        goto LAB_1000fc54;
      }
    }
  }
  goto LAB_1000fcf0;
code_r0x1000fba8:
  websWriteDataNonBlock(param_1,buf,iVar2);
  websWrite(param_1,&DAT_10022d7c);
  goto LAB_1000fbc8;
}
----------------------------------------

Function: NetConf

void NetConf(undefined4 param_1)

{
  int iVar1;
  int iVar2;
  int iVar3;
  
  iVar1 = httpPlatformOpen("/NEW_NetConf.htm",0);
  if (-1 < iVar1) {
    iVar2 = InitReadString();
    if (-1 < iVar2) {
      iVar2 = websCompareVar(param_1,"Submit",&DAT_10022a34);
      if (iVar2 != 0) {
        NetConfHandleSubmit(param_1,0);
      }
      iVar2 = websCompareVar(param_1,"RESTART",&DAT_10022a44);
      if (iVar2 != 0) {
        Sys_Reboot();
      }
      while( true ) {
        iVar2 = ReadString(iVar1,buf,0x1000);
        if (iVar2 < 0) break;
        if (iVar2 == 0) goto LAB_1000ff14;
        buf[iVar2] = 0;
        iVar3 = strcmp(buf,"<!--IpAddr1 -->");
        if (iVar3 == 0) {
          iVar2 = ReadString(iVar1,buf,0x1000);
          if (-1 < iVar2) {
            if (iVar2 != 0) {
              websWriteDataNonBlock(param_1,buf,iVar2 + -2);
              websWrite(param_1," value=\"");
                    /* WARNING: Subroutine does not return */
              strlen((char *)(g_pWrData + 0x65));
            }
            goto LAB_1000ff14;
          }
          break;
        }
        websWriteDataNonBlock(param_1,buf,iVar2);
        websWrite(param_1,&DAT_10022d7c);
      }
    }
LAB_100102f8:
    if (iVar1 != 0) {
      httpPlatformClose(iVar1);
    }
  }
  websError(param_1,0x194,"Cannot open URL:%s","/NEW_NetConf.htm");
  return;
LAB_1000ff14:
  iVar2 = ReadString(iVar1,buf,0x1000);
  if (iVar2 < 0) goto LAB_100102f8;
  if (iVar2 == 0) goto LAB_10010000;
  buf[iVar2] = 0;
  iVar3 = strcmp(buf,"<!--NETMASK1 -->");
  if (iVar3 == 0) {
    iVar2 = ReadString(iVar1,buf,0x1000);
    if (-1 < iVar2) {
      if (iVar2 != 0) {
        websWriteDataNonBlock(param_1,buf,iVar2 + -2);
        websWrite(param_1," value=\"");
                    /* WARNING: Subroutine does not return */
        strlen((char *)(g_pWrData + 0x75));
      }
      goto LAB_10010000;
    }
    goto LAB_100102f8;
  }
  websWriteDataNonBlock(param_1,buf,iVar2);
  websWrite(param_1,&DAT_10022d7c);
  goto LAB_1000ff14;
LAB_10010000:
  iVar2 = ReadString(iVar1,buf,0x1000);
  if (iVar2 < 0) goto LAB_100102f8;
  if (iVar2 == 0) goto LAB_100100ec;
  buf[iVar2] = 0;
  iVar3 = strcmp(buf,"<!--GATEWAY1 -->");
  if (iVar3 == 0) {
    iVar2 = ReadString(iVar1,buf,0x1000);
    if (-1 < iVar2) {
      if (iVar2 != 0) {
        websWriteDataNonBlock(param_1,buf,iVar2 + -2);
        websWrite(param_1," value=\"");
                    /* WARNING: Subroutine does not return */
        strlen((char *)(g_pWrData + 0x85));
      }
      goto LAB_100100ec;
    }
    goto LAB_100102f8;
  }
  websWriteDataNonBlock(param_1,buf,iVar2);
  websWrite(param_1,&DAT_10022d7c);
  goto LAB_10010000;
LAB_100100ec:
  iVar2 = ReadString(iVar1,buf,0x1000);
  if (iVar2 < 0) goto LAB_100102f8;
  if (iVar2 == 0) goto LAB_100101d0;
  buf[iVar2] = 0;
  iVar3 = strcmp(buf,"<!--DNS1 -->");
  if (iVar3 == 0) {
    iVar2 = ReadString(iVar1,buf,0x1000);
    if (-1 < iVar2) {
      if (iVar2 != 0) {
        websWriteDataNonBlock(param_1,buf,iVar2 + -2);
        websWrite(param_1," value=\"%d\"/>\n",
                  (uint)*(byte *)(g_pWrData + 0x60) |
                  (uint)*(byte *)(g_pWrData + 0x5f) << 8 |
                  (uint)*(byte *)(g_pWrData + 0x5e) << 0x10 |
                  (uint)*(byte *)(g_pWrData + 0x5d) << 0x18);
      }
      goto LAB_100101d0;
    }
    goto LAB_100102f8;
  }
  websWriteDataNonBlock(param_1,buf,iVar2);
  websWrite(param_1,&DAT_10022d7c);
  goto LAB_100100ec;
LAB_100101d0:
  iVar2 = ReadString(iVar1,buf,0x1000);
  if (-1 < iVar2) {
    if (iVar2 == 0) {
LAB_1001025c:
      Old_Inchoice = Inchoice;
      while( true ) {
        iVar2 = ReadString(iVar1,buf,0x1000);
        if (iVar2 < 0) break;
        if (iVar2 == 0) {
          if (iVar1 != 0) {
            httpPlatformClose(iVar1);
          }
          websDone(param_1,0xc9);
          return;
        }
        iVar3 = 0;
        do {
          iVar3 = websWriteDataNonBlock(param_1,buf + iVar3,iVar2);
          if (iVar3 < 0) goto LAB_100102f8;
          iVar2 = iVar2 - iVar3;
        } while (iVar2 != 0);
        websWrite(param_1,&DAT_10022d7c);
      }
    }
    else {
      buf[iVar2] = 0;
      iVar3 = strcmp(buf,"<!--DNS2 -->");
      if (iVar3 != 0) goto code_r0x100101b0;
      iVar2 = ReadString(iVar1,buf,0x1000);
      if (-1 < iVar2) {
        if (iVar2 != 0) {
          websWriteDataNonBlock(param_1,buf,iVar2 + -2);
          websWrite(param_1," value=\"%d\"/>\n",
                    (uint)*(byte *)(g_pWrData + 100) |
                    (uint)*(byte *)(g_pWrData + 99) << 8 |
                    (uint)*(byte *)(g_pWrData + 0x62) << 0x10 |
                    (uint)*(byte *)(g_pWrData + 0x61) << 0x18);
        }
        goto LAB_1001025c;
      }
    }
  }
  goto LAB_100102f8;
code_r0x100101b0:
  websWriteDataNonBlock(param_1,buf,iVar2);
  websWrite(param_1,&DAT_10022d7c);
  goto LAB_100101d0;
}
----------------------------------------

Function: SecuritySelfHandler

void SecuritySelfHandler(undefined4 param_1)

{
  char cVar1;
  char cVar2;
  undefined uVar3;
  char *__s1;
  char *__s1_00;
  int iVar4;
  
  GetRtuRunInfo(g_SysDev_t);
  __s1 = (char *)websGetVar(param_1,"Username",&DAT_10023fc4);
  __s1_00 = (char *)websGetVar(param_1,"Passwrd",&DAT_10023fc4);
  ws_set_cookie(param_1,"Username",__s1,0,&DAT_10020dec,0);
  printf("%s %s\n",__s1,__s1_00);
  iVar4 = strcmp(__s1,g_SysDev_t);
  if ((iVar4 == 0) && (iVar4 = strcmp(__s1_00,g_SysDev_t + 0x10), iVar4 == 0)) {
    Login_flag = 1;
    websWrite(param_1,
              "<script language=\"javascript\">location.replace(\"/goform/Syspage\");</script>",
              &DAT_10023fc4);
  }
  iVar4 = strcmp(__s1,g_SysDev_t);
  cVar1 = *__s1;
  if ((iVar4 == 0) || (cVar1 == '\0')) {
    cVar2 = *__s1_00;
    if ((cVar1 != '\0') || (uVar3 = 2, cVar2 == '\0')) {
      iVar4 = strcmp(__s1_00,g_SysDev_t + 0x10);
      if ((iVar4 == 0) || (cVar2 == '\0')) {
        uVar3 = Flag_mes;
        if (cVar2 == '\0') {
          if (cVar1 == '\0') {
            uVar3 = 5;
          }
          else {
            uVar3 = 4;
          }
        }
      }
      else {
        uVar3 = 3;
      }
    }
  }
  else {
    uVar3 = 1;
  }
  Flag_mes = uVar3;
  return;
}
----------------------------------------

Function: Loginn

void Loginn(undefined4 param_1)

{
  int iVar1;
  int iVar2;
  int iVar3;
  
  iVar1 = access("/usr/local/webs/CdatcUserInfo",0);
  if (iVar1 != 0) {
    system("mkdir /usr/local/webs");
    websSetUsername("cdatc");
    websSetPassword("111111");
    UpdateRtuRunInfo(gSystemInfo);
  }
  iVar1 = websCompareVar(param_1,"Submit",&DAT_10022bb4);
  if (iVar1 != 0) {
    SecuritySelfHandler(param_1);
  }
  iVar1 = httpPlatformOpen("/Loginn.htm",0);
  if (-1 < iVar1) {
    iVar2 = InitReadString();
    if (-1 < iVar2) {
      while( true ) {
        iVar2 = ReadString(iVar1,buf,0x1000);
        if (iVar2 < 0) goto LAB_10010768;
        if (iVar2 == 0) goto LAB_1001071c;
        buf[iVar2] = 0;
        iVar3 = strcmp(buf,"<!--User_msg -->");
        if (iVar3 == 0) break;
        websWriteDataNonBlock(param_1,buf,iVar2);
        websWrite(param_1,&DAT_10022d7c);
      }
      if (Flag_mes == '\0') {
        websWrite(param_1,&DAT_10022d7c);
      }
      if (Flag_mes == '\x01') {
        websWrite(param_1,&DAT_10022bdc);
      }
      if (Flag_mes == '\x02') {
        websWrite(param_1,&DAT_10022c1c);
      }
      if (Flag_mes == '\x03') {
        websWrite(param_1,&DAT_10022c5c);
      }
      if (Flag_mes == '\x04') {
        websWrite(param_1,&DAT_10022c9c);
      }
      if (Flag_mes == '\x05') {
        websWrite(param_1,&DAT_10022cdc);
      }
      Flag_mes = '\0';
LAB_1001071c:
      while( true ) {
        iVar2 = ReadString(iVar1,buf,0x1000);
        if (iVar2 < 0) break;
        if (iVar2 == 0) {
          if (iVar1 != 0) {
            httpPlatformClose(iVar1);
          }
          websDone(param_1,0xc9);
          return;
        }
        iVar3 = 0;
        do {
          iVar3 = websWriteDataNonBlock(param_1,buf + iVar3,iVar2);
          if (iVar3 < 0) goto LAB_10010768;
          iVar2 = iVar2 - iVar3;
        } while (iVar2 != 0);
        websWrite(param_1,&DAT_10022d7c);
      }
    }
LAB_10010768:
    if (iVar1 != 0) {
      httpPlatformClose(iVar1);
    }
  }
  websError(param_1,0x194,"Cannot open URL:%s","/Loginn.htm");
  return;
}
----------------------------------------

Function: SaveUserCfgtoFile

void SaveUserCfgtoFile(void)

{
  FILE *__stream;
  char acStack_b8 [116];
  
  __stream = fopen(cfgfilepath,"w+");
  sprintf(acStack_b8,"%s.cfg","CdatcGateway");
  fputs("
----------------------------------------

Function: AddOrAltNPortConfig

undefined4 AddOrAltNPortConfig(char *param_1,char *param_2,char *param_3,char *param_4)

{
  bool bVar1;
  FILE *pFVar2;
  int iVar3;
  char *pcVar4;
  char acStack_568 [1024];
  char local_168 [296];
  char acStack_40 [28];
  
  pFVar2 = fopen(param_1,"r+");
  if ((pFVar2 == (FILE *)0x0) && (pFVar2 = fopen(param_1,"w+"), pFVar2 == (FILE *)0x0)) {
    puts("CRETE CONFIG FALID");
  }
  else {
    fseek(pFVar2,0,2);
    ftell(pFVar2);
    memset(acStack_568,0,0x400);
    strcpy(acStack_40,param_2);
    bVar1 = false;
    fseek(pFVar2,0,0);
    while ((iVar3 = feof(pFVar2), iVar3 == 0 &&
           (pcVar4 = fgets(local_168,0x100,pFVar2), pcVar4 != (char *)0x0))) {
      if (bVar1) {
        if (local_168[0] != '#') {
                    /* WARNING: Subroutine does not return */
          strlen(local_168);
        }
        strcat(acStack_568,local_168);
        bVar1 = true;
      }
      else {
        if (local_168[0] == '[') {
                    /* WARNING: Subroutine does not return */
          strlen(acStack_40);
        }
        strcat(acStack_568,local_168);
      }
    }
    if (bVar1) {
      strcat(acStack_568,param_3);
      strcat(acStack_568,"=");
      strcat(acStack_568,param_4);
    }
    else {
      strcat(acStack_568,acStack_40);
      strcat(acStack_568,"\r\n");
      strcat(acStack_568,param_3);
      strcat(acStack_568,"=");
      strcat(acStack_568,param_4);
    }
    strcat(acStack_568,"\r\n");
    remove(param_1);
    fclose(pFVar2);
    pFVar2 = fopen(param_1,"w+");
    if (pFVar2 == (FILE *)0x0) {
      return 2;
    }
    fseek(pFVar2,0,0);
    fputs(acStack_568,pFVar2);
    fclose(pFVar2);
  }
  return 0;
}
----------------------------------------

Function: GetRtuCfgString

/* WARNING: Control flow encountered bad instruction data */

void GetRtuCfgString(char *param_1,char *param_2)

{
  FILE *__stream;
  int *piVar1;
  char *pcVar2;
  undefined in_vs32 [16];
  undefined in_vs33 [16];
  undefined in_vs34 [16];
  undefined in_vs35 [16];
  undefined in_vs36 [16];
  undefined in_vs37 [16];
  undefined in_vs38 [16];
  undefined in_vs39 [16];
  undefined in_vs43 [16];
  undefined in_vs44 [16];
  char acStack_64 [100];
  
  vectorMultiplyHighRoundAndAddSignedHalfWordSaturate(in_vs43,in_vs33,in_vs44);
  vectorMultiplyHighRoundAndAddSignedHalfWordSaturate(in_vs43,in_vs34,in_vs44);
  vectorMultiplyHighRoundAndAddSignedHalfWordSaturate(in_vs43,in_vs36,in_vs44);
  vectorMultiplyHighRoundAndAddSignedHalfWordSaturate(in_vs43,in_vs38,in_vs44);
  vectorMultiplyHighRoundAndAddSignedHalfWordSaturate(in_vs43,in_vs39,in_vs44);
  vectorMultiplyHighRoundAndAddSignedHalfWordSaturate(in_vs43,in_vs32,in_vs44);
  vectorMultiplyHighRoundAndAddSignedHalfWordSaturate(in_vs43,in_vs35,in_vs44);
  vectorMultiplyHighRoundAndAddSignedHalfWordSaturate(in_vs43,in_vs37,in_vs44);
  __stream = fopen(param_1,"r");
  if (__stream == (FILE *)0x0) {
    piVar1 = __errno_location();
    pcVar2 = strerror(*piVar1);
    printf("openfile [%s] error [%s]\n",param_1,pcVar2);
                    /* WARNING: Bad instruction - Truncating control flow here */
    halt_baddata();
  }
  fseek(__stream,0,0);
  strcpy(acStack_64,param_2);
                    /* WARNING: Bad instruction - Truncating control flow here */
  halt_baddata();
}
----------------------------------------

Function: AddOrAltRtuConfig

undefined4 AddOrAltRtuConfig(char *param_1,char *param_2,char *param_3,char *param_4)

{
  bool bVar1;
  FILE *pFVar2;
  int iVar3;
  char *pcVar4;
  char acStack_568 [1024];
  char local_168 [296];
  char acStack_40 [28];
  
  pFVar2 = fopen(param_1,"r+");
  if ((pFVar2 == (FILE *)0x0) && (pFVar2 = fopen(param_1,"w+"), pFVar2 == (FILE *)0x0)) {
    puts("CRETE CONFIG FALID");
  }
  else {
    fseek(pFVar2,0,2);
    ftell(pFVar2);
    memset(acStack_568,0,0x400);
    strcpy(acStack_40,param_2);
    bVar1 = false;
    fseek(pFVar2,0,0);
    while ((iVar3 = feof(pFVar2), iVar3 == 0 &&
           (pcVar4 = fgets(local_168,0x100,pFVar2), pcVar4 != (char *)0x0))) {
      if (bVar1) {
        if (local_168[0] != '#') {
                    /* WARNING: Subroutine does not return */
          strlen(local_168);
        }
        strcat(acStack_568,local_168);
        bVar1 = true;
      }
      else {
        if (local_168[0] == '[') {
                    /* WARNING: Subroutine does not return */
          strlen(acStack_40);
        }
        strcat(acStack_568,local_168);
      }
    }
    if (bVar1) {
      strcat(acStack_568,param_3);
      strcat(acStack_568,"=");
      strcat(acStack_568,param_4);
    }
    else {
      strcat(acStack_568,acStack_40);
      strcat(acStack_568,"\r\n");
      strcat(acStack_568,param_3);
      strcat(acStack_568,"=");
      strcat(acStack_568,param_4);
    }
    strcat(acStack_568,"\r\n");
    remove(param_1);
    fclose(pFVar2);
    pFVar2 = fopen(param_1,"w+");
    if (pFVar2 == (FILE *)0x0) {
      puts("OPEN CONFIG FALID");
      return 2;
    }
    fseek(pFVar2,0,0);
    fputs(acStack_568,pFVar2);
    fclose(pFVar2);
  }
  return 0;
}
----------------------------------------

Function: DeleteRtuCfgField

undefined4 DeleteRtuCfgField(char *param_1)

{
  FILE *pFVar1;
  undefined4 uVar2;
  char *pcVar3;
  char acStack_548 [1024];
  char acStack_148 [304];
  
  pFVar1 = fopen(param_1,"r+");
  if (pFVar1 == (FILE *)0x0) {
    puts("OPEN CONFIG FALID");
    uVar2 = 0;
  }
  else {
    fseek(pFVar1,0,2);
    ftell(pFVar1);
    memset(acStack_548,0,0x400);
    fseek(pFVar1,0,0);
    pcVar3 = fgets(acStack_148,0x100,pFVar1);
    if (pcVar3 != (char *)0x0) {
                    /* WARNING: Subroutine does not return */
      strlen(acStack_148);
    }
    remove(param_1);
    fclose(pFVar1);
    pFVar1 = fopen(param_1,"w+");
    if (pFVar1 == (FILE *)0x0) {
      puts("OPEN CONFIG FALID");
      uVar2 = 2;
    }
    else {
      fseek(pFVar1,0,0);
      fputs(acStack_548,pFVar1);
      fclose(pFVar1);
      uVar2 = 0;
    }
  }
  return uVar2;
}
----------------------------------------

Function: StringSplit_Struct

void StringSplit_Struct(undefined *param_1,char *param_2,char *param_3)

{
  char *pcVar1;
  char *pcVar2;
  undefined uVar3;
  
  if (param_2 != (char *)0x0) {
    pcVar1 = strstr(param_2,param_3);
    if (pcVar1 == (char *)0x0) {
      *param_1 = 0;
      param_1[1] = 0;
      param_1[2] = 0;
      param_1[3] = 0;
    }
    else {
      strncpy(param_1 + 4,param_2,(int)pcVar1 - (int)param_2);
      param_1[((int)pcVar1 - (int)param_2) + 4] = 0;
      pcVar1 = pcVar1 + 1;
      pcVar2 = strstr(pcVar1,param_3);
      if (pcVar2 == (char *)0x0) {
        *param_1 = 0;
        uVar3 = 1;
        param_1[1] = 0;
        param_1[2] = 0;
      }
      else {
        strncpy(param_1 + 0x14,pcVar1,(int)pcVar2 - (int)pcVar1);
        param_1[((int)pcVar2 - (int)pcVar1) + 0x14] = 0;
        pcVar2 = pcVar2 + 1;
        pcVar1 = strstr(pcVar2,param_3);
        if (pcVar1 != (char *)0x0) {
          strncpy(param_1 + 0x24,pcVar2,(int)pcVar1 - (int)pcVar2);
          param_1[((int)pcVar1 - (int)pcVar2) + 0x24] = 0;
          if (pcVar1 + 1 == (char *)0x0) {
            return;
          }
          *param_1 = 0;
          param_1[1] = 0;
          param_1[2] = 0;
          param_1[3] = 3;
          strcpy(param_1 + 0x34,pcVar1 + 1);
          return;
        }
        *param_1 = 0;
        uVar3 = 2;
        param_1[1] = 0;
        param_1[2] = 0;
      }
      param_1[3] = uVar3;
    }
  }
  return;
}
----------------------------------------

Function: GetNetProfileString

undefined4 GetNetProfileString(char *param_1,char *param_2)

{
  bool bVar1;
  FILE *__stream;
  int *piVar2;
  char *pcVar3;
  undefined4 uVar4;
  int iVar5;
  char local_158 [256];
  char acStack_58 [68];
  
  __stream = fopen(param_1,"r");
  if (__stream == (FILE *)0x0) {
    piVar2 = __errno_location();
    pcVar3 = strerror(*piVar2);
    printf("openfile [%s] error [%s]\n",param_1,pcVar3);
    uVar4 = 0xffffffff;
  }
  else {
    fseek(__stream,0,0);
    memset(acStack_58,0,0x40);
    strcpy(acStack_58,param_2);
    bVar1 = false;
    while ((iVar5 = feof(__stream), iVar5 == 0 &&
           (pcVar3 = fgets(local_158,0x100,__stream), pcVar3 != (char *)0x0))) {
      if (bVar1) {
        bVar1 = true;
      }
      else if ((local_158[0] != '#') && (local_158[0] != '[')) {
                    /* WARNING: Subroutine does not return */
        strlen(acStack_58);
      }
    }
    fclose(__stream);
    uVar4 = 0;
  }
  return uVar4;
}
----------------------------------------

Function: AddOrAltNetConfig

undefined4 AddOrAltNetConfig(char *param_1,char *param_2,char *param_3)

{
  FILE *pFVar1;
  char *pcVar2;
  char acStack_558 [1024];
  char acStack_158 [308];
  
  pFVar1 = fopen(param_1,"r+");
  if (pFVar1 == (FILE *)0x0) {
    puts("OPEN CONFIG FALID");
  }
  else {
    fseek(pFVar1,0,2);
    ftell(pFVar1);
    memset(acStack_558,0,0x400);
    fseek(pFVar1,0,0);
    pcVar2 = fgets(acStack_158,0x100,pFVar1);
    if (pcVar2 != (char *)0x0) {
                    /* WARNING: Subroutine does not return */
      strlen(acStack_158);
    }
    strcat(acStack_558,param_2);
    strcat(acStack_558,"=");
    strcat(acStack_558,param_3);
    strcat(acStack_558,"\n");
    remove(param_1);
    fclose(pFVar1);
    pFVar1 = fopen(param_1,"w+");
    if (pFVar1 == (FILE *)0x0) {
      puts("OPEN CONFIG FALID");
      return 2;
    }
    fseek(pFVar1,0,0);
    fputs(acStack_558,pFVar1);
    fclose(pFVar1);
  }
  return 0;
}
----------------------------------------

Function: Modify_Ip

/* WARNING: Control flow encountered bad instruction data */

void Modify_Ip(char *param_1)

{
  int iVar1;
  undefined in_vs33 [16];
  undefined in_vs39 [16];
  undefined in_vs40 [16];
  undefined in_vs41 [16];
  undefined in_vs44 [16];
  char acStack_48 [72];
  
  vectorMultiplyHighRoundAndAddSignedHalfWordSaturate(in_vs33,in_vs39,in_vs44);
  vectorMultiplyHighRoundAndAddSignedHalfWordSaturate(in_vs33,in_vs40,in_vs44);
  vectorMultiplyHighRoundAndAddSignedHalfWordSaturate(in_vs33,in_vs41,in_vs44);
  memset(acStack_48,0,0x20);
  iVar1 = socket(2,1,0);
  if (iVar1 == -1) {
    perror("Not create network  socket connection\n ");
                    /* WARNING: Bad instruction - Truncating control flow here */
    halt_baddata();
  }
  strncpy(acStack_48,param_1,0x10);
                    /* WARNING: Bad instruction - Truncating control flow here */
  halt_baddata();
}
----------------------------------------

Function: Modify_Submask

undefined4 Modify_Submask(char *param_1,undefined4 param_2,char *param_3)

{
  int __fd;
  int iVar1;
  char acStack_38 [16];
  undefined2 local_28;
  undefined auStack_24 [24];
  
  __fd = socket(2,1,0);
  if (__fd == -1) {
    perror("Not create network socket connect\n");
  }
  else {
    memset(acStack_38,0,0x20);
    strncpy(acStack_38,param_1,0xf);
    local_28 = 2;
    inet_pton(2,param_3,auStack_24);
    iVar1 = ioctl(__fd,0x891c,acStack_38);
    if (-1 < iVar1) {
      close(__fd);
      return 0;
    }
    puts("sock_netmask ioctl error");
  }
  return 0xffffffff;
}
----------------------------------------

Function: Modify_Gateway

int Modify_Gateway(undefined4 param_1,char *param_2)

{
  int iVar1;
  char acStack_88 [128];
  
  memset(acStack_88,0,0x80);
  iVar1 = 0;
  if (*param_2 != '\0') {
    sprintf(acStack_88,"/sbin/route del default dev %s",param_1);
    system("/sbin/route del default dev eth0");
    memset(acStack_88,0,0x80);
    sprintf(acStack_88,"/sbin/route add default gw %s dev %s",param_2,param_1);
    iVar1 = system(acStack_88);
  }
  return iVar1;
}
----------------------------------------

Function: detect_process

int detect_process(undefined4 param_1)

{
  FILE *__stream;
  char *__nptr;
  int iVar1;
  char acStack_288 [512];
  char acStack_88 [128];
  
  memset(acStack_88,0,0x80);
  sprintf(acStack_88,"ps -ef|grep %s",param_1);
  __stream = popen(acStack_88,"r");
  if (__stream != (FILE *)0x0) {
    memset(acStack_288,0,0x200);
    fgets(acStack_288,0x200,__stream);
    __nptr = strtok(acStack_288," ");
    pclose(__stream);
    if (((__nptr != (char *)0x0) && (*__nptr != '\0')) && (iVar1 = atoi(__nptr), iVar1 != 0)) {
      iVar1 = kill(iVar1,0);
      return iVar1;
    }
  }
  return 1;
}
----------------------------------------

Function: a16toi

void a16toi(char *param_1)

{
                    /* WARNING: Subroutine does not return */
  strlen(param_1);
}
----------------------------------------

Function: bstrdup

void bstrdup(char *param_1)

{
  if (param_1 == (char *)0x0) {
    param_1 = "";
  }
                    /* WARNING: Subroutine does not return */
  strlen(param_1);
}
----------------------------------------

Function: websCgiHandler

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */

undefined4 websCgiHandler(int param_1)

{
  char *pcVar1;
  char *pcVar2;
  undefined4 uVar3;
  int iVar4;
  char **ppcVar5;
  int iVar6;
  int iVar7;
  int iVar8;
  int iVar9;
  char *in_r8;
  char *in_r9;
  int iVar10;
  int *piVar11;
  stat asStack_238 [2];
  char cStack_138;
  char acStack_137 [255];
  char *local_38 [4];
  
  _DAT_100b3f48 = _DAT_100b3f48 + 1;
  strncpy(&cStack_138,in_r8,0xfe);
  pcVar1 = strchr(acStack_137,0x2f);
  if (pcVar1 == (char *)0x0) {
    websError(param_1,200,"Missing CGI name");
  }
  else {
    pcVar1 = pcVar1 + 1;
    pcVar2 = strchr(pcVar1,0x2f);
    if (pcVar2 != (char *)0x0) {
      *pcVar2 = '\0';
    }
    uVar3 = websGetDefaultDir();
    fmtAlloc(local_38,0xfe,"%s/%s/%s",uVar3,"cgi-bin",pcVar1);
    iVar4 = stat(local_38[0],asStack_238);
    if ((iVar4 == 0) && ((asStack_238[0].st_mode & 0x8000) != 0)) {
      iVar4 = access(local_38[0],1);
      if (iVar4 == 0) {
        getcwd((char *)asStack_238,0xfe);
        pcVar2 = strrchr(local_38[0],0x2f);
        if (pcVar2 != (char *)0x0) {
          *pcVar2 = '\0';
          chdir(local_38[0]);
          *pcVar2 = '/';
        }
        ppcVar5 = (char **)balloc(0x28);
        *ppcVar5 = local_38[0];
        pcVar2 = strchr(in_r9,0x3d);
        if (pcVar2 != (char *)0x0) {
          ppcVar5[1] = (char *)0x0;
          iVar6 = balloc(0x100);
          fmtAlloc(iVar6,0xfe,"%s=%s","PATH_TRANSLATED",local_38[0]);
          fmtAlloc(iVar6 + 4,0xfe,"%s=%s/%s","SCRIPT_NAME","cgi-bin",pcVar1);
          fmtAlloc(iVar6 + 8,0xfe,"%s=%s","REMOTE_USER",*(undefined4 *)(param_1 + 0xd4));
          iVar10 = 4;
          fmtAlloc(iVar6 + 0xc,0xfe,"%s=%s","AUTH_TYPE",*(undefined4 *)(param_1 + 0xcc));
          iVar7 = symFirst(*(undefined4 *)(param_1 + 0x20));
          iVar4 = 0x40;
          while (iVar7 != 0) {
            iVar9 = iVar4;
            if ((*(char *)(iVar7 + 0x1e) != '\0') && (*(int *)(iVar7 + 0x1a) == 10)) {
              pcVar1 = *(char **)(iVar7 + 4);
              iVar8 = strcmp(pcVar1,"REMOTE_HOST");
              if ((iVar8 != 0) && (iVar8 = strcmp(pcVar1,"HTTP_AUTHORIZATION"), iVar8 != 0)) {
                iVar8 = iVar10 * 4;
                iVar10 = iVar10 + 1;
                fmtAlloc(iVar6 + iVar8,0xfe,"%s=%s",pcVar1,*(undefined4 *)(iVar7 + 0x12));
                if (iVar4 <= iVar10) {
                  iVar9 = iVar4 << 1;
                  iVar6 = brealloc(iVar6,iVar4 << 3);
                }
              }
            }
            iVar7 = symNext(*(undefined4 *)(param_1 + 0x20));
            iVar4 = iVar9;
          }
          *(undefined4 *)(iVar6 + iVar10 * 4) = 0;
          if (*(int *)(param_1 + 0x114) == 0) {
            uVar3 = websGetCgiCommName();
            *(undefined4 *)(param_1 + 0x114) = uVar3;
          }
          iVar10 = *(int *)(param_1 + 0x114);
          iVar4 = websGetCgiCommName();
          iVar7 = websLaunchCgiProc(local_38[0],ppcVar5,iVar6,iVar10,iVar4);
          if (iVar7 == -1) {
            websError(param_1,200,"failed to spawn CGI task");
            piVar11 = (int *)(iVar6 + -4);
            while (piVar11 = piVar11 + 1, *piVar11 != 0) {
              bfreeSafe();
            }
            bfreeSafe(local_38[0]);
            bfreeSafe(ppcVar5);
            bfreeSafe(iVar6);
            bfreeSafe(iVar4);
          }
          else {
            iVar9 = hAllocEntry(&cgiList,&cgiMax,0x20);
            piVar11 = *(int **)(cgiList + iVar9 * 4);
            piVar11[3] = (int)local_38[0];
            piVar11[6] = iVar7;
            piVar11[1] = iVar10;
            piVar11[2] = iVar4;
            piVar11[4] = (int)ppcVar5;
            piVar11[5] = iVar6;
            *piVar11 = param_1;
            piVar11[7] = 0;
            websTimeoutCancel(param_1);
          }
          chdir((char *)asStack_238);
          return 1;
        }
                    /* WARNING: Subroutine does not return */
        strlen(in_r9);
      }
      uVar3 = 200;
      pcVar1 = "CGI process file is not executable";
    }
    else {
      uVar3 = 0x194;
      pcVar1 = "CGI process file does not exist";
    }
    websError(param_1,uVar3,pcVar1);
    bfree(local_38[0]);
  }
  return 1;
}
----------------------------------------

Function: websValidateUrl

undefined4 websValidateUrl(undefined4 param_1,undefined4 param_2)

{
  char *pcVar1;
  
  pcVar1 = (char *)websGetRequestDir();
  if ((pcVar1 != (char *)0x0) && (*pcVar1 != '\0')) {
    pcVar1 = (char *)bstrdup(param_2);
                    /* WARNING: Subroutine does not return */
    strlen(pcVar1);
  }
  return 0xffffffff;
}
----------------------------------------

Function: websDefaultHandler

undefined4 websDefaultHandler(undefined4 param_1)

{
  int iVar1;
  char *__s;
  undefined4 in_r8;
  
  websGetRequestFlags();
  iVar1 = websValidateUrl(param_1,in_r8);
  if (iVar1 < 0) {
    websError(param_1,500,"Invalid URL");
    return 1;
  }
  __s = (char *)websGetRequestLpath(param_1);
                    /* WARNING: Subroutine does not return */
  strlen(__s);
}
----------------------------------------

Function: websFormHandler

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */

undefined4 websFormHandler(undefined4 param_1)

{
  char *pcVar1;
  char *pcVar2;
  int iVar3;
  char *in_r8;
  undefined4 in_r9;
  char cStack_118;
  char acStack_117 [267];
  
  _DAT_100b3f44 = _DAT_100b3f44 + 1;
  strncpy(&cStack_118,in_r8,0xfe);
  pcVar1 = strchr(acStack_117,0x2f);
  if (pcVar1 == (char *)0x0) {
    websError(param_1,200,"Missing form name");
  }
  else {
    pcVar1 = pcVar1 + 1;
    pcVar2 = strchr(pcVar1,0x2f);
    if (pcVar2 != (char *)0x0) {
      *pcVar2 = '\0';
    }
    iVar3 = symLookup(formSymtab,pcVar1);
    if (iVar3 == 0) {
      websError(param_1,0x194,"Form %s is not defined",pcVar1);
    }
    else if (*(code **)(iVar3 + 0x12) != (code *)0x0) {
      (**(code **)(iVar3 + 0x12))(param_1,pcVar1,in_r9);
    }
  }
  return 1;
}
----------------------------------------

Function: websPublishHandler

void websPublishHandler(undefined4 param_1,char *param_2)

{
                    /* WARNING: Subroutine does not return */
  strlen(param_2);
}
----------------------------------------

Function: websUrlHandlerSort

int websUrlHandlerSort(int param_1,int param_2)

{
  int iVar1;
  
  if (((*(uint *)(param_1 + 0x14) & 1) != 0) || ((*(uint *)(param_2 + 0x14) & 2) != 0)) {
    return -1;
  }
  if ((*(uint *)(param_2 + 0x14) & 1) != 0) {
    return 1;
  }
  if ((*(uint *)(param_1 + 0x14) & 2) == 0) {
    iVar1 = strcmp(*(char **)(param_1 + 8),*(char **)(param_2 + 8));
    if (iVar1 == 0) {
      if (*(int *)(param_1 + 0xc) < *(int *)(param_2 + 0xc)) {
        return 1;
      }
      if (*(int *)(param_2 + 0xc) < *(int *)(param_1 + 0xc)) {
        return -1;
      }
    }
    return -iVar1;
  }
  return 1;
}
----------------------------------------

Function: websUrlHandlerDefine

undefined4 websUrlHandlerDefine(undefined4 param_1)

{
  char *__s;
  void *__s_00;
  
  websUrlHandler = brealloc(websUrlHandler,(websUrlHandlerMax + 1) * 0x18);
  if (websUrlHandler != 0) {
    __s_00 = (void *)(websUrlHandler + websUrlHandlerMax * 0x18);
    websUrlHandlerMax = websUrlHandlerMax + 1;
    memset(__s_00,0,0x18);
    __s = (char *)bstrdup(param_1);
    *(char **)((int)__s_00 + 8) = __s;
                    /* WARNING: Subroutine does not return */
    strlen(__s);
  }
  return 0xffffffff;
}
----------------------------------------

Function: websGetPublishDir

int websGetPublishDir(char *param_1,char **param_2)

{
  int iVar1;
  int iVar2;
  char *__s1;
  int iVar3;
  int *piVar4;
  
  iVar1 = websUrlHandlerMax;
  iVar3 = 0;
  piVar4 = websUrlHandler;
  while( true ) {
    if (iVar1 <= iVar3) {
      return 0;
    }
    __s1 = (char *)piVar4[2];
    if (((*__s1 != '\0') && (*piVar4 != 0)) && (iVar2 = strncmp(__s1,param_1,piVar4[3]), iVar2 == 0)
       ) break;
    iVar3 = iVar3 + 1;
    piVar4 = piVar4 + 6;
  }
  if (param_2 != (char **)0x0) {
    *param_2 = __s1;
  }
  return piVar4[1];
}
----------------------------------------

Function: websUrlHandlerRequest

undefined4 websUrlHandlerRequest(int param_1)

{
  bool bVar1;
  undefined4 uVar2;
  char *pcVar3;
  int iVar4;
  int iVar5;
  int iVar6;
  int iVar7;
  int iVar8;
  
  socketDeleteHandler(*(undefined4 *)(param_1 + 0xf0));
  *(undefined4 *)(param_1 + 0xfc) = 0x10;
  DAT_100b3f4c = DAT_100b3f4c + 1;
  uVar2 = websGetDefaultDir();
  websSetRequestPath(param_1,uVar2,0);
  websCondenseMultipleChars_constprop_1(*(undefined4 *)(param_1 + 0xb4));
  websCondenseMultipleChars_constprop_1(*(undefined4 *)(param_1 + 0xb8));
  if ((**(char **)(param_1 + 0xb4) == '/') &&
     (pcVar3 = strchr(*(char **)(param_1 + 0xb4),0x5c), pcVar3 == (char *)0x0)) {
    bVar1 = true;
    for (iVar7 = 0; iVar5 = websUrlHandler, iVar7 < websUrlHandlerMax; iVar7 = iVar7 + 1) {
      iVar6 = iVar7 * 0x18;
      iVar8 = websUrlHandler + iVar6;
      if ((*(int *)(websUrlHandler + iVar6) != 0) &&
         (iVar4 = strncmp(*(char **)(iVar8 + 8),*(char **)(param_1 + 0xb4),*(size_t *)(iVar8 + 0xc))
         , iVar4 == 0)) {
        if (bVar1) {
          websSetEnv(param_1);
        }
        iVar5 = (**(code **)(iVar5 + iVar6))
                          (param_1,*(undefined4 *)(iVar8 + 8),*(undefined4 *)(iVar8 + 4),
                           *(undefined4 *)(iVar8 + 0x10),*(undefined4 *)(param_1 + 0xb8),
                           *(undefined4 *)(param_1 + 0xb4),*(undefined4 *)(param_1 + 0xc4));
        if (iVar5 != 0) {
          return 1;
        }
        iVar5 = websValid(param_1);
        if (iVar5 == 0) {
          trace(0,"webs: handler %s called websDone, but didn\'t return 1\n",
                *(undefined4 *)(iVar8 + 8));
          return 1;
        }
        bVar1 = false;
      }
    }
    uVar2 = 200;
    pcVar3 = "No handler for this URL";
  }
  else {
    uVar2 = 400;
    pcVar3 = "Bad request";
  }
  websError(param_1,uVar2,pcVar3);
  return 0;
}
----------------------------------------

Function: put_string

/* WARNING: Control flow encountered bad instruction data */

void put_string(undefined4 param_1,char *param_2,int param_3,int param_4,int param_5,uint param_6)

{
  int iVar1;
  
  if (param_3 < 0) {
                    /* WARNING: Subroutine does not return */
    strlen(param_2);
  }
  if (-1 < param_5) {
                    /* WARNING: Bad instruction - Truncating control flow here */
    halt_baddata();
  }
  if ((param_3 < param_4) && (iVar1 = param_3, (param_6 & 1) == 0)) {
    do {
      iVar1 = iVar1 + 1;
      put_char(param_1,0x20);
    } while (iVar1 != param_4);
  }
  for (iVar1 = 0; iVar1 < param_3; iVar1 = iVar1 + 1) {
    put_char(param_1,param_2[iVar1]);
  }
  if ((param_3 < param_4) && ((param_6 & 1) != 0)) {
    do {
      param_3 = param_3 + 1;
      put_char(param_1,0x20);
    } while (param_3 != param_4);
  }
  return;
}
----------------------------------------

Function: dsnprintf

/* WARNING: Control flow encountered bad instruction data */

void dsnprintf(void)

{
                    /* WARNING: Bad instruction - Truncating control flow here */
  halt_baddata();
}
----------------------------------------

Function: dirname

char * dirname(char *__path)

{
  char *pcVar1;
  char *in_r4;
  int in_r5;
  size_t __n;
  
  pcVar1 = strrchr(in_r4,0x2f);
  if (pcVar1 != (char *)0x0) {
    if ((pcVar1[1] != '\0') || (pcVar1 != in_r4)) {
      __n = (int)pcVar1 - (int)in_r4;
      if ((int)__n < in_r5) {
        strncpy(__path,in_r4,__n);
        __path[__n] = '\0';
        return __path;
      }
      strncpy(__path,in_r4,4);
      __path[in_r5 + -1] = '\0';
      return __path;
    }
    strncpy(__path,".",4);
  }
  strcpy(__path,".");
  return __path;
}
----------------------------------------

Function: fmtAlloc

void fmtAlloc(undefined4 *param_1,undefined4 param_2,undefined4 param_3,undefined4 param_4,
             undefined4 param_5,undefined4 param_6,undefined4 param_7,undefined4 param_8)

{
  undefined4 ***local_20 [3];
  undefined4 local_14;
  undefined4 local_10;
  undefined4 local_c;
  undefined4 local_8;
  undefined4 local_4;
  
  *param_1 = 0;
  local_20[0] = local_20;
  local_14 = param_4;
  local_10 = param_5;
  local_c = param_6;
  local_8 = param_7;
  local_4 = param_8;
  dsnprintf();
  return;
}
----------------------------------------

Function: fmtStatic

undefined4 fmtStatic(undefined4 param_1,int param_2)

{
  undefined4 uVar1;
  
  if (param_2 < 1) {
    uVar1 = 0xffffffff;
  }
  else {
    uVar1 = dsnprintf();
  }
  return uVar1;
}
----------------------------------------

Function: fmtRealloc

void fmtRealloc(undefined4 *param_1,undefined4 param_2,int param_3,undefined4 param_4,
               undefined4 param_5,undefined4 param_6,undefined4 param_7,undefined4 param_8)

{
  undefined local_28;
  undefined local_27;
  undefined *local_24;
  undefined *local_20;
  undefined4 local_18;
  undefined4 local_14;
  undefined4 local_10;
  undefined4 local_c;
  
  if (param_3 == -1) {
    *param_1 = 0;
  }
  local_28 = 4;
  local_27 = 0;
  local_24 = &stack0x00000008;
  local_20 = &local_28;
  local_18 = param_5;
  local_14 = param_6;
  local_10 = param_7;
  local_c = param_8;
  dsnprintf(param_1,param_2,param_4,local_20,param_3);
  return;
}
----------------------------------------

Function: fmtValloc

void fmtValloc(undefined4 *param_1)

{
  *param_1 = 0;
  dsnprintf();
  return;
}
----------------------------------------

Function: websRomOpen

/* WARNING: Control flow encountered bad instruction data */

void websRomOpen(void)

{
  undefined in_vs32 [16];
  undefined in_vs33 [16];
  undefined in_vs34 [16];
  undefined in_vs35 [16];
  undefined in_vs36 [16];
  undefined in_vs37 [16];
  undefined in_vs43 [16];
  undefined in_vs44 [16];
  char acStack_258 [600];
  
  vectorMultiplyHighRoundAndAddSignedHalfWordSaturate(in_vs43,in_vs33,in_vs44);
  vectorMultiplyHighRoundAndAddSignedHalfWordSaturate(in_vs43,in_vs34,in_vs44);
  vectorMultiplyHighRoundAndAddSignedHalfWordSaturate(in_vs43,in_vs35,in_vs44);
  vectorMultiplyHighRoundAndAddSignedHalfWordSaturate(in_vs43,in_vs36,in_vs44);
  vectorMultiplyHighRoundAndAddSignedHalfWordSaturate(in_vs43,in_vs37,in_vs44);
  vectorMultiplyHighRoundAndAddSignedHalfWordSaturate(in_vs43,in_vs32,in_vs44);
  romTab = symOpen(0x40);
  if (websRomPageIndex != (undefined *)0x0) {
    strncpy(acStack_258,websRomPageIndex,0x200);
                    /* WARNING: Subroutine does not return */
    strlen(acStack_258);
  }
                    /* WARNING: Bad instruction - Truncating control flow here */
  halt_baddata();
}
----------------------------------------

Function: socketAlloc

int socketAlloc(char *param_1,undefined4 param_2,undefined4 param_3,uint param_4)

{
  int iVar1;
  char *__dest;
  
  iVar1 = hAllocEntry(&socketList,&socketMax,0xcc);
  if (iVar1 < 0) {
    iVar1 = -1;
  }
  else {
    __dest = *(char **)(socketList + iVar1 * 4);
    *(int *)(__dest + 0xa4) = iVar1;
    *(undefined4 *)(__dest + 0x94) = param_3;
    *(undefined4 *)(__dest + 0xa8) = param_2;
    *(undefined4 *)(__dest + 0xb4) = 0xffffffff;
    *(undefined4 *)(__dest + 0xc4) = 0xffffffff;
    if (param_1 != (char *)0x0) {
      strncpy(__dest,param_1,0x40);
    }
    *(uint *)(__dest + 0xac) = param_4 & 0x9a4;
    if ((param_4 & 0x800) == 0) {
      ringqOpen(__dest + 0x40,0x400,0x400);
      ringqOpen(__dest + 0x5c,0x401,0x401);
    }
    else {
      memset(__dest + 0x40,0,0x1c);
      memset(__dest + 0x5c,0,0x1c);
    }
    ringqOpen(__dest + 0x78,0x400,0xffffffff);
  }
  return iVar1;
}
----------------------------------------

Function: socketWriteString

void socketWriteString(undefined4 param_1,char *param_2)

{
                    /* WARNING: Subroutine does not return */
  strlen(param_2);
}
----------------------------------------

Function: websSetPassword

void websSetPassword(char *param_1)

{
  strncpy(websPassword,param_1,0x20);
  return;
}
----------------------------------------

Function: websSetUsername

void websSetUsername(char *param_1)

{
  strncpy(websUsername,param_1,0x20);
  return;
}
----------------------------------------

Function: symLookup

int symLookup(int param_1,char *param_2)

{
  char cVar1;
  int iVar2;
  int iVar3;
  int *piVar4;
  
  iVar3 = *(int *)(sym + param_1 * 4);
  if ((iVar3 != 0) && (param_2 != (char *)0x0)) {
    cVar1 = *param_2;
    if (cVar1 == '\0') {
      return 0;
    }
    iVar2 = hashIndex_isra_0(iVar3 + 4);
    for (piVar4 = *(int **)(*(int *)(iVar3 + 8) + iVar2 * 4); piVar4 != (int *)0x0;
        piVar4 = (int *)*piVar4) {
      if ((*(char *)piVar4[1] == cVar1) && (iVar3 = strcmp((char *)piVar4[1],param_2), iVar3 == 0))
      {
        return (int)piVar4;
      }
    }
  }
  return 0;
}
----------------------------------------

Function: symEnter

int * symEnter(int param_1,char *param_2,undefined2 *param_3,int param_4)

{
  char cVar1;
  undefined2 uVar2;
  undefined2 uVar3;
  undefined2 uVar4;
  undefined2 uVar5;
  int iVar6;
  undefined4 *puVar7;
  int iVar8;
  int *piVar9;
  undefined auStack_30 [16];
  
  iVar8 = *(int *)(sym + param_1 * 4);
  iVar6 = hashIndex_isra_0(iVar8 + 4);
  piVar9 = *(int **)(*(int *)(iVar8 + 8) + iVar6 * 4);
  if (piVar9 == (int *)0x0) {
    puVar7 = (undefined4 *)balloc(0x24);
    if (puVar7 != (undefined4 *)0x0) {
      *(undefined4 **)(*(int *)(iVar8 + 8) + iVar6 * 4) = puVar7;
      iVar6 = hashIndex_isra_0(iVar8 + 4,param_2);
      uVar2 = param_3[1];
      uVar3 = param_3[2];
      *(undefined4 **)(*(int *)(iVar8 + 8) + iVar6 * 4) = puVar7;
      uVar4 = param_3[3];
      uVar5 = *param_3;
      *(undefined2 *)(puVar7 + 5) = uVar2;
      *(undefined2 *)((int)puVar7 + 0x16) = uVar3;
      uVar2 = param_3[4];
      uVar3 = param_3[5];
      *(undefined2 *)(puVar7 + 6) = uVar4;
      uVar4 = param_3[6];
      *(undefined2 *)((int)puVar7 + 0x12) = uVar5;
      *(undefined2 *)((int)puVar7 + 0x1a) = uVar2;
      *(undefined2 *)(puVar7 + 7) = uVar3;
      *(undefined2 *)((int)puVar7 + 0x1e) = uVar4;
      *puVar7 = 0;
      puVar7[8] = param_4;
                    /* WARNING: Subroutine does not return */
      valueString(auStack_30,param_2,1);
    }
  }
  else {
    cVar1 = *param_2;
    do {
      if ((*(char *)piVar9[1] == cVar1) && (iVar6 = strcmp((char *)piVar9[1],param_2), iVar6 == 0))
      {
        if (*(char *)((int)piVar9 + 0x1e) != '\0') {
          valueFree((int)piVar9 + 0x12);
        }
        uVar2 = param_3[2];
        uVar3 = param_3[3];
        uVar4 = *param_3;
        *(undefined2 *)(piVar9 + 5) = param_3[1];
        *(undefined2 *)((int)piVar9 + 0x16) = uVar2;
        *(undefined2 *)(piVar9 + 6) = uVar3;
        uVar2 = param_3[4];
        uVar3 = param_3[5];
        uVar5 = param_3[6];
        *(undefined2 *)((int)piVar9 + 0x12) = uVar4;
        *(undefined2 *)((int)piVar9 + 0x1a) = uVar2;
        *(undefined2 *)(piVar9 + 7) = uVar3;
        *(undefined2 *)((int)piVar9 + 0x1e) = uVar5;
        piVar9[8] = param_4;
        return piVar9;
      }
      piVar9 = (int *)*piVar9;
    } while (piVar9 != (int *)0x0);
    iVar6 = balloc(0x24);
    if (iVar6 != 0) {
                    /* WARNING: Subroutine does not return */
      valueString(auStack_30,param_2,1);
    }
  }
  return (int *)0x0;
}
----------------------------------------

Function: symDelete

undefined4 symDelete(int param_1,char *param_2)

{
  char cVar1;
  int iVar2;
  int iVar3;
  int *piVar4;
  int *piVar5;
  int iVar6;
  int *piVar7;
  
  iVar6 = *(int *)(sym + param_1 * 4);
  iVar2 = hashIndex_isra_0(iVar6 + 4);
  iVar6 = *(int *)(iVar6 + 8);
  piVar7 = *(int **)(iVar6 + iVar2 * 4);
  if (piVar7 != (int *)0x0) {
    cVar1 = *param_2;
    piVar5 = (int *)0x0;
    do {
      if ((*(char *)piVar7[1] == cVar1) && (iVar3 = strcmp((char *)piVar7[1],param_2), iVar3 == 0))
      {
        if (piVar5 == (int *)0x0) {
          *(int *)(iVar6 + iVar2 * 4) = *piVar7;
        }
        else {
          *piVar5 = *piVar7;
        }
        valueFree(piVar7 + 1);
        valueFree((int)piVar7 + 0x12);
        bfree(piVar7);
        return 0;
      }
      piVar4 = (int *)*piVar7;
      piVar5 = piVar7;
      piVar7 = piVar4;
    } while (piVar4 != (int *)0x0);
  }
  return 0xffffffff;
}
----------------------------------------

Function: extractUploadedFileContent

/* WARNING: Control flow encountered bad instruction data */

undefined4 extractUploadedFileContent(int param_1)

{
  void *__dest;
  char *pcVar1;
  char *pcVar2;
  char *__haystack;
  
  pcVar1 = *(char **)(param_1 + 0xec);
  if (*(int *)(param_1 + 0xe0) == 0) {
    if (*(char **)(param_1 + 0xec) != (char *)0x0) {
      pcVar1 = *(char **)(param_1 + 0xc4);
      if (pcVar1 != (char *)0x0) {
        if (*pcVar1 == '\0') {
                    /* WARNING: Subroutine does not return */
          strlen(pcVar1);
        }
                    /* WARNING: Subroutine does not return */
        strlen(pcVar1);
      }
      __dest = (void *)balloc(*(int *)(param_1 + 0x110) + 1);
      *(void **)(param_1 + 0xc4) = __dest;
      if (__dest != (void *)0x0) {
        memcpy(__dest,*(void **)(param_1 + 0xec),*(size_t *)(param_1 + 0x110));
        *(undefined *)(*(int *)(param_1 + 0xc4) + *(int *)(param_1 + 0x110)) = 0;
      }
    }
  }
  else {
    while (((__haystack = pcVar1, __haystack != (char *)0x0 &&
            (pcVar1 = strstr(__haystack,*(char **)(param_1 + 0xe0)), pcVar1 != (char *)0x0)) &&
           (pcVar1 = strchr(pcVar1,10), pcVar1 != (char *)0x0))) {
      pcVar1 = pcVar1 + 1;
      pcVar2 = strstr(pcVar1,"Content-Disposition");
      if ((pcVar2 != (char *)0x0) &&
         (pcVar2 = strchr(pcVar1,10), pcVar1 = __haystack, pcVar2 != (char *)0x0)) {
                    /* WARNING: Bad instruction - Truncating control flow here */
        halt_baddata();
      }
    }
  }
  return 0;
}
----------------------------------------

Function: traceHandler

void traceHandler(int param_1,char *param_2)

{
  if (3 < param_1) {
    return;
  }
                    /* WARNING: Subroutine does not return */
  strlen(param_2);
}
----------------------------------------

Function: websSafeUrl

undefined4 websSafeUrl(char *param_1)

{
  char *pcVar1;
  char *__s;
  
  pcVar1 = param_1;
  if (param_1 != (char *)0x0) {
    while (pcVar1 = strchr(pcVar1,0x3c), __s = param_1, pcVar1 != (char *)0x0) {
      pcVar1 = pcVar1 + 1;
    }
    while (pcVar1 = strchr(__s,0x3e), pcVar1 != (char *)0x0) {
      __s = pcVar1 + 1;
    }
                    /* WARNING: Subroutine does not return */
    strlen(param_1);
  }
  return 0;
}
----------------------------------------

Function: websCompareVar

/* WARNING: Control flow encountered bad instruction data */

void websCompareVar(undefined4 param_1,undefined4 param_2,char *param_3)

{
  char *__s2;
  
  __s2 = (char *)websGetVar(param_1,param_2," __UNDEF__ ");
  strcmp(param_3,__s2);
                    /* WARNING: Bad instruction - Truncating control flow here */
  halt_baddata();
}
----------------------------------------

Function: websWrite

undefined4
websWrite(undefined4 param_1,undefined4 param_2,undefined4 param_3,undefined4 param_4,
         undefined4 param_5,undefined4 param_6,undefined4 param_7,undefined4 param_8)

{
  int iVar1;
  undefined local_38;
  undefined local_37;
  undefined *local_34;
  undefined4 ***local_30;
  char *local_2c;
  undefined4 local_28;
  undefined4 local_24;
  undefined4 local_20;
  undefined4 local_1c;
  undefined4 local_18;
  undefined4 local_14;
  
  local_38 = 2;
  local_2c = (char *)0x0;
  local_37 = 0;
  local_34 = &stack0x00000008;
  local_30 = &local_30;
  local_28 = param_3;
  local_24 = param_4;
  local_20 = param_5;
  local_1c = param_6;
  local_18 = param_7;
  local_14 = param_8;
  iVar1 = fmtValloc(&local_2c,1000,param_2,&local_38);
  if (999 < iVar1) {
    trace(0,"webs: websWrite lost data, buffer overflow\n");
  }
  if (local_2c != (char *)0x0) {
                    /* WARNING: Subroutine does not return */
    strlen(local_2c);
  }
  return 0;
}
----------------------------------------

Function: websSetEnv

void websSetEnv(int param_1)

{
  int iVar1;
  void *__dest;
  char *pcVar2;
  char *pcVar3;
  undefined auStack_38 [8];
  undefined4 local_30;
  char *local_2c [4];
  
  websSetVar(param_1,"QUERY_STRING",*(undefined4 *)(param_1 + 0xc4));
  websSetVar(param_1,"GATEWAY_INTERFACE","CGI/1.1");
  websSetVar(param_1,"SERVER_HOST",websHost);
  websSetVar(param_1,"SERVER_NAME",websHost);
  websSetVar(param_1,"SERVER_URL",websHostUrl);
  websSetVar(param_1,"REMOTE_HOST",param_1 + 0x30);
  websSetVar(param_1,"REMOTE_ADDR",param_1 + 0x30);
  websSetVar(param_1,"PATH_INFO",*(undefined4 *)(param_1 + 0xb4));
  stritoa(websPort,auStack_38,8);
  websSetVar(param_1,"SERVER_PORT",auStack_38);
  websSetVar(param_1,"SERVER_ADDR",param_1 + 0x50);
  fmtAlloc(local_2c,0xfe,"%s/%s","GoAhead-Webs","2.5.0");
  websSetVar(param_1,"SERVER_SOFTWARE",local_2c[0]);
  bfreeSafe(local_2c[0]);
  websSetVar(param_1,"SERVER_PROTOCOL",*(undefined4 *)(param_1 + 0xe8));
  if ((*(uint *)(param_1 + 0x100) & 0x80000) == 0) {
    if (*(int *)(param_1 + 0xec) != 0) {
      pcVar2 = *(char **)(param_1 + 0xc4);
      if (pcVar2 != (char *)0x0) {
        if (*pcVar2 != '\0') {
                    /* WARNING: Subroutine does not return */
          strlen(pcVar2);
        }
                    /* WARNING: Subroutine does not return */
        strlen(pcVar2);
      }
      __dest = (void *)balloc(*(int *)(param_1 + 0x110) + 1);
      *(void **)(param_1 + 0xc4) = __dest;
      if (__dest != (void *)0x0) {
        memcpy(__dest,*(void **)(param_1 + 0xec),*(size_t *)(param_1 + 0x110));
        *(undefined *)(*(int *)(param_1 + 0xc4) + *(int *)(param_1 + 0x110)) = 0;
      }
    }
  }
  else {
    iVar1 = extractUploadedFileContent(param_1,&local_30);
    if (iVar1 != 0) {
      bfree(*(undefined4 *)(param_1 + 0xec));
      *(int *)(param_1 + 0xec) = iVar1;
      *(undefined4 *)(param_1 + 0x110) = local_30;
    }
  }
  pcVar2 = (char *)bstrdup(*(undefined4 *)(param_1 + 0xc4));
  *(char **)(param_1 + 200) = pcVar2;
  pcVar2 = strtok(pcVar2,"&");
  while( true ) {
    if (pcVar2 == (char *)0x0) {
      return;
    }
    pcVar3 = strchr(pcVar2,0x3d);
    if (pcVar3 != (char *)0x0) break;
    local_2c[0] = "";
    if (*pcVar2 != '\0') {
      iVar1 = websGetVar(param_1,pcVar2,0);
      if (iVar1 == 0) {
        websSetVar(param_1,pcVar2,local_2c[0]);
      }
      else {
        fmtAlloc(&local_30,0x100,"%s %s");
        websSetVar(param_1,pcVar2,local_30);
        bfreeSafe(local_30);
      }
    }
    pcVar2 = strtok((char *)0x0,"&");
  }
  local_2c[0] = pcVar3 + 1;
  *pcVar3 = '\0';
                    /* WARNING: Subroutine does not return */
  strlen(pcVar2);
}
----------------------------------------

Function: websAccept

undefined4 websAccept(undefined4 param_1,char *param_2,undefined4 param_3,undefined4 param_4)

{
  int iVar1;
  
  iVar1 = websAlloc();
  if (iVar1 < 0) {
    return 0xffffffff;
  }
  *(undefined4 *)(*(int *)(webs + iVar1 * 4) + 0xf4) = param_4;
                    /* WARNING: Subroutine does not return */
  strlen(param_2);
}
----------------------------------------

Function: websDone

void websDone(int *param_1,int param_2)

{
  int iVar1;
  undefined *puVar2;
  undefined *puVar3;
  tm tStack_88;
  char acStack_5c [27];
  undefined local_41;
  char local_40;
  undefined local_3f;
  undefined local_31;
  char acStack_30 [5];
  undefined local_2b;
  time_t tStack_28;
  char *local_24 [5];
  
  socketDeleteHandler(param_1[0x3c]);
  if (param_2 != 200) {
    param_1[0x40] = param_1[0x40] & 0xfffffffd;
  }
  local_24[0] = (char *)(param_1[0x40] & 0x1000);
  if (local_24[0] != (char *)0x0) {
    websPageClose(param_1);
    if ((param_1[0x40] & 2U) == 0) {
      websTimeoutCancel(param_1);
      socketSetBlock(param_1[0x3c],1);
      socketFlush(param_1[0x3c]);
      socketCloseConnection(param_1[0x3c]);
    }
    else {
      iVar1 = socketFlush(param_1[0x3c]);
      if (iVar1 == 0) {
        param_1[0x3f] = 1;
        param_1[0x40] = param_1[0x40] | 0x1000;
        if (*param_1 != 0) {
          ringqFlush(param_1);
        }
        socketCreateHandler(param_1[0x3c],2,websSocketEvent,param_1);
        websTimeoutCancel(param_1);
        iVar1 = emfSchedCallback(60000,websTimeout,param_1);
        param_1[0xb] = iVar1;
        return;
      }
    }
    websFree(param_1);
    return;
  }
  time(&tStack_28);
  localtime_r(&tStack_28,&tStack_88);
  strftime(acStack_5c,0x1c,"%d/%b/%Y:%H:%M:%S",&tStack_88);
  local_41 = 0;
  snprintf(acStack_30,6,"%+03d00",tStack_88.tm_gmtoff / 0xe10);
  local_2b = 0;
  if (param_1[0x48] == 0) {
    local_3f = 0;
    local_40 = '-';
  }
  else {
    snprintf(&local_40,0x10,"%d");
    local_31 = 0;
  }
  puVar2 = (undefined *)param_1[0x35];
  if (puVar2 == (undefined *)0x0) {
    puVar2 = &DAT_10023880;
  }
  if ((param_1[0x40] & 0x20U) == 0) {
    if ((param_1[0x40] & 0x200U) == 0) {
      puVar3 = &DAT_10023cf8;
    }
    else {
      puVar3 = &DAT_10023cfc;
    }
  }
  else {
    puVar3 = &DAT_10023cf0;
  }
  fmtAlloc(local_24,0x1050,"%s - %s [%s %s] \"%s %s %s\" %d %s\n",param_1 + 0xc,puVar2,acStack_5c,
           acStack_30,puVar3,param_1[0x2d],param_1[0x3a],param_2,&local_40);
                    /* WARNING: Subroutine does not return */
  strlen(local_24[0]);
}
----------------------------------------

Function: websSetHost

void websSetHost(char *param_1)

{
  strncpy(websHost,param_1,0x40);
  return;
}
----------------------------------------

Function: websSetIpaddr

void websSetIpaddr(char *param_1)

{
  strncpy(websIpaddr,param_1,0x40);
  return;
}
----------------------------------------

Function: websGetDateString

undefined4 websGetDateString(int param_1)

{
  char *__s;
  time_t local_18 [5];
  
  if (param_1 == 0) {
    time(local_18);
  }
  else {
    local_18[0] = *(time_t *)(param_1 + 8);
  }
  __s = ctime(local_18);
  if (__s != (char *)0x0) {
                    /* WARNING: Subroutine does not return */
    strlen(__s);
  }
  return 0;
}
----------------------------------------

Function: websRedirect

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */

void websRedirect(undefined4 param_1,char *param_2)

{
  char cVar1;
  char *pcVar2;
  undefined4 uVar3;
  char *local_18;
  undefined4 local_14 [3];
  
  _DAT_100b3f24 = _DAT_100b3f24 + 1;
  local_18 = (char *)0x0;
  local_14[0] = 0;
  pcVar2 = strstr(param_2,"http://");
  if (pcVar2 == (char *)0x0) {
    cVar1 = *param_2;
    uVar3 = websGetVar(param_1,"HTTP_HOST",websHostUrl);
    fmtAlloc(&local_18,0x1050,"http://%s/%s",uVar3,param_2 + (cVar1 == '/'));
    param_2 = local_18;
  }
  fmtAlloc(local_14,0x1050,
           "<html><head></head><body>\r\n\t\tThis document has moved to a new <a href=\"%s\">location</a>.\r\n\t\tPlease update your documents to reflect the new location.\r\n\t\t</body></html>\r\n"
           ,param_2);
  websResponse(param_1,0x12e,local_14[0],param_2);
  bfreeSafe(local_14[0]);
  bfreeSafe(local_18);
  return;
}
----------------------------------------

Function: websGetInput

/* WARNING: Control flow encountered bad instruction data */

uint websGetInput(int param_1,undefined4 *param_2,int *param_3)

{
  int iVar1;
  char *__s;
  undefined4 local_50 [3];
  
  *param_2 = 0;
  *param_3 = 0;
  local_50[0] = 0;
  if (*(int *)(param_1 + 0xfc) == 8) {
                    /* WARNING: Bad instruction - Truncating control flow here */
    halt_baddata();
  }
  iVar1 = socketGets(*(undefined4 *)(param_1 + 0xf0),local_50);
  if (iVar1 < 0) {
    iVar1 = socketEof(*(undefined4 *)(param_1 + 0xf0));
    if (iVar1 == 0) {
      return 0xffffffff;
    }
    if (*(int *)(param_1 + 0xfc) != 4) {
      websDone(param_1,0);
      return 0xffffffff;
    }
  }
  else {
    if (iVar1 != 0) {
      *param_2 = local_50[0];
      *param_3 = iVar1;
      return 1;
    }
    if (*(int *)(param_1 + 0xfc) != 2) {
      return 0xffffffff;
    }
    websSetVar(param_1,"HTTP_AUTHORIZATION",&DAT_10023fc4);
    __s = *(char **)(param_1 + 4);
    if ((__s != (char *)0x0) && (*__s != '\0')) {
      strchr(__s,10);
                    /* WARNING: Bad instruction - Truncating control flow here */
      halt_baddata();
    }
    if ((*(uint *)(param_1 + 0x100) & 0x20) != 0) {
      if ((*(uint *)(param_1 + 0x100) & 0x400) == 0) {
        *(undefined4 *)(param_1 + 0xfc) = 4;
        return 0;
      }
      *(undefined4 *)(param_1 + 0xfc) = 8;
      return (*(uint *)(param_1 + 0x108) - 1 | *(uint *)(param_1 + 0x108)) >> 0x1f;
    }
  }
  websUrlHandlerRequest(param_1);
  return 0xffffffff;
}
----------------------------------------

Function: websReadEvent

void websReadEvent(int param_1)

{
  int iVar1;
  char *pcVar2;
  char *pcVar3;
  undefined4 uVar4;
  char *pcVar5;
  uint uVar6;
  size_t sVar7;
  int __fd;
  undefined4 local_60;
  char *local_5c;
  char *local_58;
  undefined4 local_54;
  undefined4 local_50;
  undefined4 local_4c;
  undefined4 local_48;
  size_t local_44;
  char *local_40 [6];
  
  websSetTimeMark();
  local_40[0] = (char *)0x0;
  __fd = -1;
LAB_1001b050:
  while( true ) {
    while( true ) {
      if (local_40[0] != (char *)0x0) {
        bfree();
        local_40[0] = (char *)0x0;
      }
      do {
        iVar1 = websGetInput(param_1,local_40,&local_44);
      } while (iVar1 == 0);
      if (iVar1 < 0) goto LAB_1001b504;
      iVar1 = *(int *)(param_1 + 0xfc);
      if (iVar1 != 2) break;
      iVar1 = ringqLen(param_1);
      if (0 < iVar1) {
        ringqPutStr(param_1,&DAT_10022d7c);
      }
      ringqPutStr(param_1,local_40[0]);
    }
    if (iVar1 < 3) break;
    if (iVar1 == 4) {
      if ((*(uint *)(param_1 + 0x100) & 0x4000) == 0) {
        pcVar5 = *(char **)(param_1 + 0xc4);
        if (((pcVar5 != (char *)0x0) && (*pcVar5 != '\0')) &&
           ((*(uint *)(param_1 + 0x100) & 0x2000) == 0)) {
                    /* WARNING: Subroutine does not return */
          strlen(pcVar5);
        }
        uVar4 = bstrdup(local_40[0]);
        *(undefined4 *)(param_1 + 0xc4) = uVar4;
      }
      else {
        if (__fd == -1) {
          __fd = open(*(char **)(param_1 + 0x114),0x41,0x1b6);
        }
        write(__fd,local_40[0],local_44);
        write(__fd,&DAT_10022d7c,1);
      }
      *(uint *)(param_1 + 0x100) = *(uint *)(param_1 + 0x100) | 0x2000;
      goto LAB_1001b504;
    }
    if (iVar1 != 8) goto LAB_1001b4ec;
    if ((*(uint *)(param_1 + 0x100) & 0x4000) == 0) {
      if (*(int *)(param_1 + 0xec) == 0) {
        uVar4 = bmemdup(local_40[0]);
        *(undefined4 *)(param_1 + 0xec) = uVar4;
        sVar7 = local_44;
      }
      else {
        iVar1 = brealloc(*(int *)(param_1 + 0xec),*(int *)(param_1 + 0x110) + local_44 + 1);
        *(int *)(param_1 + 0xec) = iVar1;
        if (iVar1 == 0) goto LAB_1001b3bc;
        memcpy((void *)(iVar1 + *(int *)(param_1 + 0x110)),local_40[0],local_44);
        sVar7 = *(int *)(param_1 + 0x110) + local_44;
      }
      *(size_t *)(param_1 + 0x110) = sVar7;
    }
    else {
      if (__fd == -1) {
        __fd = open(*(char **)(param_1 + 0x114),0x41,0x1b6);
      }
      write(__fd,local_40[0],local_44);
    }
LAB_1001b3bc:
    *(uint *)(param_1 + 0x100) = *(uint *)(param_1 + 0x100) | 0x2000;
    iVar1 = *(int *)(param_1 + 0x108) - local_44;
    *(int *)(param_1 + 0x108) = iVar1;
    if (iVar1 < 1) {
      if (__fd != -1) {
        close(__fd);
      }
      websUrlHandlerRequest(param_1);
      goto LAB_1001b514;
    }
    if ((int)local_44 < 1) {
LAB_1001b504:
      if (__fd != -1) {
        close(__fd);
      }
LAB_1001b514:
      if (local_40[0] != (char *)0x0) {
        bfree();
      }
      return;
    }
  }
  if (iVar1 == 1) {
    pcVar5 = strtok(local_40[0]," \t");
    if ((pcVar5 != (char *)0x0) && (*pcVar5 != '\0')) {
      iVar1 = strcmp(pcVar5,"GET");
      if (iVar1 != 0) {
        iVar1 = strcmp(pcVar5,"POST");
        if (iVar1 == 0) {
          uVar6 = *(uint *)(param_1 + 0x100) | 0x20;
        }
        else {
          iVar1 = strcmp(pcVar5,"HEAD");
          if (iVar1 != 0) {
            uVar4 = 400;
            pcVar5 = "Bad request type";
            goto LAB_1001b4fc;
          }
          uVar6 = *(uint *)(param_1 + 0x100) | 0x200;
        }
        *(uint *)(param_1 + 0x100) = uVar6;
      }
      websSetVar(param_1,"REQUEST_METHOD",pcVar5);
      pcVar5 = strtok((char *)0x0," \t\n");
      if ((pcVar5 != (char *)0x0) && (*pcVar5 != '\0')) {
        pcVar2 = strtok((char *)0x0," \t\n");
        local_5c = (char *)0x0;
        local_4c = 0;
        local_50 = 0;
        local_48 = 0;
        local_58 = (char *)0x0;
        local_54 = 0;
        iVar1 = websUrlParse(pcVar5,&local_60,&local_4c,&local_54,&local_58,&local_50,&local_48,0,
                             &local_5c);
        if (iVar1 < 0) {
          uVar4 = 400;
          pcVar5 = "Bad URL format";
          goto LAB_1001b4fc;
        }
        uVar4 = bstrdup(pcVar5);
        *(undefined4 *)(param_1 + 0xb8) = uVar4;
        pcVar3 = strstr(pcVar5,"cgi-bin");
        if ((pcVar3 != (char *)0x0) &&
           (uVar6 = *(uint *)(param_1 + 0x100), *(uint *)(param_1 + 0x100) = uVar6 | 0x4000,
           (uVar6 & 0x20) != 0)) {
          uVar4 = websGetCgiCommName();
          *(undefined4 *)(param_1 + 0x114) = uVar4;
        }
        uVar4 = bstrdup(local_50);
        *(undefined4 *)(param_1 + 0xc4) = uVar4;
        uVar4 = bstrdup(local_4c);
        *(undefined4 *)(param_1 + 0xbc) = uVar4;
        uVar4 = bstrdup(local_54);
        *(undefined4 *)(param_1 + 0xb4) = uVar4;
        uVar4 = bstrdup(local_48);
        *(undefined4 *)(param_1 + 0xe4) = uVar4;
        uVar4 = bstrdup(pcVar2);
        *(undefined4 *)(param_1 + 0xe8) = uVar4;
        *(undefined4 *)(param_1 + 0xec) = 0;
        *(undefined4 *)(param_1 + 0x110) = 0;
        iVar1 = socketGetPort(*(undefined4 *)(param_1 + 0xf4));
        if (iVar1 < 0) {
          iVar1 = atoi(local_58);
        }
        *(int *)(param_1 + 0xf8) = iVar1;
        iVar1 = strcmp(local_5c,".asp");
        if (iVar1 == 0) {
          *(uint *)(param_1 + 0x100) = *(uint *)(param_1 + 0x100) | 0x100;
        }
        bfree(local_60);
        websUrlType(pcVar5,param_1 + 0x70,0x40);
        ringqFlush(param_1);
        *(undefined4 *)(param_1 + 0xfc) = 2;
        goto LAB_1001b050;
      }
    }
    uVar4 = 400;
    pcVar5 = "Bad HTTP request";
  }
  else {
LAB_1001b4ec:
    uVar4 = 0x194;
    pcVar5 = "Bad state";
  }
LAB_1001b4fc:
  websError(param_1,uVar4,pcVar5);
  goto LAB_1001b504;
}
----------------------------------------

Function: websSetRealm

void websSetRealm(char *param_1)

{
  strncpy(websRealm,param_1,0x40);
  return;
}
----------------------------------------

Function: strcmpci

int strcmpci(int param_1,int param_2)

{
  __int32_t **pp_Var1;
  int iVar2;
  byte *pbVar3;
  byte *pbVar4;
  
  if (((param_1 == 0) || (param_2 == 0)) || (param_1 == param_2)) {
    iVar2 = 0;
  }
  else {
    pp_Var1 = __ctype_tolower_loc();
    pbVar3 = (byte *)(param_1 + -1);
    pbVar4 = (byte *)(param_2 + -1);
    do {
      pbVar3 = pbVar3 + 1;
      pbVar4 = pbVar4 + 1;
      iVar2 = (*pp_Var1)[*pbVar3] - (*pp_Var1)[*pbVar4];
      if (*pbVar3 == 0) {
        return iVar2;
      }
    } while (iVar2 == 0);
  }
  return iVar2;
}
----------------------------------------

Function: websAspWrite

undefined4 websAspWrite(undefined4 param_1,undefined4 param_2,int param_3,char **param_4)

{
  if (0 < param_3) {
                    /* WARNING: Subroutine does not return */
    strlen(*param_4);
  }
  return 0;
}
----------------------------------------

Function: strtokcmp

void strtokcmp(undefined4 param_1,char *param_2)

{
  skipWhite();
                    /* WARNING: Subroutine does not return */
  strlen(param_2);
}
----------------------------------------

Function: websAspRequest

/* WARNING: Control flow encountered bad instruction data */

int websAspRequest(int param_1,undefined4 param_2)

{
  undefined4 uVar1;
  int iVar2;
  char *pcVar3;
  char *pcVar4;
  byte *pbVar5;
  int iVar6;
  byte *pbVar7;
  byte *pbVar8;
  uint uVar9;
  char *pcVar10;
  int iVar11;
  int iVar12;
  byte in_cr0;
  byte in_cr1;
  byte unaff_cr2;
  byte unaff_cr3;
  byte unaff_cr4;
  byte in_cr5;
  byte in_cr6;
  byte in_cr7;
  int local_58 [3];
  uint local_4c [4];
  uint local_3c;
  
  local_3c = (uint)(in_cr0 & 0xf) << 0x1c | (uint)(in_cr1 & 0xf) << 0x18 |
             (uint)(unaff_cr2 & 0xf) << 0x14 | (uint)(unaff_cr3 & 0xf) << 0x10 |
             (uint)(unaff_cr4 & 0xf) << 0xc | (uint)(in_cr5 & 0xf) << 8 | (uint)(in_cr6 & 0xf) << 4
             | (uint)(in_cr7 & 0xf);
  *(uint *)(param_1 + 0x100) = *(uint *)(param_1 + 0x100) | 0x40000;
  uVar1 = websGetRequestPath();
  iVar2 = ejOpenEngine(*(undefined4 *)(param_1 + 0x20),websAspFunctions);
  if (-1 < iVar2) {
    ejSetUserHandle(iVar2,param_1);
    iVar11 = websPageStat(param_1,param_2,uVar1,local_58);
    if (-1 < iVar11) {
      iVar11 = balloc(local_58[0] + 1);
      if (iVar11 == 0) {
        websError(param_1,200,"Can\'t get memory");
      }
      else {
        *(undefined *)(iVar11 + local_58[0]) = 0;
        iVar12 = websPageReadData(param_1,iVar11,local_58[0]);
        if (iVar12 == local_58[0]) {
          websPageClose(param_1);
          pcVar10 = (char *)ballocAscToUni(iVar11,iVar12);
          pcVar4 = pcVar10;
          if (pcVar10 == (char *)0x0) {
            websError(param_1,200,"Can\'t get memory");
LAB_1001bc94:
            iVar12 = -1;
          }
          else {
            do {
              do {
                if ((*pcVar4 == '\0') || (pcVar3 = strstr(pcVar4,"<%"), pcVar3 == (char *)0x0)) {
                  iVar12 = 0;
                  goto LAB_1001be48;
                }
                websWriteBlock(param_1,pcVar4,(int)pcVar3 - (int)pcVar4);
                pcVar3 = (char *)skipWhite(pcVar3 + 2);
                iVar12 = strtokcmp(pcVar3,"language");
                if (iVar12 != 0) {
                  strtokcmp(iVar12,"=javascript");
                    /* WARNING: Bad instruction - Truncating control flow here */
                  halt_baddata();
                }
                pcVar4 = strstr(pcVar3,"%>");
                if (pcVar4 == (char *)0x0) {
                  websError(param_1,200,"Unterminated script in %s: \n",param_2);
                  goto LAB_1001bc94;
                }
                *pcVar4 = '\0';
                pcVar4 = pcVar4 + 2;
                pbVar5 = (byte *)skipWhite(pcVar3);
                pbVar7 = pbVar5;
                while (pbVar8 = pbVar7, uVar9 = (uint)*pbVar8, uVar9 != 0) {
                  pbVar7 = pbVar8 + 1;
                  if ((uVar9 == 0x5c) && ((pbVar8[1] == 0xd || (pbVar8[1] == 10)))) {
                    *pbVar8 = 0x20;
                    for (; (*pbVar7 == 0xd || (*pbVar7 == 10)); pbVar7 = pbVar7 + 1) {
                      *pbVar7 = 0x20;
                    }
                  }
                }
              } while (*pbVar5 == 0);
              local_4c[0] = uVar9;
              iVar12 = scriptEval(2,pbVar5,local_4c,iVar2);
              if (iVar12 < 0) {
                iVar6 = websValid(param_1);
                if (iVar6 == 0) goto LAB_1001be7c;
                if (local_4c[0] == 0) {
                  websWrite(param_1,"<h2><b>ASP Error</b></h2>\n%s\n",pbVar5);
                }
                else {
                  websWrite(param_1,"<h2><b>ASP Error: %s</b></h2>\n");
                  websWrite(param_1,"<pre>%s</pre>",pbVar5);
                  bfree(local_4c[0]);
                }
                websWrite(param_1,"</body></html>\n");
                goto LAB_1001be78;
              }
            } while (iVar12 == 0);
            if (pcVar4 != (char *)0x0) {
LAB_1001be48:
              if ((*pcVar4 != '\0') && (iVar12 == 0)) {
                    /* WARNING: Subroutine does not return */
                strlen(pcVar4);
              }
            }
LAB_1001be78:
            iVar12 = 0;
          }
          goto LAB_1001be7c;
        }
        websError(param_1,200,"Cant read %s",param_2);
      }
      iVar12 = -1;
      pcVar10 = (char *)0x0;
      goto LAB_1001be7c;
    }
    websError(param_1,0x194,"Can\'t stat %s",param_2);
  }
  else {
    websError(param_1,200,"Can\'t create Ejscript engine");
  }
  iVar12 = -1;
  pcVar10 = (char *)0x0;
  iVar11 = 0;
LAB_1001be7c:
  iVar6 = websValid(param_1);
  if ((iVar6 != 0) && (websPageClose(param_1), -1 < iVar2)) {
    ejCloseEngine(iVar2);
  }
  bfreeSafe(pcVar10);
  bfreeSafe(iVar11);
  return iVar12;
}
----------------------------------------

Function: websDecode64

/* WARNING: Control flow encountered bad instruction data */

undefined4 websDecode64(char *param_1,char *param_2,int param_3)

{
  undefined4 uVar1;
  int iVar2;
  char *pcVar3;
  int iVar4;
  
  *param_1 = '\0';
  if ((*param_2 == '\0') || (*param_2 == '=')) {
    uVar1 = 0;
  }
  else {
    iVar4 = 4;
    pcVar3 = param_2;
    do {
      iVar2 = (int)pcVar3 - (int)param_2;
      if ((*pcVar3 == '\0') || (*pcVar3 == '=')) goto LAB_1001bfd4;
      pcVar3 = pcVar3 + 1;
      iVar4 = iVar4 + -1;
    } while (iVar4 != 0);
    iVar2 = 4;
LAB_1001bfd4:
    if (param_1 + iVar2 + -1 < param_1 + param_3) {
                    /* WARNING: Bad instruction - Truncating control flow here */
      halt_baddata();
    }
    strcpy(param_1,"String too big");
    uVar1 = 0xffffffff;
  }
  return uVar1;
}
----------------------------------------

Function: appendString

void appendString(int *param_1,char *param_2)

{
  int iVar1;
  
  if (*param_1 != 0) {
                    /* WARNING: Subroutine does not return */
    strlen(param_2);
  }
  iVar1 = bstrdup();
  *param_1 = iVar1;
  return;
}
----------------------------------------

Function: evalExpr

/* WARNING: Control flow encountered bad instruction data */

undefined4 evalExpr(int param_1,char *param_2,undefined4 param_3,char *param_4)

{
  byte bVar1;
  ushort **ppuVar2;
  int iVar3;
  uint uVar4;
  uint uVar5;
  uint uVar6;
  byte *pbVar7;
  undefined auStack_28 [16];
  
  pbVar7 = (byte *)(param_2 + -1);
  do {
    pbVar7 = pbVar7 + 1;
    bVar1 = *pbVar7;
    if (bVar1 == 0) {
      pbVar7 = (byte *)(param_4 + -1);
      goto LAB_1001c570;
    }
    ppuVar2 = __ctype_b_loc();
  } while (((*ppuVar2)[bVar1] & 8) != 0);
  goto LAB_1001c5bc;
  while (ppuVar2 = __ctype_b_loc(), ((*ppuVar2)[bVar1] & 8) != 0) {
LAB_1001c570:
    pbVar7 = pbVar7 + 1;
    bVar1 = *pbVar7;
    if (bVar1 == 0) {
      uVar4 = atoi(param_2);
      uVar5 = atoi(param_4);
      switch(param_3) {
      case 1:
        uVar6 = (uint)((int)uVar4 < (int)uVar5);
        break;
      case 2:
                    /* WARNING: Bad instruction - Truncating control flow here */
        halt_baddata();
      case 3:
        uVar6 = (uint)((int)uVar5 < (int)uVar4);
        break;
      case 4:
                    /* WARNING: Bad instruction - Truncating control flow here */
        halt_baddata();
      case 5:
        uVar5 = uVar4 ^ uVar5;
        goto LAB_1001c668;
      case 6:
        uVar6 = uVar4 == uVar5 ^ 1;
        break;
      case 7:
        uVar6 = uVar4 + uVar5;
        break;
      case 8:
        uVar6 = uVar4 - uVar5;
        break;
      case 9:
        uVar6 = 0;
        if (uVar5 != 0) {
          uVar6 = (int)uVar4 / (int)uVar5;
        }
        break;
      case 10:
        uVar6 = 0;
        if (uVar5 != 0) {
          uVar6 = uVar4 - ((int)uVar4 / (int)uVar5) * uVar5;
        }
        break;
      case 0xb:
        uVar6 = uVar4 << (uVar5 & 0x3f);
        break;
      case 0xc:
        uVar6 = (int)uVar4 >> (uVar5 & 0x3f);
        break;
      case 0xd:
        uVar6 = uVar4 * uVar5;
        break;
      default:
        ejError(param_1,"Bad operator %d",param_3);
        return 0xffffffff;
      case 0xf:
        uVar6 = uVar4 + 1;
        break;
      case 0x10:
        uVar6 = uVar4 - 1;
        break;
      case 0x11:
        goto LAB_1001c668;
      }
      goto LAB_1001c690;
    }
  }
LAB_1001c5bc:
  switch(param_3) {
  case 1:
    uVar6 = strcmp(param_2,param_4);
    break;
  case 2:
    uVar6 = strcmp(param_2,param_4);
    uVar6 = uVar6 - 1 | uVar6;
    break;
  case 3:
    iVar3 = strcmp(param_2,param_4);
    uVar6 = (iVar3 >> 0x1f) - iVar3;
    break;
  case 4:
    uVar6 = strcmp(param_2,param_4);
    uVar6 = ~uVar6;
    break;
  case 5:
    uVar5 = strcmp(param_2,param_4);
LAB_1001c668:
    uVar6 = (uint)(uVar5 == 0);
    goto LAB_1001c690;
  case 6:
    iVar3 = strcmp(param_2,param_4);
    uVar6 = iVar3 == 0 ^ 1;
    goto LAB_1001c690;
  case 7:
    param_1 = param_1 + 0x14;
    clearString(param_1);
    appendString(param_1,param_2);
    appendString(param_1,param_4);
    return 0;
  default:
    ejError(param_1,"Bad operator");
    return 0xffffffff;
  }
  uVar6 = uVar6 >> 0x1f;
LAB_1001c690:
  stritoa(uVar6,auStack_28,0x10);
  setstring(param_1 + 0x14,auStack_28);
  return 0;
}
----------------------------------------

Function: ringqPutStr

void ringqPutStr(undefined4 param_1,char *param_2)

{
                    /* WARNING: Subroutine does not return */
  strlen(param_2);
}
----------------------------------------

Function: websUrlParse

void websUrlParse(char *param_1)

{
                    /* WARNING: Subroutine does not return */
  strlen(param_1);
}
----------------------------------------

Function: websUrlType

char * websUrlType(char *param_1,char *param_2,size_t param_3)

{
  int iVar1;
  undefined4 local_20;
  undefined4 local_1c [5];
  
  if (((param_1 != (char *)0x0) && (*param_1 != '\0')) &&
     (iVar1 = websUrlParse(param_1,&local_20,0,0,0,0,0,0,local_1c), -1 < iVar1)) {
    strlower(local_1c[0]);
    iVar1 = symLookup(websMime,local_1c[0]);
    if (iVar1 == 0) {
      strcpy(param_2,"text/plain");
    }
    else {
      strncpy(param_2,*(char **)(iVar1 + 0x12),param_3);
    }
    bfree(local_20);
    return param_2;
  }
  strcpy(param_2,"text/plain");
  return param_2;
}
----------------------------------------

Function: websMD5binary

char * websMD5binary(undefined4 param_1,undefined4 param_2)

{
  byte bVar1;
  char cVar2;
  int iVar3;
  char *__dest;
  int iVar4;
  int iVar5;
  undefined auStack_98 [92];
  char local_3c [32];
  undefined local_1c;
  byte local_18 [16];
  
  psMd5Init(auStack_98);
  psMd5Update(auStack_98,param_1,param_2);
  psMd5Final(auStack_98,local_18);
  iVar4 = 0;
  iVar5 = 0x10;
  do {
    bVar1 = local_18[iVar4];
    iVar3 = iVar4 * 2;
    iVar4 = iVar4 + 1;
    cVar2 = "0123456789abcdef"[bVar1 & 0xf];
    local_3c[iVar3] = "0123456789abcdef"[bVar1 >> 4];
    local_3c[iVar3 + 1] = cVar2;
    iVar5 = iVar5 + -1;
  } while (iVar5 != 0);
  local_1c = 0;
  __dest = (char *)balloc(0x21);
  strncpy(__dest,local_3c,0x21);
  return __dest;
}
----------------------------------------

Function: websMD5

undefined4 websMD5(char *param_1)

{
  if ((param_1 != (char *)0x0) && (*param_1 != '\0')) {
                    /* WARNING: Subroutine does not return */
    strlen(param_1);
  }
  return 0;
}
----------------------------------------

Function: websCalcUrlDigest

void websCalcUrlDigest(int param_1)

{
  char *__s;
  undefined4 local_2c [5];
  
  local_2c[0] = 0;
  fmtAlloc(local_2c,0xff,"%s:%s:%s",*(undefined4 *)(param_1 + 0xd4),*(undefined4 *)(param_1 + 0x128)
           ,*(undefined4 *)(param_1 + 0xd0));
  websMD5(local_2c[0]);
  bfreeSafe(local_2c[0]);
  __s = (char *)websGetVar(param_1,"REQUEST_METHOD",0);
                    /* WARNING: Subroutine does not return */
  strlen(__s);
}
----------------------------------------

Function: ejLexGetToken

/* WARNING: Control flow encountered bad instruction data */

void ejLexGetToken(int *param_1,int param_2)

{
  bool bVar1;
  int iVar2;
  int iVar3;
  uint uVar4;
  ushort **ppuVar5;
  char *pcVar6;
  undefined4 uVar7;
  undefined4 uVar8;
  uint uVar9;
  int iVar10;
  
  param_1[8] = -1;
  iVar10 = *param_1;
  param_1[7] = (int)&DAT_10023fc4;
  ringqFlush(iVar10);
  if (*(int *)(iVar10 + 0x3c) < 1) {
    while (uVar4 = inputGetc_isra_0(*param_1), -1 < (int)uVar4) {
LAB_10020050:
      if (uVar4 == 0x2a) {
        uVar7 = 0xd;
        goto LAB_10020258;
      }
      if ((int)uVar4 < 0x2b) {
        if (uVar4 == 0x21) {
          iVar10 = inputGetc_isra_0(*param_1);
          if (iVar10 < 0) goto LAB_100201f8;
          if (iVar10 == 0x3d) {
            uVar7 = 6;
          }
          else {
            inputPutback_isra_1(*param_1);
            uVar7 = 0x11;
          }
          goto LAB_10020258;
        }
        if (0x21 < (int)uVar4) {
          if (uVar4 == 0x26) {
            iVar10 = inputGetc_isra_0(*param_1);
            if (iVar10 != 0x26) goto LAB_100201f8;
            uVar7 = 1;
            goto LAB_100203f4;
          }
          if ((int)uVar4 < 0x27) {
            if (uVar4 != 0x22) {
              uVar7 = 10;
              if (uVar4 != 0x25) goto LAB_10020610;
              goto LAB_10020258;
            }
          }
          else {
            if (uVar4 == 0x28) {
              tokenAddChar(param_1,0x28);
              iVar2 = 1;
              goto LAB_1002079c;
            }
            if (0x28 < (int)uVar4) {
              tokenAddChar(param_1,0x29);
              iVar2 = 2;
              goto LAB_1002079c;
            }
          }
          uVar9 = inputGetc_isra_0(*param_1);
          if ((int)uVar9 < 0) goto LAB_100201f8;
          goto LAB_10020450;
        }
        if (uVar4 == 10) {
          iVar2 = 0xc;
          goto LAB_1002079c;
        }
        if ((int)uVar4 < 0xb) {
          if (uVar4 == 0xffffffff) break;
          bVar1 = uVar4 == 9;
LAB_1002003c:
          if (!bVar1) goto LAB_10020610;
        }
        else if (uVar4 != 0xd) {
          bVar1 = uVar4 == 0x20;
          goto LAB_1002003c;
        }
        do {
          uVar4 = inputGetc_isra_0(*param_1);
          if ((int)uVar4 < 0) break;
        } while ((uVar4 == 0x20) || ((uVar4 & 0xfffffffb) == 9));
        goto LAB_10020050;
      }
      if (uVar4 == 0x3b) {
        tokenAddChar(param_1,0x3b);
        iVar2 = 9;
        goto LAB_1002079c;
      }
      if (0x3b < (int)uVar4) {
        if (uVar4 == 0x3e) {
          iVar10 = inputGetc_isra_0(*param_1);
          if (-1 < iVar10) {
            uVar7 = 0xc;
            if ((iVar10 == 0x3e) || (uVar7 = 4, iVar10 == 0x3d)) goto LAB_10020258;
            uVar7 = 3;
LAB_1002032c:
            tokenAddChar(param_1,uVar7);
            inputPutback_isra_1(*param_1,iVar10);
LAB_1002025c:
            iVar2 = 8;
            goto LAB_1002079c;
          }
        }
        else if ((int)uVar4 < 0x3f) {
          if (uVar4 == 0x3c) {
            iVar10 = inputGetc_isra_0(*param_1);
            if (-1 < iVar10) {
              uVar7 = 0xb;
              if ((iVar10 != 0x3c) && (uVar7 = 2, iVar10 != 0x3d)) {
                uVar7 = 1;
                goto LAB_1002032c;
              }
              goto LAB_10020258;
            }
          }
          else {
            if (uVar4 != 0x3d) goto LAB_10020610;
            iVar10 = inputGetc_isra_0(*param_1);
            if (-1 < iVar10) {
              if (iVar10 == 0x3d) {
                uVar7 = 5;
LAB_10020258:
                tokenAddChar(param_1,uVar7);
                goto LAB_1002025c;
              }
              inputPutback_isra_1(*param_1);
              iVar2 = 0x11;
              goto LAB_1002079c;
            }
          }
        }
        else {
          if (uVar4 != 0x7c) {
            if (uVar4 == 0x7d) {
              tokenAddChar(param_1,0x7d);
              iVar2 = 6;
            }
            else {
              if (uVar4 != 0x7b) {
LAB_10020610:
                if (uVar4 != 0x5c) goto LAB_100205d4;
LAB_100205e8:
                while( true ) {
                  uVar4 = inputGetc_isra_0(*param_1);
                  if ((int)uVar4 < 0) goto LAB_1002062c;
                  ppuVar5 = __ctype_b_loc();
                  if (((*ppuVar5)[uVar4] & 0x800) != 0) break;
                  if ((uVar4 != 0x24) && (uVar4 != 0x5f)) goto code_r0x10020624;
LAB_100205d4:
                  iVar2 = tokenAddChar(param_1,uVar4);
                  if (iVar2 < 0) goto LAB_1002062c;
                }
                goto LAB_10020610;
              }
              tokenAddChar(param_1,0x7b);
              iVar2 = 5;
            }
            goto LAB_1002079c;
          }
          iVar10 = inputGetc_isra_0(*param_1);
          if (iVar10 == 0x7c) {
            uVar7 = 2;
LAB_100203f4:
            tokenAddChar(param_1,uVar7);
            iVar2 = 7;
            goto LAB_1002079c;
          }
        }
LAB_100201f8:
        pcVar6 = "Syntax Error";
        goto LAB_10020440;
      }
      if (uVar4 == 0x2d) {
        iVar10 = inputGetc_isra_0(*param_1);
        if (iVar10 < 0) goto LAB_100201f8;
        if (iVar10 != 0x2d) {
          inputPutback_isra_1(*param_1);
          uVar7 = 8;
          goto LAB_10020258;
        }
        uVar7 = 0x10;
LAB_1002026c:
        tokenAddChar(param_1,uVar7);
        iVar2 = 0x13;
        goto LAB_1002079c;
      }
      if ((int)uVar4 < 0x2e) {
        if (uVar4 == 0x2b) {
          iVar10 = inputGetc_isra_0(*param_1);
          if (-1 < iVar10) {
            if (iVar10 == 0x2b) {
              uVar7 = 0xf;
              goto LAB_1002026c;
            }
            inputPutback_isra_1(*param_1);
            uVar7 = 7;
            goto LAB_10020258;
          }
          goto LAB_100201f8;
        }
        if (uVar4 != 0x2c) goto LAB_10020610;
        tokenAddChar(param_1,0x2c);
        iVar2 = 0xf;
        goto LAB_1002079c;
      }
      if (uVar4 != 0x2f) {
        if (((int)uVar4 < 0x2f) || (0x39 < (int)uVar4)) goto LAB_10020610;
        goto LAB_100205a0;
      }
      iVar2 = inputGetc_isra_0(*param_1);
      if (iVar2 < 0) goto LAB_100201f8;
      if ((iVar2 != 0x2a) && (iVar2 != 0x2f)) {
        inputPutback_isra_1(*param_1);
        uVar7 = 9;
        goto LAB_10020258;
      }
LAB_10020098:
      do {
        iVar3 = inputGetc_isra_0(*param_1);
        if (iVar3 < 0) goto LAB_100201f8;
        bVar1 = iVar2 != 0x2f;
        if (iVar3 != 10) {
          if (iVar3 != 0x2a) goto LAB_10020098;
          iVar3 = inputGetc_isra_0(*param_1);
          if (iVar2 != 0x2f) {
            bVar1 = iVar3 == 0x2f;
          }
          else {
            bVar1 = iVar3 == 10;
          }
        }
      } while (!bVar1);
    }
    iVar2 = 0xe;
  }
  else {
    ringqPutStr(iVar10,*(undefined4 *)(iVar10 + 0x38));
    iVar2 = *(int *)(iVar10 + 0x3c);
    *(undefined4 *)(iVar10 + 0x3c) = 0;
    param_1[7] = *(int *)(iVar10 + 4);
  }
  goto LAB_1002079c;
LAB_10020450:
  do {
    if (uVar9 == uVar4) goto LAB_100205c4;
    if (uVar9 == 0x5c) {
      uVar9 = inputGetc_isra_0(*param_1);
      ppuVar5 = __ctype_b_loc();
      if (((*ppuVar5)[uVar9] & 8) == 0) {
        if (uVar9 == 0x66) {
          uVar9 = 0xc;
        }
        else if ((int)uVar9 < 0x67) {
          if (uVar9 != 0x27) {
            if ((int)uVar9 < 0x28) {
              if (uVar9 != 0x22) {
LAB_10020434:
                pcVar6 = "Invalid Escape Sequence";
                goto LAB_10020440;
              }
            }
            else if (uVar9 != 0x5c) {
              if (uVar9 != 0x62) goto LAB_10020434;
              uVar9 = 8;
            }
          }
        }
        else if (uVar9 == 0x74) {
          uVar9 = 9;
        }
        else if ((int)uVar9 < 0x75) {
          if (uVar9 == 0x6e) {
            uVar9 = 10;
          }
          else {
            if (uVar9 != 0x72) goto LAB_10020434;
            uVar9 = 0xd;
          }
        }
        else {
          if (uVar9 != 0x75) {
            if (uVar9 == 0x78) {
              uVar7 = 0x10;
              uVar8 = 2;
              goto LAB_1002050c;
            }
            goto LAB_10020434;
          }
          iVar10 = charConvert(param_1,0x10,2);
          iVar2 = charConvert(param_1,0x10,2);
          uVar9 = iVar10 * 0x10 + iVar2;
        }
      }
      else {
        inputPutback_isra_1(*param_1);
        uVar7 = 8;
        uVar8 = 3;
LAB_1002050c:
        uVar9 = charConvert(param_1,uVar7,uVar8);
      }
    }
    iVar10 = tokenAddChar(param_1,uVar9);
    if (iVar10 < 0) goto LAB_10020448;
    uVar9 = inputGetc_isra_0(*param_1);
  } while (-1 < (int)uVar9);
  pcVar6 = "Unmatched Quote";
LAB_10020440:
  ejError(param_1,pcVar6);
LAB_10020448:
  iVar2 = -1;
  goto LAB_1002079c;
code_r0x10020624:
  if (uVar4 != 0x5c) {
LAB_1002062c:
    ppuVar5 = __ctype_b_loc();
    uVar9 = (uint)**(byte **)(iVar10 + 4);
    if (((((*ppuVar5)[uVar9] & 4) == 0) && (uVar9 != 0x24)) && (uVar9 != 0x5f)) {
      ejError(param_1,"Invalid identifier %s");
      goto LAB_10020448;
    }
    if (param_2 != 8) goto LAB_10020720;
    pcVar6 = (char *)param_1[7];
    iVar10 = strcmp(pcVar6,"if");
    if (iVar10 == 0) {
      iVar2 = 3;
    }
    else {
      iVar10 = strcmp(pcVar6,"else");
      if (iVar10 == 0) {
        iVar2 = 4;
      }
      else {
        iVar10 = strcmp(pcVar6,"var");
        if (iVar10 == 0) {
          iVar2 = 0x10;
        }
        else {
          iVar10 = strcmp(pcVar6,"for");
          if (iVar10 == 0) {
            iVar2 = 0x12;
          }
          else {
            iVar10 = strcmp(pcVar6,"return");
            if (iVar10 == 0) {
              if ((uVar4 == 0x3b) || (iVar2 = 0x14, uVar4 == 0x28)) {
                inputPutback_isra_1(*param_1,uVar4);
                iVar2 = 0x14;
              }
            }
            else {
LAB_10020720:
              do {
                if (((uVar4 != 0x20) && (1 < uVar4 - 9)) && (uVar4 != 0xd)) {
                    /* WARNING: Bad instruction - Truncating control flow here */
                  halt_baddata();
                }
                uVar4 = inputGetc_isra_0(*param_1);
              } while (-1 < (int)uVar4);
              inputPutback_isra_1(*param_1,uVar4);
              iVar2 = 0xd;
            }
          }
        }
      }
    }
    goto LAB_1002079c;
  }
  goto LAB_100205e8;
  while ((uVar4 = inputGetc_isra_0(*param_1), -1 < (int)uVar4 &&
         (ppuVar5 = __ctype_b_loc(), ((*ppuVar5)[uVar4] & 8) != 0))) {
LAB_100205a0:
    iVar10 = tokenAddChar(param_1,uVar4);
    if (iVar10 < 0) goto LAB_10020448;
  }
  inputPutback_isra_1(*param_1,uVar4);
LAB_100205c4:
  iVar2 = 10;
LAB_1002079c:
  param_1[8] = iVar2;
  return;
}
----------------------------------------

Function: strstr

/* WARNING: Unknown calling convention -- yet parameter storage is locked */

char * strstr(char *__haystack,char *__needle)

{
  char *pcVar1;
  
  pcVar1 = strstr(__haystack,__needle);
  return pcVar1;
}
----------------------------------------

Function: strcmp

/* WARNING: Unknown calling convention -- yet parameter storage is locked */

int strcmp(char *__s1,char *__s2)

{
  int iVar1;
  
  iVar1 = strcmp(__s1,__s2);
  return iVar1;
}
----------------------------------------

Function: strcat

/* WARNING: Unknown calling convention -- yet parameter storage is locked */

char * strcat(char *__dest,char *__src)

{
  char *pcVar1;
  
  pcVar1 = strcat(__dest,__src);
  return pcVar1;
}
----------------------------------------

Function: strcpy

/* WARNING: Unknown calling convention -- yet parameter storage is locked */

char * strcpy(char *__dest,char *__src)

{
  char *pcVar1;
  
  pcVar1 = strcpy(__dest,__src);
  return pcVar1;
}
----------------------------------------

Function: system

/* WARNING: Unknown calling convention -- yet parameter storage is locked */

int system(char *__command)

{
  int iVar1;
  
  iVar1 = system(__command);
  return iVar1;
}
----------------------------------------

Function: strchr

/* WARNING: Unknown calling convention -- yet parameter storage is locked */

char * strchr(char *__s,int __c)

{
  char *pcVar1;
  
  pcVar1 = strchr(__s,__c);
  return pcVar1;
}
----------------------------------------

Function: strlen

/* WARNING: Unknown calling convention -- yet parameter storage is locked */

size_t strlen(char *__s)

{
                    /* WARNING: Subroutine does not return */
  strlen(__s);
}
----------------------------------------

Function: snprintf

/* WARNING: Unknown calling convention -- yet parameter storage is locked */

int snprintf(char *__s,size_t __maxlen,char *__format,...)

{
  int iVar1;
  
  iVar1 = snprintf(__s,__maxlen,__format);
  return iVar1;
}
----------------------------------------

Function: strncpy

/* WARNING: Unknown calling convention -- yet parameter storage is locked */

char * strncpy(char *__dest,char *__src,size_t __n)

{
  char *pcVar1;
  
  pcVar1 = strncpy(__dest,__src,__n);
  return pcVar1;
}
----------------------------------------

Function: strtok

/* WARNING: Unknown calling convention -- yet parameter storage is locked */

char * strtok(char *__s,char *__delim)

{
  char *pcVar1;
  
  pcVar1 = strtok(__s,__delim);
  return pcVar1;
}
----------------------------------------

Function: strrchr

/* WARNING: Unknown calling convention -- yet parameter storage is locked */

char * strrchr(char *__s,int __c)

{
  char *pcVar1;
  
  pcVar1 = strrchr(__s,__c);
  return pcVar1;
}
----------------------------------------

Function: sprintf

/* WARNING: Unknown calling convention -- yet parameter storage is locked */

int sprintf(char *__s,char *__format,...)

{
  int iVar1;
  
  iVar1 = sprintf(__s,__format);
  return iVar1;
}
----------------------------------------

Function: strncmp

/* WARNING: Unknown calling convention -- yet parameter storage is locked */

int strncmp(char *__s1,char *__s2,size_t __n)

{
  int iVar1;
  
  iVar1 = strncmp(__s1,__s2,__n);
  return iVar1;
}
----------------------------------------

Function: strstr

/* WARNING: Control flow encountered bad instruction data */
/* WARNING: Unknown calling convention -- yet parameter storage is locked */

char * strstr(char *__haystack,char *__needle)

{
                    /* WARNING: Bad instruction - Truncating control flow here */
                    /* strstr@@GLIBC_2.0 */
  halt_baddata();
}
----------------------------------------

Function: strcmp

/* WARNING: Control flow encountered bad instruction data */
/* WARNING: Unknown calling convention -- yet parameter storage is locked */

int strcmp(char *__s1,char *__s2)

{
                    /* WARNING: Bad instruction - Truncating control flow here */
                    /* strcmp@@GLIBC_2.0 */
  halt_baddata();
}
----------------------------------------

Function: strcat

/* WARNING: Control flow encountered bad instruction data */
/* WARNING: Unknown calling convention -- yet parameter storage is locked */

char * strcat(char *__dest,char *__src)

{
                    /* WARNING: Bad instruction - Truncating control flow here */
                    /* strcat@@GLIBC_2.0 */
  halt_baddata();
}
----------------------------------------

Function: strcpy

/* WARNING: Control flow encountered bad instruction data */
/* WARNING: Unknown calling convention -- yet parameter storage is locked */

char * strcpy(char *__dest,char *__src)

{
                    /* WARNING: Bad instruction - Truncating control flow here */
                    /* strcpy@@GLIBC_2.0 */
  halt_baddata();
}
----------------------------------------

Function: system

/* WARNING: Control flow encountered bad instruction data */
/* WARNING: Unknown calling convention -- yet parameter storage is locked */

int system(char *__command)

{
                    /* WARNING: Bad instruction - Truncating control flow here */
                    /* system@@GLIBC_2.0 */
  halt_baddata();
}
----------------------------------------

Function: strchr

/* WARNING: Control flow encountered bad instruction data */
/* WARNING: Unknown calling convention -- yet parameter storage is locked */

char * strchr(char *__s,int __c)

{
                    /* WARNING: Bad instruction - Truncating control flow here */
                    /* strchr@@GLIBC_2.0 */
  halt_baddata();
}
----------------------------------------

Function: strlen

/* WARNING: Control flow encountered bad instruction data */
/* WARNING: Unknown calling convention -- yet parameter storage is locked */

size_t strlen(char *__s)

{
                    /* WARNING: Bad instruction - Truncating control flow here */
                    /* strlen@@GLIBC_2.0 */
  halt_baddata();
}
----------------------------------------

Function: snprintf

/* WARNING: Control flow encountered bad instruction data */
/* WARNING: Unknown calling convention -- yet parameter storage is locked */

int snprintf(char *__s,size_t __maxlen,char *__format,...)

{
                    /* WARNING: Bad instruction - Truncating control flow here */
                    /* snprintf@@GLIBC_2.4 */
  halt_baddata();
}
----------------------------------------

Function: strncpy

/* WARNING: Control flow encountered bad instruction data */
/* WARNING: Unknown calling convention -- yet parameter storage is locked */

char * strncpy(char *__dest,char *__src,size_t __n)

{
                    /* WARNING: Bad instruction - Truncating control flow here */
                    /* strncpy@@GLIBC_2.0 */
  halt_baddata();
}
----------------------------------------

Function: strtok

/* WARNING: Control flow encountered bad instruction data */
/* WARNING: Unknown calling convention -- yet parameter storage is locked */

char * strtok(char *__s,char *__delim)

{
                    /* WARNING: Bad instruction - Truncating control flow here */
                    /* strtok@@GLIBC_2.0 */
  halt_baddata();
}
----------------------------------------

Function: strrchr

/* WARNING: Control flow encountered bad instruction data */
/* WARNING: Unknown calling convention -- yet parameter storage is locked */

char * strrchr(char *__s,int __c)

{
                    /* WARNING: Bad instruction - Truncating control flow here */
                    /* strrchr@@GLIBC_2.0 */
  halt_baddata();
}
----------------------------------------

Function: sprintf

/* WARNING: Control flow encountered bad instruction data */
/* WARNING: Unknown calling convention -- yet parameter storage is locked */

int sprintf(char *__s,char *__format,...)

{
                    /* WARNING: Bad instruction - Truncating control flow here */
                    /* sprintf@@GLIBC_2.4 */
  halt_baddata();
}
----------------------------------------

Function: strncmp

/* WARNING: Control flow encountered bad instruction data */
/* WARNING: Unknown calling convention -- yet parameter storage is locked */

int strncmp(char *__s1,char *__s2,size_t __n)

{
                    /* WARNING: Bad instruction - Truncating control flow here */
                    /* strncmp@@GLIBC_2.0 */
  halt_baddata();
}
----------------------------------------

Function: strncat

/* WARNING: Control flow encountered bad instruction data */
/* WARNING: Unknown calling convention -- yet parameter storage is locked */

char * strncat(char *__dest,char *__src,size_t __n)

{
                    /* WARNING: Bad instruction - Truncating control flow here */
                    /* strncat@@GLIBC_2.0 */
  halt_baddata();
}
----------------------------------------

